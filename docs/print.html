<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The YSLib Book</title>
                <meta name="robots" content="noindex" />
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Book tranplanted from YSLib BitBucket wiki.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="favicon.svg">
                        <link rel="shortcut icon" href="favicon.png">
                <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
                <link rel="stylesheet" href="css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="Home.html"><strong aria-hidden="true">1.</strong> 索引/Index</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Home.en-US.html"><strong aria-hidden="true">1.1.</strong> English Version</a></li><li class="chapter-item expanded "><a href="Home.zh-CN.html"><strong aria-hidden="true">1.2.</strong> 简体中文版</a></li><li class="chapter-item expanded "><a href="Contents.zh-CN.html"><strong aria-hidden="true">1.3.</strong> Contents(zh-CN)/主题目录</a></li></ol></li><li class="chapter-item expanded "><a href="GettingStarted.zh-CN.html"><strong aria-hidden="true">2.</strong> 入门</a></li><li class="chapter-item expanded "><a href="Development.zh-CN.html"><strong aria-hidden="true">3.</strong> 开发说明</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Prerequisitions.zh-CN.html"><strong aria-hidden="true">3.1.</strong> 先决条件</a></li><li class="chapter-item expanded "><a href="GettingSources.zh-CN.html"><strong aria-hidden="true">3.2.</strong> 获取源代码</a></li><li class="chapter-item expanded "><a href="Build.zh-CN.html"><strong aria-hidden="true">3.3.</strong> 构建</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="BuildDocumentation.zh-CN.html"><strong aria-hidden="true">3.3.1.</strong> 构建文档</a></li></ol></li><li class="chapter-item expanded "><a href="Test.zh-CN.html"><strong aria-hidden="true">3.4.</strong> 测试</a></li><li class="chapter-item expanded "><a href="Run.zh-CN.html"><strong aria-hidden="true">3.5.</strong> 运行</a></li></ol></li><li class="chapter-item expanded "><a href="Features.zh-CN.html"><strong aria-hidden="true">4.</strong> 结构和特性</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="ProjectDependencies.zh-CN.html"><strong aria-hidden="true">4.1.</strong> （内部）项目依赖性说明</a></li><li class="chapter-item expanded "><a href="Features/NPL.zh-CN.html"><strong aria-hidden="true">4.2.</strong> NPL</a></li></ol></li><li class="chapter-item expanded "><a href="EMPTY.html"><strong aria-hidden="true">5.</strong> 应用开发环境</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Sysroot.zh-CN.html"><strong aria-hidden="true">5.1.</strong> Sysroot</a></li><li class="chapter-item expanded "><a href="YDE.zh-CN.html"><strong aria-hidden="true">5.2.</strong> YDE</a></li></ol></li><li class="chapter-item expanded "><a href="EMPTY.html"><strong aria-hidden="true">6.</strong> 项目维护资源</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Releases.zh-CN.html"><strong aria-hidden="true">6.1.</strong> 发布工程</a></li><li class="chapter-item expanded "><a href="Archives.zh-CN.html"><strong aria-hidden="true">6.2.</strong> 归档</a></li></ol></li><li class="chapter-item expanded "><a href="EMPTY.html"><strong aria-hidden="true">7.</strong> 工具</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tools/SHBuild.zh-CN.html"><strong aria-hidden="true">7.1.</strong> SHBuild</a></li><li class="chapter-item expanded "><a href="Tools/RevisionPatcher.zh-CN.html"><strong aria-hidden="true">7.2.</strong> RevisionPatcher</a></li><li class="chapter-item expanded "><a href="Tools/SXML2XML.zh-CN.html"><strong aria-hidden="true">7.3.</strong> SXML2XML</a></li><li class="chapter-item expanded "><a href="Tools/ProjectGenerator.zh-CN.html"><strong aria-hidden="true">7.4.</strong> ProjectGenerator</a></li><li class="chapter-item expanded "><a href="Tools/Scripts.zh-CN.html"><strong aria-hidden="true">7.5.</strong> 脚本</a></li></ol></li><li class="chapter-item expanded "><a href="Tutorial.zh-CN.html"><strong aria-hidden="true">8.</strong> 教程</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Tutorial/Overview.zh-CN.html"><strong aria-hidden="true">8.1.</strong> 综述</a></li><li class="chapter-item expanded "><a href="Tutorial/GUI.zh-CN.html"><strong aria-hidden="true">8.2.</strong> GUI</a></li><li class="chapter-item expanded "><a href="Tutorial/Configuration.zh-CN.html"><strong aria-hidden="true">8.3.</strong> 程序配置</a></li></ol></li><li class="chapter-item expanded "><a href="EMPTY.html"><strong aria-hidden="true">9.</strong> 附录/Appendix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="Terminology.zh-CN.html"><strong aria-hidden="true">9.1.</strong> 术语概要</a></li><li class="chapter-item expanded "><a href="StandardUsing.en-US.html"><strong aria-hidden="true">9.2.</strong> Standard Using</a></li><li class="chapter-item expanded "><a href="ReportedIssues.en-US.html"><strong aria-hidden="true">9.3.</strong> Reported Issues</a></li><li class="chapter-item expanded "><a href="WikiRules.en-US.html"><strong aria-hidden="true">9.4.</strong> Wiki Rules</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">The YSLib Book</h1>

                    <div class="right-buttons">
                                                <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="a-hrefhomeen-ushtmlenglish-versiona"><a class="header" href="#a-hrefhomeen-ushtmlenglish-versiona"><a href="Home.en-US.html">English Version</a></a></h1>
<h1 id="a-hrefhomezh-cnhtml简体中文版a"><a class="header" href="#a-hrefhomezh-cnhtml简体中文版a"><a href="Home.zh-CN.html">简体中文版</a></a></h1>
<h1 id="a-hrefcontentszh-cnhtmlcontentszh-cn主题目录a"><a class="header" href="#a-hrefcontentszh-cnhtmlcontentszh-cn主题目录a"><a href="Contents.zh-CN.html">Contents(zh-CN)/主题目录</a></a></h1>
<h1 id="copyright-of-this-wiki"><a class="header" href="#copyright-of-this-wiki">Copyright of this wiki</a></h1>
<p>© 2013-2020 <a href="mailto:frankhb1989@gmail.com">FrankHB</a> and wiki editors.</p>
<p>Except where otherwise specified explicitly, materials in this repository are licensed under following terms:</p>
<p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="http://i.creativecommons.org/l/by-sa/4.0/88x31.png" alt="http://creativecommons.org/licenses/by-sa/4.0/" title="license" /></a></p>
<p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA 4.0">Creative Commons Attribution-ShareAlike 4.0 International License</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="about"><a class="header" href="#about">About</a></h1>
<p>The YSLib Project is a project of platform-neutral framework consists of several multi-licensed open source libraries. It is aiming to develop native applications in a naturally cross-platform manner.</p>
<p>See LICENSE.TXT in the source directory for licensing affairs.</p>
<p>The main part (except libraries not being maintained in this project) of the libraries is coded in C++, which is strictly conforming to ISO/IEC 14882. (For features being used, see <a href="StandardUsing.en-US.html">here</a>. For some issues concerned with this project, see <a href="ReportedIssues.en-US.html">here</a>.)</p>
<p>The project is currently in <a href="Releases.zh-CN.html">Alpha state(zh-CN)</a> with following interface compatibility strategies:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a> compatibility for any revision depending on specific platform, toolchain or build configuration is never guaranteed.</li>
<li>ABI compatibility may not be retained between releases with same platform, toolchain and build configuration.</li>
<li><a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> of libraries may be modified locally and there is no guarantee for compatibility between releases.</li>
<li><a href="https://en.wikipedia.org/wiki/User_interface">UI</a> of tools (see <a href="Contents.zh-CN.html">contents(zh-CN)</a> for the list) may be modified progressively across builds; unless specified elsewhere, added features are kept being <a href="https://en.wikipedia.org/wiki/Backward_compatibility">backward compatible</a> within at least one next releases.</li>
</ul>
<p>See <a href="GettingStarted.zh-CN.html">here(zh-CN)</a> for basic steps to use YSLib in development.</p>
<p>See <a href="Releases.zh-CN.html">here(zh-CN)</a> for releases and plans.</p>
<h2 id="currently-supported-platforms"><a class="header" href="#currently-supported-platforms">Currently supported platforms</a></h2>
<ul>
<li>(<a href="https://en.wikipedia.org/wiki/Nintendo">Nintendo</a>/<a href="https://en.wikipedia.org/wiki/IQue">iQue</a>) <a href="https://en.wikipedia.org/wiki/Nintendo_DS_line#Nintendo_DS_family">DS</a> (arm-none-eabi)
<ul>
<li>using <a href="DeSmuME.en-US.html">DeSmuME</a> to run on PC</li>
</ul>
</li>
<li>MinGW32 (i686-w64-mingw32, compatible with i686-pc-mingw32)</li>
</ul>
<h2 id="pending-supported-platform"><a class="header" href="#pending-supported-platform">Pending supported platform</a></h2>
<ul>
<li>Android (arm-linux-androideabi)</li>
<li>MinGW64 (x86_64-w64-mingw32)</li>
<li>Linux32 (i686-linux-gnu)</li>
<li>Linux64 (x86_64-linux-gnu)</li>
</ul>
<h2 id="documentation"><a class="header" href="#documentation">Documentation</a></h2>
<h3 id="documentation-in-the-yslib-project"><a class="header" href="#documentation-in-the-yslib-project">Documentation in the YSLib project</a></h3>
<p>Documentation in the YSLib project consist of several parts:</p>
<ul>
<li>The development documentation which is intended for the project maintainers, see <a href="Development.zh-CN.html">development(zh-CN)</a>.
<ul>
<li>The document in <code>/doc/vsd</code> can be viewed by Microsoft Office Visio or Microsoft Visual Studio 2013.</li>
</ul>
</li>
<li>Souce code documentation, which can be generated using Doxygen, see <a href="BuildDocumentation.zh-CN.html">building documentation(zh-CN)</a>.
<ul>
<li>Currently the Doxygen commands in the source code are mainly coded in simplified Chinese. It is planned to utilize Doxygen's <code>~[LanguageId]</code> command to generate multilingual documents in future. All other comments, however, should be in English by default.</li>
</ul>
</li>
<li>Other non-generated documents are text files in the repository, like <code>Readme.zh-CN.txt</code>.</li>
</ul>
<h3 id="about-this-wiki"><a class="header" href="#about-this-wiki">About this wiki</a></h3>
<p>This wiki is a project related to the YSLib project. They are currently the only two members in the same project group, each has separated repository. Common documentation for the project group, general user documentation and list of significant features for the YSLib project are dominated by this wiki. Documentation in the YSLib project is mainly for maintainers of the project. They are bidirectionally referenced, namely the content of this wiki may be refenenced in the YSLib project and vice versa.</p>
<p>Unless otherwise specified, the content of this wiki is fit for the current last master branch revision (i.e. the revision <code>tip</code> of <code>master</code> branch in the repository).</p>
<p>See <a href="WikiRules.en-US.html">here</a> for rules to edit this wiki.</p>
<p>It is intended to reference every pages of this wiki in this page.</p>
<h1 id="contributions"><a class="header" href="#contributions">Contributions</a></h1>
<p>Contributions to the projects are welcomed. Provided materials thereby shall be adjusted by contributors (and the project maintainer) to conform the license of the corresponding projects if necessary.</p>
<p><strong>Rules in this wiki are treated as consensus.</strong> Rules in project documentation have effect on maintainers but not other contributors. However, the contents in the projects shall always be conforming to the project rules.</p>
<p>To feedback or report issues, use <a href="https://bitbucket.org/FrankHB/yslib/issues/">Bitbucket issue tracker</a>, or contact the project maintainer as noted below.</p>
<h2 id="rules-for-project-contents"><a class="header" href="#rules-for-project-contents">Rules for project contents</a></h2>
<p>The following philosophy are generally accommodated throughout the projects.</p>
<ul>
<li>
<p><strong>Do not <a href="https://en.wikipedia.org/wiki/Reinventing_the_wheel">reinvent the wheel</a>.</strong> Projects here only accepts modular components which would be better elsewhere. Here &quot;better&quot; is defined as &quot;superior than current solution in at least one aspect for consensually known need&quot;.</p>
<ul>
<li>See the notes in <a href="Features.zh-CN.html">features(zh-CN)</a> for the list of invented wheels and the rationale.</li>
</ul>
</li>
<li>
<p><strong>Decline premature optimization.</strong> However, what is &quot;premature&quot; is determined by the need, which would be probably variable.</p>
</li>
</ul>
<h1 id="contacts"><a class="header" href="#contacts">Contacts</a></h1>
<ul>
<li>Mail to: <a href="mailto:frankhb1989@gmail.com">frankhb1989@gmail.com</a></li>
<li>Post <a href="http://tieba.baidu.com/f?kw=%BB%C3%A4%CE%C9%CF%B5%DB">here</a> (mainly zh-CN)</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概要"><a class="header" href="#概要">概要</a></h1>
<p>　　YSLib 项目是一个提供多个开源库组成的平台中立框架的项目，主要致力于以自然的方式开发跨平台本机应用。</p>
<p>　　使用的许可证见源代码目录中的 LICENSE.TXT 。</p>
<p>　　主要部分（非此项目维护的库除外）使用 C++ 编码，严格符合 ISO/IEC 14882 。（使用的 ISO 特性参见<a href="StandardUsing.en-US.html">这里(en-US)</a> 。和本项目相关的被报告的问题见<a href="ReportedIssues.en-US.html">这里(en-US)</a> 。）</p>
<p>　　项目当前为 <a href="Releases.zh-CN.html">Alpha 状态</a>，具有以下接口兼容性策略：</p>
<ul>
<li>任意版本不保证依赖特定平台、工具链或构建配置的 <a href="https://en.wikipedia.org/wiki/Application_binary_interface">ABI</a> 兼容性。</li>
<li>同一平台、工具链和构建配置的发布版本之间的 ABI 可能不兼容。</li>
<li>库的 <a href="https://en.wikipedia.org/wiki/Application_programming_interface">API</a> 设计在局部调整而不保证在发布版本之间兼容。</li>
<li>工具（列表参见<a href="Contents.zh-CN.html">目录</a>）的 <a href="https://en.wikipedia.org/wiki/User_interface">UI</a> 可能会在构建中渐进修改；除非另行指定，添加的特性在之后的至少一个发布版本中保持<a href="https://en.wikipedia.org/wiki/Backward_compatibility">向后兼容</a>。</li>
</ul>
<p>　　关于使用 YSLib 开发的基本步骤，参见<a href="GettingStarted.zh-CN.html">入门</a>。</p>
<p>　　目前已发布版本、进展和计划看<a href="Releases.zh-CN.html">这里</a>。</p>
<h2 id="当前支持平台"><a class="header" href="#当前支持平台">当前支持平台</a></h2>
<ul>
<li>(<a href="https://zh.wikipedia.org/zh-cn/%E4%BB%BB%E5%A4%A9%E5%A0%82">Nintendo</a>/<a href="https://zh.wikipedia.org/zh-cn/%E7%A5%9E%E6%B8%B8%E7%A7%91%E6%8A%80">iQue</a>) <a href="https://zh.wikipedia.org/zh-cn/%E4%BB%BB%E5%A4%A9%E5%A0%82DS%E5%AE%B6%E6%97%8F#.E4.BB.BB.E5.A4.A9.E5.A0.82DS.E5.AE.B6.E6.97.8F">DS</a> (arm-none-eabi)
<ul>
<li>在 PC 上使用<a href="DeSmuME.en-US.html">DeSmuME(en-US)</a> 运行</li>
</ul>
</li>
<li>MinGW32 (i686-w64-mingw32, compatible with i686-pc-mingw32)</li>
</ul>
<h2 id="待定支持平台"><a class="header" href="#待定支持平台">待定支持平台</a></h2>
<ul>
<li>Android (arm-linux-androideabi)</li>
<li>MinGW64 (x86_64-w64-mingw32)</li>
<li>Linux32 (i686-linux-gnu)</li>
<li>Linux64 (x86_64-linux-gnu)</li>
</ul>
<h2 id="文档"><a class="header" href="#文档">文档</a></h2>
<h3 id="yslib-项目中的文档"><a class="header" href="#yslib-项目中的文档">YSLib 项目中的文档</a></h3>
<p>　　YSLib 项目中的文档主要包括以下几个部分：</p>
<ul>
<li>主要供项目维护者参考的开发文档，详见<a href="Development.zh-CN.html">开发说明</a>。
<ul>
<li>目录 <code>/doc/vsd</code> 下的文档可使用 Microsoft Office Visio 或 Microsoft Visual Studio 2013 查看。</li>
</ul>
</li>
<li>源代码文档，可使用 Doxygen 生成，参见<a href="BuildDocumentation.zh-CN.html">构建文档</a>。
<ul>
<li>当前源代码中的 Doxygen 命令主要编码为简体中文。未来计划使用 Doxygen 的 <code>~[LanguageId]</code> 命令生成多种语言的文档。其它注释主要使用英文。</li>
</ul>
</li>
<li>其它非生成的文本文件，如 <code>Readme.zh-CN.txt</code> 。</li>
</ul>
<h3 id="关于本-wiki"><a class="header" href="#关于本-wiki">关于本 wiki</a></h3>
<p>　　本 wiki 是和 YSLib 项目关联的项目。本 wiki 和 YSLib 项目组成了同一个项目组当前仅有的两个成员，每个项目都有单独的版本库。项目组的公共文档、 YSLib 的一般用户文档和重要特性列表主要由本 wiki 提供。 YSLib 项目中的文档主要面向项目的维护者。两者的文档构成双向引用，即 YSLib 项目可能引用本 wiki 的内容，反之亦然。</p>
<p>　　除非另行指定，本 wiki 的内容适合当前最新的主分支版本（即版本库 <code>master</code> 分支标识为 <code>tip</code> 的版本）。</p>
<p>　　编辑本 wiki 的规则参见<a href="WikiRules.en-US.html">这里(en-US)</a> 。</p>
<p>　　本页面有意引用所有本 wiki 的所有页面。</p>
<h1 id="贡献"><a class="header" href="#贡献">贡献</a></h1>
<p>　　对项目的贡献受到欢迎。由此提供的材料应在必要时由贡献者（及项目维护者）调整，以符合相应项目的许可证。</p>
<p>　　**这个 wiki 规则被视为共识。**在项目文档内部的规则对维护者而不是其他贡献者有效。但是，项目中的内容应符合项目规则。</p>
<p>　　要反馈或报告问题，使用 <a href="https://bitbucket.org/FrankHB/yslib/issues/">Bitbucket 问题跟踪系统</a>，或按如下方式联系项目维护者。</p>
<h2 id="项目内容规则"><a class="header" href="#项目内容规则">项目内容规则</a></h2>
<p>　　下列指导原则一般地适用于所有项目。</p>
<ul>
<li>**不<a href="https://zh.wikipedia.org/zh-cn/%E9%87%8D%E9%80%A0%E8%BD%AE%E5%AD%90">重复发明轮子</a>。**这里的项目只接受比别处更好的模块化组件。此处“更好”定义为“在至少一个方面比现有解决方案更有效地满足一致同意的已知需求”。
<ul>
<li>参见<a href="Features.zh-CN.html">特性</a>注记的轮子列表和原理。</li>
</ul>
</li>
<li>**拒绝不成熟的优化。**然而，何谓“不成熟”由需求决定，这很可能变化。</li>
</ul>
<h1 id="联系方式"><a class="header" href="#联系方式">联系方式</a></h1>
<ul>
<li>发邮件到<a href="mailto:frankhb1989@gmail.com">frankhb1989@gmail.com</a></li>
<li>在<a href="http://tieba.baidu.com/f?kw=%BB%C3%A4%CE%C9%CF%B5%DB">贴吧</a>发贴/Post <a href="http://tieba.baidu.com/f?kw=%BB%C3%A4%CE%C9%CF%B5%DB">here</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="主题目录"><a class="header" href="#主题目录">主题目录</a></h1>
<ul>
<li><a href="GettingStarted.zh-CN.html">入门</a></li>
<li><a href="Development.zh-CN.html">开发说明</a>
<ul>
<li><a href="Prerequisitions.zh-CN.html">先决条件</a></li>
<li><a href="GettingSources.zh-CN.html">获取源代码</a>（另见项目维护资源）</li>
<li><a href="Build.zh-CN.html">构建</a>
<ul>
<li><a href="BuildDocumentation.zh-CN.html">构建文档</a></li>
</ul>
</li>
<li><a href="Test.zh-CN.html">测试</a></li>
<li><a href="Run.zh-CN.html">运行</a></li>
</ul>
</li>
<li><a href="Features.zh-CN.html">结构和特性</a>
<ul>
<li><a href="ProjectDependencies.zh-CN.html">（内部）项目依赖性</a>说明</li>
<li><a href="NPL.zh-CN.html">NPL</a></li>
</ul>
</li>
<li>应用开发环境
<ul>
<li><a href="Sysroot.zh-CN.html">Sysroot</a></li>
<li><a href="YDE.zh-CN.html">YDE</a></li>
</ul>
</li>
<li>项目维护资源
<ul>
<li><a href="Releases.zh-CN.html">发布工程</a>：规则、版本清单和路线图等</li>
<li><a href="Archives.zh-CN.html">归档</a>：发布的历史资源</li>
<li>以下工具中部分用于项目维护</li>
</ul>
</li>
<li>工具
<ul>
<li><a href="Tools/SHBuild.zh-CN.html">SHBuild</a></li>
<li><a href="Tools/RevisionPatcher.zh-CN.html">RevisionPatcher</a></li>
<li><a href="Tools/SXML2XML.zh-CN.html">SXML2XML</a></li>
<li><a href="Tools/ProjectGenerator.zh-CN.html">ProjectGenerator</a></li>
<li><a href="Tools/Scripts.zh-CN.html">脚本</a></li>
</ul>
</li>
<li><a href="Tutorial.zh-CN.html">教程</a></li>
<li><a href="Terminology.zh-CN.html">术语概要</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="导航"><a class="header" href="#导航">导航</a></h1>
<p>　　<a href="Home.zh-CN.html">YSLib 是什么？</a></p>
<p>　　返回<a href="Contents.zh-CN.html">目录</a>查看其它内容。</p>
<h1 id="目标读者"><a class="header" href="#目标读者">目标读者</a></h1>
<p>　　本文预期的读者是对了解如何使用 YSLib 创建项目感兴趣的<strong>开发者</strong>。</p>
<h2 id="基础知识"><a class="header" href="#基础知识">基础知识</a></h2>
<p>　　本文假定读者已经掌握或了解以下知识，不详细展开讨论：</p>
<ul>
<li>计算机体系结构常识</li>
<li>了解规范 C++ 语言的标准（ISO/IEC 14882）</li>
<li>了解什么是语言的实现（如编译器和链接器等）并掌握常见实现的使用方法（如 G++ 命令行）</li>
<li>有必要时，能避免依赖只在特定实现支持的方言特性</li>
</ul>
<h1 id="概要-1"><a class="header" href="#概要-1">概要</a></h1>
<p>　　本文档说明开发 YSLib 程序的简易操作。以下仅提供操作步骤和主要意义的解释。</p>
<p><strong>注意</strong> 若需自行定制构建，参照以下引用的文档的全文，而非某个特定章节；再按照<a href="Build.zh-CN.html">构建</a>中的步骤执行。</p>
<p>　　当前只有关于 Windows 下使用 MinGW32 的内容，基于 MSYS2 环境。</p>
<h1 id="环境配置"><a class="header" href="#环境配置">环境配置</a></h1>
<p>　　使用 YSLib 开发需要配置 YSLib 环境，以确保 YSLib 的库和相关环境可用。</p>
<p>　　当前建议直接在本机环境中从源代码构建安装 YSLib ，参照以下步骤和要点：</p>
<ul>
<li>参照<a href="Prerequisitions.zh-CN.html">先决条件</a>的<strong>PC(MinGW32)<strong>一节给出的链接下载 MSYS2 并配置环境，执行脚本安装所需的工具；或者参照</strong>PC/Linux</strong>一节配置 Linux 开发环境。</li>
<li><a href="GettingSources.zh-CN.html">获取源代码</a>。
<ul>
<li>若直接从版本库获取，直接构建可能找不到库而在链接时失败。可以自行参照文档构建缺少的外部依赖项，或<a href="Archives.zh-CN.html">从归档仓库下载</a>二进制文件放置到指定的库文件路径中，详见<a href="Development.zh-CN.html">开发说明</a>。</li>
<li>文件不包含 POSIX 权限。若需在依赖文件权限的环境（包括典型的 Linux 环境）中直接运行 shell 脚本，需确保（可能被间接调用的）脚本文件可执行，如运行 <code>find Tools -type f -name &quot;*.sh&quot; -exec chmod +x {} \;</code> 。</li>
</ul>
</li>
<li>参照 <a href="Sysroot.zh-CN.html">Sysroot</a> ，运行 <code>Tools/install-sysroot.sh</code> 脚本以构建 YSLib 并安装头所需的文件，得到 Sysroot 环境。然后，把 <code>sysroot/usr/bin</code> 目录的完整路径加入 <code>PATH</code> 环境变量（一般应添加在最前端）。
<ul>
<li><strong>注意</strong> 除非了解确切的作用，不要添加 YSLib 中的其它目录到 <code>PATH</code> ；添加不合适的目录可能会导致脚本运行失败。</li>
</ul>
</li>
</ul>
<h1 id="开发基础"><a class="header" href="#开发基础">开发基础</a></h1>
<p>　　以下介绍使用 YSLib 开发须知的基础要点，并说明如何开发示例程序。</p>
<h2 id="控制台程序和图形用户界面gui-程序"><a class="header" href="#控制台程序和图形用户界面gui-程序">控制台程序和图形用户界面(GUI) 程序</a></h2>
<p>　　需要注意，在 Windows 中控制台程序仍然可以包含 GUI 。</p>
<p>　　YSLib 支持各种用户应用程序。为了简便起见，以下只介绍 GUI 程序的使用。更具体的说明参见 <a href="Prerequisitions.zh-CN.html">Windows 子系统</a>。</p>
<h2 id="编写-hello-world-程序"><a class="header" href="#编写-hello-world-程序">编写 Hello World 程序</a></h2>
<p>　　新建 C++ 源文件（名称任意，但需要<a href="Tools/SHBuild.zh-CN.html#markdown-header-_1">以 <code>.cpp</code> 等作为扩展名以保证 SHBuild 作为 C++ 源文件处理</a>），内容如下：</p>
<pre><code>#include &lt;YSBuild.h&gt;
#include YFM_Helper_GUIApplication
#include YFM_YSLib_UI_Label
#include YFM_Helper_HostedUI

int
main()
{
	using namespace YSLib;
	GUIApplication app;
	UI::Label wgt({480, 360, 160, 24});

	wgt.Text = u&quot;Hello world!&quot;;
	Host::ShowTopLevel(wgt, WS_CAPTION | WS_SYSMENU | WS_MINIMIZEBOX, 0);
	Execute(app);
}
</code></pre>
<h3 id="关于头文件"><a class="header" href="#关于头文件">关于头文件</a></h3>
<p>　　可以安全地重复包含头文件。</p>
<p>　　注意到 <code>#include</code> 后可以是一个宏。这里表示路径的宏 <code>YFM_*</code> 由 <code>&lt;YSBuild.h&gt;</code> 保证定义，因此这个头文件需要在使用这些宏之前被包含。</p>
<p>　　使用宏表示 YFramework 的大多数头文件名是兼容性的需要。用户程序不需要使用这种策略，尤其是集成开发环境可能会对这样引入的头文件的修改不敏感而导致的构建遗漏。</p>
<p>　　MinGW32 平台的 Helper::HostedUI 的头文件已经保证包含了 <code>&lt;Windows.h&gt;</code> 中宿主窗口的声明，不需要显式包含。</p>
<h2 id="使用-shbuild-buildapp-脚本构建程序"><a class="header" href="#使用-shbuild-buildapp-脚本构建程序">使用 SHBuild-BuildApp 脚本构建程序</a></h2>
<p>　　把上面的文件保存到<strong>一个空的目录</strong>下，以下以 <code>$SRC</code> 指定这个目录名。</p>
<p>　　执行以下命令：</p>
<pre><code>bash -c &quot;cd $SRC; SHBuild-BuildPkg.sh release .&quot;
</code></pre>
<p>　　在目录 <code>$SRC/.release</code> 下找到构建好的可执行文件（具体文件名取决于源文件名），执行观察结果。</p>
<h3 id="说明"><a class="header" href="#说明">说明</a></h3>
<p>　　<code>bash -c</code> 启动新的 shell 执行命令。</p>
<p>　　<code>cd $SRC</code> 切换 shell 的当前工作目录到源代码目录。</p>
<p>　　<code>SHBuild-BuildPkg.sh</code> 调用构建脚本。脚本的参数分别是：</p>
<ul>
<li><code>release</code> 是一个配置名称。配置名称决定保存生成的文件的输出目录相对当前工作目录的位置，这里输出目录是当前工作目录下的 <code>.release</code> 子目录。可以更换配置名称以指定不同的输出目录。
　　* 若配置名称以 <code>debug</code> 起始，启用调试配置，自动使用调试库和构建选项。 </li>
<li><code>.</code> 表示构建的目录源代码的根目录为当前工作目录。</li>
<li>之后的可选参数在此省略。</li>
</ul>
<p>　　构建脚本以特定的选项调用 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 工具作为脚本解释器执行 NPLA1 脚本 <code>SHBuild-BuildApp.txt</code> ，详见 <a href="Sysroot.zh-CN.html">Sysroot</a> 。</p>
<p>　　<code>SHBuild-BuildApp.txt</code> 内部再次调用 SHBuild 工具进行构建。默认会递归扫描整个目录（除了名称以 <code>.</code> 起始的子目录外）。若存在多个源文件，这些文件都会被一起编译并链接。为了避免预期以外的结果，之前要求源文件在空目录中。</p>
<h3 id="其它方法"><a class="header" href="#其它方法">其它方法</a></h3>
<p>　　也可以直接调用 <code>SHBuild</code> 或者编译器命令行，但需要手动指定调用编译器的参数以及链接的库等，较为复杂，在此从略。</p>
<h3 id="清理"><a class="header" href="#清理">清理</a></h3>
<p>　　无论是 <code>SHBuild</code> 还是 <code>SHBuild-BuildPkg.sh</code> 当前都不提供清理功能。因为包括中间文件的输出文件都在同一个输出目录中，直接删除输出的目录即可。</p>
<h1 id="进一步阅读"><a class="header" href="#进一步阅读">进一步阅读</a></h1>
<p>　　参见<a href="Development.zh-CN.html">开发说明</a>的相应章节和进阶的<a href="Tutorial.zh-CN.html">教程</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="开发说明"><a class="header" href="#开发说明">开发说明</a></h1>
<p>　　关于环境配置，详见<a href="Run.zh-CN.html">运行</a>。当前没有其它的面向最终用户的说明。</p>
<p>　　以下为面向开发者的说明。</p>
<h1 id="准备"><a class="header" href="#准备">准备</a></h1>
<ul>
<li>了解<a href="Prerequisitions.zh-CN.html">先决条件</a></li>
<li><a href="GettingSources.zh-CN.html">获取源代码</a></li>
<li>了解<a href="ProjectDependencies.zh-CN.html">项目依赖性</a></li>
<li>了解<a href="Terminology.zh-CN.html">术语概要</a>的体例以备参考</li>
</ul>
<p>　　YSLib 项目文档位于 YSLib 项目而不是本 wiki 项目中。</p>
<p>　　维护者参考的细节和一般规则详见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> ；术语的完整定义详见 YSLib 项目文档 <code>doc/CommonRules.txt</code> 。</p>
<h1 id="项目过程"><a class="header" href="#项目过程">项目过程</a></h1>
<p>　　基本规则参见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。</p>
<p>　　本 wiki 项目作为用户手册和开发者补充文档的形式作为实现及之后阶段输出。</p>
<p>　　实现的附加输出为库和工具。</p>
<p>　　之前阶段（如设计）为前期过程，其文档和适用于维护过程的项目规则位于 YSLib 项目文档（位于 <code>doc/</code> ）。</p>
<p>　　其中整体过程由 <code>doc/Designation.txt</code> 指定。当前内联设计以外的过程，因此不存在设计外前期过程的单独文档。</p>
<h1 id="开发"><a class="header" href="#开发">开发</a></h1>
<ul>
<li><a href="Build.zh-CN.html">构建</a>
<ul>
<li><a href="BuildDocumentation.zh-CN.html">构建文档</a></li>
</ul>
</li>
<li><a href="Run.zh-CN.html">运行</a></li>
<li>使用 <a href="Sysroot.zh-CN.html">Sysroot</a> 开发和部署程序</li>
</ul>
<h1 id="平台"><a class="header" href="#平台">平台</a></h1>
<p>　　关于<strong>外部依赖</strong>、<strong>平台</strong>、<strong>目标平台</strong>和<strong>宿主平台</strong>等概念的一般定义参见<a href="Terminology.zh-CN.html">术语概要</a>。</p>
<p>　　YSLib 项目约定一个体系结构和使用的外部依赖是一个平台。</p>
<p>　　YSLib 支持不同的目标平台。类似 ISO C/C++ 的独立实现(freestanding implementation) 和宿主实现(hosted implementation) ，平台分为两类：<strong>独立实现平台</strong>和<strong>宿主实现平台</strong>。后者存在操作系统的支持而前者没有。</p>
<h2 id="语言使用和实现要求"><a class="header" href="#语言使用和实现要求">语言使用和实现要求</a></h2>
<p>　　本节适用于本项目，不直接限制依赖项和用户程序。项目中特定部分的规则及适用性详见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。</p>
<p>　　除脚本（见以下相关章节）外，使用 ISO C++ 作为主要开发语言。</p>
<p>　　不使用和 ISO C++03 以后被接受的特性不兼容的特性，包括但不限于：</p>
<ul>
<li>被取消的特性，如 <code>export</code> 关键字；</li>
<li>在 ISO C++03 中标记为 deprecated 而在之后版本去除的特性，如 const char 数组类型左值到 char* 右值的转换，</li>
<li>在 ISO C++03 中标记为 deprecated 但在之后版本重新取消 deprecated 的特性，如修饰命名空间作用域声明的 <code>static</code> ；</li>
<li>实现的 Defect Report ，如 <a href="http://wg21.cmeerw.net/cwg/issue615">CWG 615</a> 。</li>
</ul>
<p>　　注意即使使用特定模式，一些实现也可能引入之后的 Defect Report 而不保证兼容，如 <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=65890">GCC PR65890</a> 。</p>
<p>　　关于精确的特性使用规则、具体使用及备选的特性的清单等，详见<a href="StandardUsing.en-US.html">标准使用（英文）</a> 。</p>
<p>　　以下对语言实现的要求和支持情况适用整个项目。具体内容可能会在未来变动。</p>
<h3 id="基准实现要求"><a class="header" href="#基准实现要求">基准实现要求</a></h3>
<p>　　默认基于 ISO C++11 环境，但并不要求实现完整支持所有特性。</p>
<p>　　依赖 ISO C++ 独立实现或宿主实现，附加以下要求：</p>
<ul>
<li>满足 ISO C++11 [implimits] 建议的最小实现要求。</li>
<li>标准库要求基于 ISO C++11 定义的宿主实现。
<ul>
<li>需以下整数类型（ ISO C++11 中为可选支持）：
<ul>
<li>定宽整数 <code>std::intN_t</code> 和 <code>std::uintN_t</code> （其中 N 为 8 、 16 、 32 或 64 ）；</li>
<li>类型 <code>std::uintptr_t</code> 。</li>
</ul>
</li>
<li>满足以下实现定义行为的要求：
<ul>
<li>至少支持 <code>std::placeholders::_7</code>（按 ISO C++11 Annex B [implimits] ，符合标准的下限为 10 ）。</li>
</ul>
</li>
<li>假定用于迭代器 <code>difference_type</code>（含 <code>std::ptrdiff_t</code> ）或坐标计算的有符号整数作为显式转换的目标类型且结果不能在范围内表示时，不引起副作用且结果的值不是能在此范围内表示的任意值（即为小于 <code>0</code> 的值）。
<ul>
<li>当前标准中结果由实现定义。<a href="http://wg21.link/p0907">WG21 P0907</a> 已提议修改使用补码表示，符合此要求。</li>
</ul>
</li>
<li>假定特定类型的特定操作无异常抛出（但不依赖异常规范的行为），当前包括：
<ul>
<li><code>std::string</code> 的默认构造函数（ <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4002.pdf">WG21 N4002</a> 引入了显式指定 <code>noexcept</code> ，仅从标准草案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4296.pdf">WG21 N4296</a> 起有效）。</li>
</ul>
</li>
</ul>
</li>
<li>实现已解决<a href="StandardUsing.en-US.html">标准使用(en-US)</a> 中的 Workarounds 列出的 Defect Report 问题。</li>
<li>假定被包含在具有外部链接实体的函数体或声明命名空间作用域中外部链接名称的被 ODR 使用(<a href="http://eel.is/c++draft/basic.def.odr#3">odr-used</a>) 的 lambda 表达式相同。
<ul>
<li>否则会引起被包含的代码中的 lambda 在多个翻译单元 ODR 使用时<a href="http://eel.is/c++draft/basic.def.odr#6">违反 ODR 引发未定义行为</a> 。此类未定义行为包括以下情形：
<ul>
<li>所在函数体在 <code>extern inline</code> 函数。这被 <a href="http://wg21.cmeerw.net/cwg/issue765">CWG 765</a> 解决并存在于 ISO C++11 和<a href="http://eel.is/c++draft/dcl.fct.spec#4">之后的标准文本</a>中。
<ul>
<li>对符合 ISO C++11 及之后版本标准的实现，<a href="https://www.reddit.com/r/cpp/comments/40saz8/a_workaround_for_dangerous_lambda_odr_violations/">这个变通</a> 对其中的示例代码因此是不必要的；其它情况也有代码膨胀的缺陷，不应使用。</li>
<li>已知当前所有版本的 Microsoft VC++ 编译器都<a href="https://www.reddit.com/r/cpp/comments/40lm8o/lambdas_are_dangerous/">没有实现这个特性且会在内联代码后引起未预期的行为，计划在下一版本修复</a>。</li>
</ul>
</li>
<li>命名空间作用域中的 lambda 表达式，或所在函数体在其它实体，包括函数模板、类模板的成员函数以及类模板的成员函数模板。这是<a href="http://stackoverflow.com/questions/34717823/can-using-a-lambda-in-header-files-violate-the-odr/34721371#34721371">未被提交和解决的 ISO C++ 缺陷</a>。此处的假定作为用于避免这个问题。</li>
</ul>
</li>
<li>基于 <a href="https://mentorembedded.github.io/cxx-abi/abi.html#closure-types">Itanium ABI</a> 的实现符合这个条件。</li>
</ul>
</li>
<li>对宿主环境中程序外部的状态的并发修改不引起未定义行为。
<ul>
<li>现有操作系统和文件系统提供的接口和实现普遍不能保证避免 <a href="https://en.wikipedia.org/wiki/Time_of_check_to_time_of_use">TOCTTOU 访问(en-US)</a> 导致的问题。具体修改的结果未指定，但应不直接引起无法预测的程序行为。</li>
<li>除非另行指定，本项目的实现不保证检查外部程序的修改。</li>
</ul>
</li>
</ul>
<p>　　假定 YSLib 实现和用户程序的代码满足以下要求：</p>
<ul>
<li>假定异常和标准库 RTTI 对象满足 ODR ，即使是在使用动态库的宿主实现中，但影响用户代码生成的实现的二进制约定（如 <a href="https://reviews.llvm.org/rL205139">ARM64</a> ）除外。
<ul>
<li>这要求用户代码不依赖影响相关符号可见性而导致 ODR 失效的特性。
<ul>
<li>例如，这不允许如 <code>dlopen</code> 使用 <code>RTLD_LOCAL</code> 加载具有相关符号的库。</li>
</ul>
</li>
<li>这允许 <code>std::type_info</code> 的比较操作的散列操作的高效实现。
<ul>
<li>使用 libstdc++ 时，需要定义宏 <code>__GXX_MERGED_TYPEINFO_NAMES</code> 为 <code>1</code> 。
<ul>
<li>这对应默认选项的<a href="https://gcc.gnu.org/viewcvs/gcc?view=revision&amp;revision=149964">修改</a> 。</li>
<li>一般不调整 <code>__GXX_TYPEINFO_EQUALITY_INLINE</code> ，使用默认选项。</li>
</ul>
</li>
<li>其它实现暂不使用选项支持，以避免和二进制约定冲突。
<ul>
<li>libc++ 不支持另行调整，由实现根据平台环境指定 <code>_LIBCPP_HAS_NONUNIQUE_TYPEINFO</code> 。</li>
</ul>
</li>
</ul>
</li>
<li>链接时除实现的二进制约定，假定 <code>std::type_info</code> 相关的符号被共享。
<ul>
<li>这不允许在实现生成以外显式地<a href="https://stackoverflow.com/questions/19496643/using-clang-fvisibility-hidden-and-typeinfo-and-type-erasure">隐藏相关的符号</a>（如通过 <code>#pragma</code> 预处理指令或 <code>-fvisibility=hidden</code> 编译器命令行选项）。</li>
<li>这一般要求在兼容 GNU ld 的链接器在<a href="https://sourceware.org/binutils/docs/ld/Options.html#Options">命令行选项</a>中使用 <code>--dynamic-list-cpp-typeinfo</code> 等方式导出相关符号（也允许但不要求使用 <code>-rdynamic</code> 或 <code>-export-dynamic</code> ）。</li>
</ul>
</li>
</ul>
</li>
<li>假定在标准库宏 <code>NDEBUG</code> 被定义的翻译单元中的代码不违反异常规范。
<ul>
<li>这允许改进代码生成，如使用 <a href="https://gcc.gnu.org/onlinedocs/gcc/C_002b_002b-Dialect-Options.html">G++ 的 <code>-fno-enforce-eh-specs</code> 选项</a>。</li>
<li>程序应不依赖违反异常规范时调用标准库的函数的行为。否则，程序行为未定义。</li>
</ul>
</li>
</ul>
<h3 id="历史实现要求"><a class="header" href="#历史实现要求">历史实现要求</a></h3>
<p>　　以下要求已被修改或取消。</p>
<ul>
<li>假定提供撤销标准库未定义行为的保证：
<ul>
<li>撤销 [res.on.functions]/2.5 对特定不完整类型作为模板实际参数引起未定义行为的限制，包括：
<ul>
<li>使用默认分配器（ <code>std::allocator</code> 的实例）的 <code>std::vector</code> 的 <code>value_type</code> 类型。
<ul>
<li>这被包含在 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4510.html">WG21 N4510</a> 。</li>
<li><code>ystdex::pmr::pool_resource</code> 的实现从 b843[2018-11-10] 起依赖这项特性。</li>
<li>从 b863[2019-07-26] 起不使用不完整类型的元素而不再依赖这项特性。</li>
</ul>
</li>
<li>使用默认分配器（ <code>std::allocator</code> 的实例）的关联容器（即 <code>std::map</code> 和 <code>std::set</code> ）的 <code>value_type</code> 类型。
<ul>
<li>对 <code>std::vector</code> 、 <code>std::list</code> 和 <code>std::forward_list</code> ， <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4510.html">WG21 N4510</a> 引入了不完整类型的支持。这<strong>不在</strong>此处要求。关联容器的要求预期在未来被添加。</li>
<li>已知 libstdc++ 的实现符合这个条件。</li>
<li>在 YSLib 中仅被 <code>YSLib::ValueNode</code> 通过在 <code>std::map</code> 使用递归的键类型的实现从 b338[2012-09-13] 起依赖。</li>
<li>因为使用 <code>ystdex::map</code> 替代 <code>std::map</code> ，从 b830[2017-08-11] 起取消这个要求，不再依赖标准库实现提供的扩展特性。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>假定特定类型的特定操作无异常抛出（但不依赖异常规范的行为），包括：
<ul>
<li><code>std::function::swap</code> （ <a href="http://wg21.cmeerw.net/lwg/issue2062">LWG 2062</a> 起有效）。
<ul>
<li>因为使用 <code>ystdex::function</code> 替代 <code>std::function</code> ，从 b848[2018-12-24] 起取消这个要求。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="可选实现支持"><a class="header" href="#可选实现支持">可选实现支持</a></h3>
<p>　　允许使用 ISO C++11 以后兼容最新标准草案的正式标准中的特性（可通过 <code>__cplusplus</code> 宏和 <a href="https://isocpp.org/std/standing-documents/sd-6-sg10-feature-test-recommendations">SG10 建议的特性检查</a>判断）。</p>
<h3 id="其它"><a class="header" href="#其它">其它</a></h3>
<p>　　不依赖实现的方言扩展，但在确保实现能支持时，在特定的代码中可通过条件包含等方式选用。</p>
<p>　　若实现默认具有不符合标准的特性，在本项目的代码中不依赖这些特性，即便外部依赖项可能对此进行配置（如 MinGW G++ 为了和 Microsoft VC++ 兼容启用的 <code>-mms-bitfields</code> ，而 MSYS2 安装的 freetype2 的 <code>pkg-config</code> 的 CFLAGS 隐含此参数）。</p>
<h2 id="保留名称"><a class="header" href="#保留名称">保留名称</a></h2>
<p>　　YSLib 项目中，除了 YBase.LibDefect 是对标准库实现的修正外，并不是语言的实现，因此公开接口遵循 ISO C++ 对保留名称的使用，如不引入以 <code>__</code> 起始的标识符。</p>
<p>　　对实现环境已经以保留标识符提供的接口，适用以下规则：</p>
<ul>
<li><code>&lt;ydef.h&gt;</code> 提供宏包装特定实现的标识符。</li>
<li>除标准预定义的（如 <code>__cplusplus</code> ）和用于特性检查的标识符（以 <code>__cpp</code> 或 <code>__has</code> 起始），以及上述被包装时的宏定义，不在注解（作为宏 <code>YB_ATTR</code> 和 <code>YB_ATTR_STD</code> 的参数）外直接使用保留标识符。</li>
</ul>
<p>　　<code>&lt;ydef.h&gt;</code> 和其它一些 YSLib 项目头文件保留特定的不被标准保留的标识符，详见 YSLib 项目文档 <code>doc/Definitions.txt</code> 。</p>
<h1 id="库概述"><a class="header" href="#库概述">库概述</a></h1>
<p>　　YSLib 项目由多个子项目组成。其中主要的有顶级子项目：YBase 和 YFramework 。它们是开发 YSLib 应用的必备的库。每个库被构建为单独的映像（静态库或动态库）。</p>
<p>　　YSLib 的组件有些是依赖于特定平台的，但更多是<strong>平台中立</strong>的。关于库的组件在此的不同，详见下文的解释。</p>
<p>　　静态库、动态库或其它可能被库构建时依赖的输入以及构建使用的工具是库构建的<strong>依赖项</strong>。关于依赖项的一般说明，详见<a href="Terminology.zh-CN.html">术语</a>中关于依赖管理的说明。</p>
<h2 id="平台模拟"><a class="header" href="#平台模拟">平台模拟</a></h2>
<p>　　除非另行指定，文档中的狭义的“模拟”概念指程序模拟。</p>
<p>　　YSLib 项目中，<strong>平台模拟(platform emulation)</strong> 主要指直接以运行时环境适配层嵌入宿主平台运行时，在具体程序中提供类似被模拟的目标平台的具体特性和接口。</p>
<p>　　完整的定义详见 YSLib 项目文档 <code>doc/CommonRules.txt</code> 。</p>
<h2 id="外部依赖项"><a class="header" href="#外部依赖项">外部依赖项</a></h2>
<p>　　<strong>外部依赖项</strong>在构建项目的上下文中，指构建时可能使用的外部依赖，是不由本项目维护和单独发布的依赖项。</p>
<p>　　YSLib 项目严格使用 ISO C++ 的子集和特定实现的可选的扩展。关于依赖的语言特性，参见<a href="StandardUsing.en-US.html">这里(en-US)</a> 。</p>
<p>　　在所有目标平台上，除了<strong>系统库</strong>外，外部依赖项是相同的，但可能使用不同的版本，也不一定按相同的配置构建。系统库的概念和 <a href="http://www.gnu.org/licenses/gpl.html">GNU GPLv3</a> 的 <a href="http://www.gnu.org/licenses/gpl-faq.html#SystemLibraryException">system library exception</a> 中的 system library 定义类似，在此指特定平台或操作系统提供运行时支持的、由特定第三方环境提供开发支持的外部依赖，例如提供特定平台的 ISO C++ 标准库部分实现的 libstdc++ 和提供 Windows API 实现的 GDI32 等。</p>
<p>　　除了系统库外，一部分外部依赖项可选或必须使用自行构建的（可能被修改的）版本。这些外部依赖项的修改和构建脚本位于版本库的 <code>3rdparty</code> 目录，默认按原始许可证发行。</p>
<p>　　YBase 只直接依赖 ISO C++ 标准库。</p>
<p>　　YFramework 默认依赖经过修改的 FreeType2 和 FreeImage 。其中前者当前仅修改头文件，经过特别处理和官方发布的直接构建的版本二进制兼容，可以被系统库替换。</p>
<p>　　当前版本中，不同宿主平台对应的静态库文件（后缀名为 <code>.a</code> ）查找的目录如下：</p>
<ul>
<li>/YFramework/DS/lib</li>
<li>/YFramework/MinGW32/lib</li>
<li>/YFramework/MinGW64/lib</li>
<li>/YFramework/Android/lib</li>
<li>/YFramework/Linux/lib</li>
</ul>
<p>　　其中，使用的 FreeImage 静态库对应 YFramework 的 <code>debug</code> 和非 <code>debug</code> 配置，文件名分别为 <code>libFreeImaged.a</code> 和 <code>libFreeImage.a</code> 。这可在同一个目录树中共存。</p>
<p>　　（当前 Android 和 Linux 仅支持单一本机体系结构，实际仅测试 Android ARMv7 和 Linux x86_64 。）</p>
<p>　　构建 YFramework 时需包含 <code>3rdparty/include</code> 目录的头文件。 <a href="Sysroot.zh-CN.html">Sysroot</a> 安装脚本 <a href="Tools/Scripts.zh-CN.html">Tools/install-sysroot.sh</a> 会复制包括上面的头文件在内的文件。</p>
<p>　　当前已经使用的详细外部依赖项详见 YSLib 项目文档 <code>doc/Dependencies.txt</code> 。</p>
<p><strong>注意</strong> 版本库历史中包括静态库(<code>.a</code>) 文件，但为减少版本库大小，不再更新且可能移除，使用外部源或自行构建的方式替代。参见<a href="Archives.zh-CN.html">归档</a>获取单独配置或和源代码目录集成的已编译的外部依赖项。</p>
<p>　　在 build 885 之前，版本库历史的对应的宿主平台中的静态库位于以下位置：</p>
<ul>
<li>/YFramework/DS/lib</li>
<li>/YFramework/MinGW32/lib-i686</li>
<li>/YFramework/Android/lib</li>
<li>/YFramework/Linux/lib-x86_64</li>
</ul>
<p>　　其中 Android 平台只包括 FreeType2 ，Linux 平台只包括 FreeImage 。其它平台包括 FreeType2 和 FreeImage 库文件。</p>
<p>　　其它平台中，只有随其它文件的发布版本包含完整更新，否则压缩包中可能只有其中一个库文件。</p>
<p>　　关于自行构建外部依赖项的方法，参见<a href="Build.zh-CN.html">构建说明</a>。</p>
<h2 id="模块"><a class="header" href="#模块">模块</a></h2>
<p>　　YSLib 项目组织为一个逻辑上的树形结构，其叶节点称为<strong>模块</strong>。类似文件系统，非叶节点称为<strong>模块目录</strong>。在源代码中使用<strong>模块路径</strong>来标识不同的模块，其分隔符为 <code>::</code> 。在 YSLib 项目下直接划分的<strong>顶级子项目</strong>的名称仅在必要时出现在模块路径中，完整模块路径一般从<strong>次级子项目</strong>的名称起始。</p>
<p>　　C 和 C++ 源代码的一个模块由以下三种形式之一构成：</p>
<ul>
<li>一个头文件</li>
<li>一个非头文件的源文件</li>
<li>一个头文件和对应的源文件</li>
</ul>
<p>　　作为公开接口的模块是公开模块。公开模块的头文件在单独的目录中以便部署。</p>
<p>　　按 ISO C 和 ISO C++ 规定， C 或 C++ 模块中存在的非头文件的源文件和包含的头文件构成一个 C 或 C++ （预处理）翻译单元，简称<strong>单元</strong>。注意这里包含的头文件不仅限于模块中的头文件。</p>
<p>　　关于模块的进一步说明以及模块路径的形式文法和头文件依赖的基本规则，参见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。</p>
<h2 id="文件系统布局"><a class="header" href="#文件系统布局">文件系统布局</a></h2>
<p>　　作为 C++ 项目， YSLib 把每个顶级子项目的源文件和公开模块头文件分别保存在不同的目录中，即 <code>include</code> 和 <code>source</code> 。非公开模块若有头文件，也位于 <code>source</code> 。</p>
<p>　　特定于目标平台配置的代码会直接位于 <code>平台名</code> 目录下，称为<strong>平台扩展</strong>。对应的两个目录为 <code>平台名/include</code> 和 <code>平台名/source</code> 。</p>
<p>　　除了平台扩展的内容，文件系统目录和模块目录的每一级对应。平台扩展的模块目录名是对应平台中立部分加上后缀 <code>_(平台名)</code> 。</p>
<p>　　举例：顶级子项目 YFramework 下的次级子项目 Helper 的非平台扩展的源代码在目录 <code>YFramework/include/Helper</code> 和 <code>YFramework/source/Helper</code> 中，它的 DS 平台扩展的源代码位于 <code>YFramework/DS/include/Helper</code> 和 <code>YFramework/DS/source/Helper</code> 中。</p>
<p>　　提供平台扩展的次级子项目只有 YCLib 和 Helper 。</p>
<p>　　编译项目时包含的头文件是合并的，如编译器命令行 <code>-IYFramework/DS/include -IYFramework/include</code> 在一次编译中同时使用平台中立和特定于平台 DS 的模块的 YFramework 头文件。</p>
<h2 id="yslib-及其本体"><a class="header" href="#yslib-及其本体">YSLib 及其本体</a></h2>
<p>　　在 YBase 和 YFramework 分离之前， YSLib 是一整个库。原 YSLib 大部分仍然在 YFramework 中，仍然可称为 YSLib ，是一个 YFramework 下的次级子项目。注意和整个项目名的不同，以下称为 <strong>YSLib 库</strong>，以示区分。</p>
<p>　　YSLib 库中， Adaptor 用于适配特定于具体外部依赖的接口。可以通过修改其中的代码替换外部依赖，包括部分标准库兼容接口。</p>
<p>　　其它部分的接口和实现都是严格平台中立且不依赖外部特定接口而变化的，称为<strong>本体</strong>。本体中提供了 YSLib 的主要功能。</p>
<h2 id="helper"><a class="header" href="#helper">Helper</a></h2>
<p>　　若需要开发依赖平台特定的应用，本体接口可能不足，而需要使用平台扩展。此外，可能需要一些便利功能。</p>
<p>　　在 YSLib 库之上，Helper 对此类需求提供了一致而灵活的接口。</p>
<p>　　若需要更接近特定平台实现的接口，可以使用 YCLib 及其平台扩展。</p>
<p>　　YCLib 和 Helper 在宿主实现上都提供了更加丰富的功能。</p>
<h1 id="代码规范"><a class="header" href="#代码规范">代码规范</a></h1>
<p>　　YSLib 项目维护的代码规范符合 YSLib 项目中的文档约定的规则，包括：</p>
<ul>
<li><code>doc/CommonRules.txt</code> ：一般规则。</li>
<li><code>doc/ProjectRules.txt</code> ：项目规则。</li>
<li><code>doc/LanguageConvention.txt</code> ：语言使用约定。</li>
</ul>
<p>　　YSLib 中的脚本代码应符合以下相关章节的约定。</p>
<h2 id="代码格式化"><a class="header" href="#代码格式化">代码格式化</a></h2>
<p>　　<code>doc/CommonRules.txt</code> 中规定了命名风格和参考的代码格式。由于格式化代码涉及语义分析，并不保证可以完全自动化进行，需要在编码时注意调整。</p>
<p>　　以下工具配置可以把其中的主要工作自动化进行：</p>
<ul>
<li><code>clang-format</code>
<ul>
<li>可通过 MSYS2 包 <code>mingw-w64-i686-clang</code> 或 <code>mingw-w64-x86_64-clang</code> 安装，以下配置以这里的 3.7 版本为基准测试</li>
<li>配置选项的文档参见<a href="http://clang.llvm.org/docs/ClangFormatStyleOptions.html">这里</a></li>
<li>通过命令行 <code>-style=</code> 指定使用选项文件 <code>Tools/YSLib.clang-format</code></li>
<li><strong>注意</strong> 至少以下格式需要手动调整
<ul>
<li>在 <a href="http://lists.llvm.org/pipermail/cfe-commits/Week-of-Mon-20160808/167367.html">r278121</a> 添加 <a href="https://reviews.llvm.org/D23317">SpaceAfterTemplateKeyword 支持</a> 前 <a href="http://stackoverflow.com/questions/34423615/cpp-template-spacing-using-clang-format-3-6-not-working-as-expected">只支持 <code>template &lt;</code> 而不支持 <code>template&lt;</code></a></li>
<li>行末的 <code>\</code> 前可能附加多个空格</li>
<li><code>{}</code> 会被拆分</li>
<li>部分宏会被作为块的起始叠加缩进</li>
<li>选项 <code>AlwaysBreakAfterReturnType</code> 未被支持，部分函数和函数模板声明的返回类型后缺少换行</li>
</ul>
</li>
<li>通过命令行 <code>-i</code> 直接编辑文件而不是打印结果到标准输出</li>
<li>命令行示例： <code>find YBase YFramework YSTest -name &quot;*.h&quot; -o -name &quot;*.hpp&quot; -o -name &quot;*. cpp&quot; | xargs clang-format -i -style=file</code></li>
<li>命令行示例： <code>find YBase YFramework YSTest -name &quot;*.h&quot; -o -name &quot;*.hpp&quot; -o -name &quot;*. cpp&quot; | xargs -i sh -c &quot;clang-format -i -style=file {}&quot;</code></li>
<li>命令行示例（同时替换 <code>template &lt;</code> ）： <code>find YBase YFramework YSTest -name &quot;*.h&quot; -o -name &quot;*.hpp&quot; -o -name &quot;*. cpp&quot; | xargs -i sh -c &quot;clang-format -i -style=file {} &amp;&amp; sed -bi 's/template &lt;/template&lt;/g' {}&quot;</code></li>
</ul>
</li>
<li><code>astyle</code>
<ul>
<li>可通过 MSYS2 包 <code>mingw-w64-i686-astyle</code> 或 <code>mingw-w64-x86_64-astyle</code> 安装，以下命令行以这里的 2.05.1 版本为基准测试</li>
<li>（版本 2.05 ）命令行选项的文档参见<a href="http://astyle.sourceforge.net/astyle.html">这里</a>
<ul>
<li><code>--help</code> 取得的文档可能<a href="https://github.com/Alexpux/MINGW-packages/issues/1011">有问题</a>， <code>--delete-empty-lines</code> 对应的短选项应为 <code>-xe</code> 而不是 <code>-xd</code></li>
</ul>
</li>
<li>使用命令行选项 <code>-A1 -T -p -U -k1 -xj -xy -xC80</code>
<ul>
<li>短选项可以缩写</li>
<li>和上述 <code>clang-format</code> 比较，少了部分功能，主要有
<ul>
<li><code>AlignAfterOpenBracket: DontAlign</code></li>
<li><code>AlignTrailingComments: true</code></li>
<li><code>AlwaysBreakAfterReturnType: All</code></li>
<li><code>MaxEmptyLinesToKeep: 2</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>注意</strong> 至少以下格式需要手动调整
<ul>
<li>无法正确识别 <code>constexpr</code> 导致错误的缩进</li>
<li>虽然<a href="http://sourceforge.net/p/astyle/bugs/265/">右值引用识别问题</a>已解决，但实测对模板参数无效</li>
<li>对 <code>extern &quot;C&quot;</code> 块冗余缩进</li>
<li>断行后的缩进</li>
<li>lambda 表达式的捕获列表中的 <code>=</code> 周围的冗余空格以及对应的 <code>{</code> 断行</li>
<li><code>static_cast</code> 等关键字后的 <code>&lt;&gt;</code> 周围的冗余空格</li>
<li>宏实际参数列表头部的 <code>(</code> 和作为第一个参数的标点可能有冗余空格</li>
<li>宏实际参数列表尾部的 <code>,)</code> 没有以空格隔离</li>
<li>初始化数组的列表 <code>{</code> 和之前的 <code>]</code> 存在冗余空格</li>
</ul>
</li>
<li>不使用 <code>-xp</code> ，尽管一些注释需要（移除行首 <code>*</code> 后保持一级缩进）的此类格式，但它会不必要地影响大部分 Doxygen 注释块</li>
<li>默认备份文件后缀 <code>.orig</code> ；可选使用 <code>-n</code> 取消备份文件，或 <code>--suffix=</code> 修改备份文件后缀</li>
<li>使用 <code>-r</code> 递归处理子目录</li>
<li>可选使用 <code>-v</code> 显示详细过程</li>
<li>可选使用 <code>-Q</code> 只显示被处理的文件</li>
<li>可选使用 <code>--dry-run</code> 不实际处理文件</li>
<li>命令行示例： <code>astyle -vQnrA1TpUk1xjxyxC80 YBase/*.h* YBase/*.cpp YFramework/*.h* YFramework/*.cpp YSTest/*.h* YSTest/*.cpp</code></li>
</ul>
</li>
</ul>
<h1 id="脚本"><a class="header" href="#脚本">脚本</a></h1>
<p>　　YSLib 版本库中包含若干脚本。这些脚本和 YSLib 安装部署的脚本使用本章中的约定。</p>
<p>　　脚本一般通过调用解释器运行。脚本的运行要求宿主环境（符合 YSLib 源码 <code>YF_Hosted</code> 定义支持的平台，指具有操作系统的环境）。</p>
<p>　　除非另行指定，脚本以文件的形式部署。</p>
<h2 id="外部环境"><a class="header" href="#外部环境">外部环境</a></h2>
<ul>
<li>除非另行指定，脚本不假定自身的存储位置。
<ul>
<li>一般地，这允许脚本的内容不总是可通过文件系统访问。这包括执行时脚本的来源被移除和不公开以文件的形式部署等情形。</li>
</ul>
</li>
<li>对文件系统中的脚本：
<ul>
<li>脚本文件总是普通文件或可解析到普通文件的有效的符号链接。</li>
<li>除非另行指定，不假定脚本文件所在的位置或其父路径可写。</li>
</ul>
</li>
</ul>
<p>　　项目中提供的脚本在版本库中具有固定的相对路径。除解释环境适用的公共的约定（如提供一般类 UNIX 系统使用的文件系统布局的 <a href="https://zh.wikipedia.org/zh-cn/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86">FHS（文件系统层次结构标准）</a>），脚本不预设绝对路径的假定。</p>
<p><strong>警告</strong> 小心处理路径。当前脚本直接或间接使用的所有涉及文件系统递归操作均不假设检查遍历的目标之间是否重复，若使用不恰当的目录链接，可能造成未预期的行为（如复制指向父目录的目录链接时可引起无限递归）。部署时应提前确保不存在这样的链接。</p>
<p>　　脚本实现假定没有可能冲突的并发文件访问。</p>
<h2 id="脚本文件"><a class="header" href="#脚本文件">脚本文件</a></h2>
<p>　　<strong>脚本文件总是使用以下约定的扩展名。</strong></p>
<p>　　除了 Windows 命令解释器使用的 <code>.cmd</code> 文件以及 <a href="../Features/NPL.zh-CN.html">NPLA1</a> 脚本使用的 <code>.txt</code> 文件，所有脚本使用 <a href="http://zh.wikipedia.org/zh-cn/Shebang">Shebang</a> 明确需要使用的解释环境（详见 Shell 脚本的说明）。</p>
<p>　　Windows 命令解释器脚本因为实现限制使用本机 ANSI 代码页的编码，约定为兼容 ASCII 。</p>
<p>　　NPLA1 脚本约定使用带有 BOM 的 UTF-8 编码（去除 BOM 的脚本可能兼容 ASCII ）。详见 <a href="SHBuild.zh-CN.html">stage 1 SHBuild 中关于 NPL 支持的说明</a>。</p>
<h2 id="接口约定"><a class="header" href="#接口约定">接口约定</a></h2>
<p>　　脚本变量可能被读取和加载。除非另行指定，非导出的变量和名称以 <code>_</code> 结尾的变量，都不是公开接口。</p>
<h3 id="路径"><a class="header" href="#路径">路径</a></h3>
<p>　　<em>路径(path)</em> 是由有限的路径组件构成的序列。在不引起歧义时，路径即指文件系统路径。文件系统的路径组件能以字符串形式表示。</p>
<p>　　在支持相对路径的环境中，是否支持相对路径取决于具体脚本。</p>
<p>　　内部的路径的分隔符使用 <code>/</code> 。通过<a href="Tools/Scripts.zh-CN.html">工具脚本</a>提供的 <code>SHBuild_2w</code> 等函数（见以下有关章节），可转换为带有不同路径分隔符的路径字符串。这种转换通常仅在必要时（如明确作为外部工具的输入）使用。</p>
<p>　　字符串形式的路径（即路径字符串）可能是保证不以分隔符结尾的文件名和确保以分隔符结尾的目录路径字符串。目录路径指目录路径字符串或其对应的非字符串形式的路径。</p>
<p>　　两个路径字符串的拼接可构成新的路径字符串。这两个路径字符串分别是路径前缀和路径后缀。除非另行指定，作为路径前缀使用的路径字符串是文件名。这要求通过串接路径后缀构成访问前缀指定的目录的新的路径时，路径后缀需要以分隔符起始。</p>
<p><strong>注意</strong> YBase 的 <code>ystdex::path</code> 和 YFramework 的 <code>YSLib::IO::Path</code> 等数据结构表示根路径外无视结尾分隔符的非字符串形式的路径，因为有效的分隔符仅在根路径中出现。这些实现一般不检查分隔符的合法性，如其中具有包含分隔符的路径组件，也可能正常转换为字符串形式的合法路径。当前脚本只使用字符串形式的路径。</p>
<h2 id="shell-脚本"><a class="header" href="#shell-脚本">Shell 脚本</a></h2>
<p>　　扩展名 <code>.sh</code> 的脚本文件是 shell 脚本文件。大多数脚本需要使用 <a href="https://www.gnu.org/software/bash/">GNU bash</a> 运行，如：</p>
<pre><code>#!/usr/bin/bash
</code></pre>
<p>　　需要考虑兼容性时，一般使用以下替代：</p>
<pre><code>#!/usr/bin/env bash
</code></pre>
<p>　　其它可以直接兼容 POSIX shell 的 <code>.sh</code> 脚本使用 Shebang 如：</p>
<pre><code>#!/usr/bin/sh
</code></pre>
<p>　　需要考虑兼容性时，一般使用以下替代：</p>
<pre><code>#!/usr/bin/env sh
</code></pre>
<p>　　为简化脚本代码，用户需要保证调用 shell 脚本时，环境应满足以下条件，否则行为未指定：</p>
<ul>
<li>使用满足要求的 Shell 语言实现：
<ul>
<li>对 bash 脚本：
<ul>
<li>满足版本要求：<strong>当前 Bash 最低版本为 4.0 。</strong></li>
<li>不使用 POSIX 兼容模式。</li>
<li>保证能使用 <code>mapfile</code> 等 <code>bash</code> 内建命令。</li>
</ul>
</li>
<li>对其它 POSIX shell 脚本：
<ul>
<li>使用符合 POSIX 的 shell ，或使用以上要求相同的 <code>bash</code> 运行 shell 脚本。</li>
</ul>
</li>
</ul>
</li>
<li>不论是否设置了变量 <code>POSIXLY_CORRECT</code> ，命令解释环境的变量满足：
<ul>
<li><a href="https://pubs.opengroup.org/onlinepubs/9699919799/utilities/V3_chap02.html#tag_18_14">特殊内建工具</a>没有被用户定义的同名变量或别名覆盖。</li>
<li>被脚本调用的 POSIX 定义的工具命令没有被用户定义的同名变量或别名覆盖为调用时可观察行为不等价的实体。</li>
<li>变量 <code>IFS</code> 未设置或设置为默认值 <code>:</code> 。</li>
</ul>
</li>
<li>命令解释器同 <code>bash</code> 的 <code>-p</code> 选项启用时效果相同。
<ul>
<li>用户应保证不设置 <code>CDPATH</code> 等 <code>-p</code> 忽略的环境变量及 <code>$BASH_ENV</code> 等启动文件，以避免未预期的不同行为。</li>
</ul>
</li>
<li>脚本文件不是目标在不同目录中的符号链接。
<ul>
<li>对 bash 脚本，允许使用变量 <code>BASH_SOURCE</code> 的值（如 <code>${BASH_SOURCE[0]}</code> 或 <code>${BASH_SOURCE%/*}</code> 等形式） 较可靠地判断脚本文件的路径。此时，隐含需要附加假定通过脚本文件路径确定其它资源的位置。</li>
<li>部分脚本可能有更进一步的使用限制或不依赖 <code>.</code> 命令及命令解释器调用的差异。此时，可直接使用 <code>&quot;$0&quot;</code> 判断路径。</li>
</ul>
</li>
</ul>
<p>　　脚本实现中的调用不受以上限制。</p>
<p>　　若脚本可以确保兼容 POSIX shell ，使用后者而不是前者。</p>
<p>　　如果对应解释器位于其它目录，可以符号链接到上面指定的路径。</p>
<p>　　除非另行指定，本文档约定使用的路径字符串的分隔符为 <code>/</code> ，不连续出现在路径中，且不在结尾出现。例外：</p>
<ul>
<li>平台相关的绝对路径转义可出现 <code>//</code> 。</li>
<li>构成路径的路径前缀可能以分隔符结尾，直接表示上层目录。</li>
</ul>
<p><strong>注意</strong> 当前版本库中的文件不保证跟踪权限。在一些环境中可能因为可执行权限问题导致无法立即执行脚本，参见<a href="../GettingSources.zh-CN.html">这里的说明</a> 。</p>
<p>　　<a href="../Releases.zh-CN.html">正式支持的发布版本</a>中的公开 Shell 脚本应保证用 <a href="https://www.shellcheck.net/">ShellCheck</a> 0.7 或以上版本（任选）检查没有诊断消息。检查的命令行为 <code>shellcheck -x -P SCRIPTDIR</code> 跟随文件名。除非另行指定，使用明确的方式避免引起检查的问题而不是使用指令消除检查的结果，如使用 <code>${BASH_SOURCE[0]}</code> 代替 <code>$BASH_SOURCE</code> 以避免 ShellCheck 警告 SC2128 。</p>
<h3 id="shell-语言使用规约"><a class="header" href="#shell-语言使用规约">Shell 语言使用规约</a></h3>
<p>　　脚本程序不调整影响别名扩展的 shell 选项（如 bash 的 <code>shopt -u expand_aliases</code> ）。</p>
<p>　　除非另行指定，已定义的 shell 函数假定不被其它变量覆盖。这允许实现省略 <code>readonly -f</code> 或 <code>declare -g -r -f</code> 声明，且允许使用相同的定义覆盖以简化调试。</p>
<p>　　除非另行指定，脚本不区分未设置的环境变量和已设置但具有空值的环境变量，以允许在外部环境配置脚本的执行。这两种情形脚本都可能指定一个非空的初始值，称为变量的<em>默认值(default value)</em> 。变量是否使用默认值总在先于第一次使用变量的值的初始化时确定。变量的初始化和默认值满足以下约定：</p>
<ul>
<li>初始化的变量是否只读未指定。</li>
<li>初始化变量时若需使用默认值，可能发生附加的求值（如命令调用）以其结果确定具体默认值。</li>
<li>除非变量的初始化被指定为由特定的函数确定，变量在未指定的脚本被执行时无条件初始化，而不需要使用变量的值前调用特定的函数。</li>
<li>除非另行指定，在特定函数中初始化的变量由此函数指定其默认值。</li>
<li>除非另行指定，初始化时使用的外部环境变量的值可假定和脚本运行环境直接或间接调用脚本前相同。</li>
</ul>
<p>　　除非另行指定，返回非数值的 shell 函数使用 <code>echo</code> 或功能蕴含 <code>echo</code> 的命令调用输出返回的值。</p>
<p>　　非生成的代码中不使用包含 <code>__</code> 的名称。</p>
<p>　　公开函数的函数名及公开的变量名不以 <code>_</code> 结尾，否则以一个 <code>_</code> 结尾。</p>
<p>　　对 <a href="SHBuild.zh-CN.html">SHBuild</a> 相关工具使用的函数，使用前缀 <code>SHBuild</code> 。</p>
<p>　　函数出错且无法恢复时退出脚本。</p>
<p>　　版本库中的提供的脚本一般应能通过 ShellCheck 检查。对需要使用 <a href="https://github.com/koalaman/shellcheck/wiki/Directive">ShellCheck 指令</a>指定脚本起始构造的检查时，在之前添加一行空命令（对 bash 脚本使用 <code>:</code> ，非 bash 脚本命令使用 <code>true</code> ）以避免非预期地使指令作用于整个脚本。</p>
<h3 id="环境变量"><a class="header" href="#环境变量">环境变量</a></h3>
<p>　　Shell 脚本可使用以下能通过外部环境指定值的环境变量：</p>
<ul>
<li>用于指定入口位置：
<ul>
<li><code>SHBuild</code> ：外部 SHBuild 可执行文件路径。
<ul>
<li>默认值和特定脚本被设计适应的部署环境相关（例如，视不同情形，脚本可使用 <code>${BASH_SOURCE[0]}</code> 或 <code>&quot;$0&quot;</code> ）。</li>
</ul>
</li>
<li><code>SHBuild_ToolDir</code> ：工具目录中的脚本目录（参见<a href="Tools/Scripts.zh-CN.html">脚本</a>）。
<ul>
<li>默认值由脚本根据版本库所在目录确定。</li>
</ul>
</li>
</ul>
</li>
<li>用于指定版本库中的资源： 
<ul>
<li><code>SHBuild_BaseDir</code> : SHBuild 目录，是工具目录中提供 SHBuild 源代码的目录。
<ul>
<li>默认值按 <code>SHBuild_ToolDir</code> 初始化后的相对位置确定，为 <code>&quot;$SHBuild_ToolDir/../SHBuild&quot;</code>。</li>
</ul>
</li>
<li><code>YSLib_BaseDir</code> ：YSLib 目录，即版本库的工作目录。
<ul>
<li>默认值按 <code>SHBuild_ToolDir</code> 初始化后的相对位置确定，为 <code>&quot;$SHBuild_ToolDir/../..&quot;</code>。</li>
</ul>
</li>
</ul>
</li>
<li>用于指定输出目录：
<ul>
<li><code>SHBuild_BuildDir</code> ：构建使用的中间输出文件路径。
<ul>
<li>默认值定义如下：
<ul>
<li>对不依赖 Sysroot 的以及 <code>YSLib/YSTest</code> 目录下的项目构建脚本，默认值指定在完整的版本库中和 <code>&quot;$YSLib_BaseDir/build/$(SHBuild_GetBuildName)&quot;</code> 相同的目录，且构建 <a href="Sysroot.zh-CN.html">stage 1</a> YSLib 时确保为绝对路径。</li>
<li>对 <code>YSLib/YDE</code> 目录下的项目构建脚本，默认值是 <code>&quot;.$(SHBuild_GetBuildName)&quot;</code> 。</li>
<li>否则，默认值是当前工作目录 <code>.</code> 。</li>
<li>以上调用的函数 <code>SHBuild_GetBuildName</code> 在脚本 Tools/Scripts/SHBuild-common.sh 中，依赖具有非空值的变量 <code>SHBuild_Host_OS</code> 和 <code>SHBuild_Host_Arch</code> 。</li>
</ul>
</li>
</ul>
</li>
<li><code>SHBuild_SysRoot</code> ：输出的 Sysroot 根路径。
<ul>
<li>在 stage 1 中，默认值是 <code>&quot;$YSLib_BaseDir/sysroot&quot;</code> 。</li>
</ul>
</li>
</ul>
</li>
<li>用于配置构建环境：
* 其它情形不用于指定输出目录，不保证具有默认值。
<ul>
<li><code>SHBuild_Env_TempDir</code> ：构建时使用的临时目录路径。
<ul>
<li>由脚本 Tools/Scripts/SHBuild-common.sh 的函数 <code>SHBuild_PrepareBuild</code> 初始化。</li>
<li>默认值由脚本 <code>Tools/Scripts/SHBuild-common.sh</code> 中的函数 <code>SHBuild_GetTempDir</code> 的调用确定。</li>
</ul>
</li>
<li><code>SHBuild_Env_Arch</code> ：构建系统架构。
<ul>
<li>由脚本 Tools/Scripts/SHBuild-common.sh 的函数 <code>SHBuild_CheckUName</code> 初始化。</li>
</ul>
</li>
<li><code>SHBuild_Env_OS</code> ：构建系统操作系统。
<ul>
<li>初始化和确定值的方式同 <code>SHBuild_Env_Arch</code> 。</li>
</ul>
</li>
<li><code>SHBuild_Host_Arch</code> ：宿主架构。
<ul>
<li>由脚本 Tools/Scripts/SHBuild-common.sh 的函数 <code>SHBuild_PrepareBuild</code> 初始化。</li>
<li>默认值使用以下方式指定：
<ul>
<li>当 <code>SHBuild_Env_OS</code> 的值是 <code>Win32</code> 且外部变量 <code>MSYSTEM</code> 的值是 <code>MSYSTEM64</code> 时，默认值为 <code>x86_64</code> 。</li>
<li>当 <code>SHBuild_Env_OS</code> 的值是 <code>Win32</code> 且外部变量 <code>MSYSTEM</code> 的值是 <code>MSYSTEM32</code> 时，默认值为 <code>i686</code> 。</li>
<li>其它情形默认值同 <code>SHBuild_Env_Arch</code> 初始化后的值。</li>
</ul>
</li>
</ul>
</li>
<li><code>SHBuild_Host_OS</code> ：宿主操作系统。
<ul>
<li>初始化的方式同 <code>SHBuild_Host_Arch</code> 。</li>
<li>默认值同 <code>SHBuild_Env_OS</code> 初始化后的值。</li>
</ul>
</li>
<li><code>SHBuild</code> 构建使用的变量：详见 SHBuild 的帮助信息。</li>
<li>其它构建脚本使用的变量：详见以下具体脚本的说明。</li>
</ul>
</li>
</ul>
<p>　　若以上变量在上述任一情形存在作为路径的默认值且外部环境指定变量的值，则指定的值应表示合法的路径。</p>
<p>　　一般地，部署的 shell 脚本需引用其它脚本时，以如下方式使用指定入口的环境变量：</p>
<ul>
<li>若脚本只支持 Sysroot ，以 <code>SHBuild</code> 在 Sysroot 的安装位置推断其它脚本的路径。</li>
<li>若脚本只支持工具目录中的脚本目录布局，以 <code>SHBuild_ToolDir</code> 指定。
<ul>
<li>这隐含目录在版本库中的布局，可以此初始化 <code>YSLib_BaseDir</code> 等变量的默认值。</li>
</ul>
</li>
<li>若脚本同时支持 Sysroot 中部署的位置和工具目录中的脚本目录布局：则不使用以上的变量。
<ul>
<li>引用其它脚本文件时可直接指定包含，如：<code>. &quot;$(dirname &quot;${BASH_SOURCE[0]}&quot;)/SHBuild-common.sh&quot;</code> 。</li>
</ul>
</li>
</ul>
<p>　　除指定入口的环境变量，是否支持外部可覆盖默认值的上述环境变量是可选的，取决于各个脚本的具体支持。</p>
<h2 id="npla1-脚本"><a class="header" href="#npla1-脚本">NPLA1 脚本</a></h2>
<p>　　NPLA1 脚本可被 SHBuild 调用。SHBuild 支持特定的选项作为 NPLA1 的脚本解释器。脚本解释器支持 NPLA1 脚本文件。此外，在 shell 脚本中，NPLA1 脚本代码可能以字符串的形式存储和被 SHBuild 调用。</p>
<h3 id="环境变量-1"><a class="header" href="#环境变量-1">环境变量</a></h3>
<p>　　NPLA1 脚本可使用和 shell 脚本通用的环境变量，如 <code>SHBuild</code> 。</p>
<p>　　除 stage 1 外，shell 脚本使用环境变量 <code>NPLA1_ROOT</code> 指定的根目录作为 SHBuild 加载 NPLA1 脚本使用的起始目录。</p>
<p>　　脚本（包括直接或间接调用 NPLA1 脚本的其它脚本）除默认值外不需要依赖 Sysroot 的安装路径下的目录和文件布局，环境变量 <code>SHBuild</code> 和 <code>NPLA1_ROOT</code> 可分别指定相互无依赖的路径。当仅指定 <code>SHBuild</code> 时，通过指定的 SHBuild 路径推断 <code>NPLA1_ROOT</code> 默认值，此时使用假定符合 Sysroot 约定的相对路径。</p>
<p>　　NPLA1 脚本可使用以上约定含义和默认值的 shell 环境变量并初始化 NPLA1 脚本内的同名变量，但部分变量的作用域和初始化方式可能不同：</p>
<ul>
<li>在 Tools/Scripts/SHBuild-YSLib-common.txt 中直接初始化变量 <code>SHBuild_Env_Arch</code> 和 <code>SHBuild_Env_OS</code> 。</li>
<li>在 Tools/Scripts/SHBuild-YSLib-common.txt 的函数 <code>SHBuild_GetPlatformStrings</code>（详见版本库中的 <code>doc/NPL.txt</code>）的调用中初始化变量 <code>SHBuild_Host_Arch</code> 和 <code>SHBuild_Host_OS</code> 。</li>
</ul>
<p>　　注意在 NPLA1 脚本中创建的变量不是环境变量；但和 shell 脚本类似，若需作为其它外部命令的环境变量，可先导出再调用对应的程序。</p>
<h3 id="npla1-函数"><a class="header" href="#npla1-函数">NPLA1 函数</a></h3>
<p>　　NPLA1 脚本可提供部分 shell 脚本中的同名函数。除非另行指定，这些函数的调用接口以及功能和 shell 脚本中的同名函数一致，但实现和以下行为不保证相同：</p>
<ul>
<li>出错时的诊断方式；</li>
<li>缓存的变量及相关的输出提示信息；</li>
<li>性能；</li>
<li>影响的非公开环境变量等其它外部环境状态。</li>
</ul>
<p>　　作为公开接口的 NPLA1 函数另见 <code>doc/NPL.txt</code> 中的描述。</p>
<h2 id="构建脚本"><a class="header" href="#构建脚本">构建脚本</a></h2>
<p>　　一些开发脚本被用于构建。构建脚本的一般形式提供配置和生成阶段的自动化功能。</p>
<p>　　配置阶段设置交互环境（典型地，通过执行命令前设置的环境变量）。</p>
<p>　　生成阶段调用合适的工具完成构建。</p>
<p>　　配置阶段的接口可能对外隐藏，此时使用默认配置进行构建。</p>
<p>　　一些公用的构建脚本可适用于整个项目。其它的构建脚本可构建具体子项目中的目标。</p>
<p>　　构建脚本可以是 makefile 或其它可执行的脚本。其中，makefile 可能使用以上约定含义的 shell 环境变量，但不保证可被外部指定覆盖脚本中指定的默认值。</p>
<h1 id="参考"><a class="header" href="#参考">参考</a></h1>
<ul>
<li>YSLib 项目文档 <code>doc/Dependencies.txt</code> 了解组织结构、开发规则、默认使用的外部依赖项（包括语言实现）和相关约定。</li>
<li><a href="Features.zh-CN.html">结构和特性</a> 中的树形结构了解项目依赖性。</li>
<li>YSLib 项目文档 <code>doc/ProjectRules.txt</code> 了解组织结构、开发规则和相关约定。</li>
<li>YSLib 项目文档 <code>doc/YBase.txt</code> 了解顶级子项目 YBase 。</li>
<li>YSLib 项目文档 <code>doc/YFramework.txt</code> 了解顶级子项目 YFramework 。</li>
<li>YSLib 项目文档 <code>doc/YSLib.txt</code> 了解 YFramework 的次级子项目 YSLib 。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="先决条件"><a class="header" href="#先决条件">先决条件</a></h1>
<p>　　特定历史版本依赖的详细环境和平台库版本参见开发文档 <code>doc/Dependencies.txt</code> 。以下仅为当前最新主分支版本中用于构建 YSLib 自身及基于 YSLib 开发应用的环境配置说明。</p>
<p>　　关于本项目对平台的定义和项目保持的环境约束，包括开发需要的以下基础环境外的其它第三方依赖，在了解下文内容后，参见<a href="Development.zh-CN.html">开发说明</a>。</p>
<p><strong>注意</strong> <a href="GettingSources.zh-CN.html">获取到源代码</a>并不保证能够直接构建 YSLib （特别是对于直接从版本库获取的途径）。如需自行构建，应注意<a href="Development.zh-CN.html">开发说明</a>中有关外部依赖项的部分获取必要的其它文件。</p>
<p>　　关于运行环境，另见<a href="Run.zh-CN.html">运行时平台环境的说明</a>。</p>
<p>　　详细提交测试的环境参见开发文档 <code>doc/Test.txt</code> 。</p>
<p>　　若不使用特定的特性或构建平台，构建环境的部分要求是可选的。</p>
<p>　　以下各节的环境配置以“宿主平台/目标平台(目标平台名)”为标题指定，其中目标平台名是正式的配置名称（也在其它项目文档中作为配置名称使用），若和平台一致则被省略；其它平台的标识当前仅为明确开发流程，在用户文档中使用。对宿主平台和目标平台两者一致的情形，只标识一个平台。关于“平台”的一般含义，参见<a href="Terminology.zh-CN.html">术语</a>。</p>
<h2 id="公共构建环境"><a class="header" href="#公共构建环境">公共构建环境</a></h2>
<p>　　构建环境提供工具链（语言实现）和构建需要的工具。某些工具被不同的构建环境共享（但可能仍需针对不同构建平台使用不同二进制程序）。</p>
<p>　　Windows 平台上的 MSYS2 基础环境符合以下公共构建环境的所有要求。当前发布和一般提交（包括本机平台和交叉构建）时仅测试 MSYS2 。</p>
<h3 id="命令行环境"><a class="header" href="#命令行环境">命令行环境</a></h3>
<p>　　除非另行指定，构建环境的命令兼容 POSIX shell 。当前非 POSIX shell 的命令行构建环境仅在 <a href="Sysroot.zh-CN.html">Sysroot stage 2 环境</a> 被支持。</p>
<h3 id="工具链"><a class="header" href="#工具链">工具链</a></h3>
<p>　　使用 <code>make</code> 的平台需要 POSIX shell 支持。</p>
<p>　　除非另行指定， <code>make</code> 使用 GNU make ，版本 3.78 以上（建议使用 4.0 以上版本，虽然 YSLib makefile 不使用不兼容的特性）；不使用 <code>mingw32-make</code> 。</p>
<p>　　注意 <code>make</code> 可能被构建工具使用，详见以下链接时优化的说明。</p>
<p>　　POSIX shell 实现可使用<a href="Tools/Scripts.zh-CN.html">和工具脚本兼容的脚本解释环境</a> ，一般即 <code>bash</code> （建议版本 4.0 或以上）。</p>
<p>　　除非另行指定，直接支持的 C++ 实现为 GNU C++ 4.9 或以上版本。</p>
<h3 id="自动环境检测"><a class="header" href="#自动环境检测">自动环境检测</a></h3>
<p>　　在命令行环境中使用<a href="Tools/Scripts.zh-CN.html">脚本</a>构建时，脚本可能自动检测构建环境而需要附加的工具。这些工具可能在具体的构建环境（如以下各节）中可能已被提供或可选安装，参阅各个构建环境附带的文档。</p>
<ul>
<li><code>grep</code> ：用于判断线程支持的命令行选项。</li>
<li><code>uname</code> ：用于查询平台配置。</li>
</ul>
<p>　　使用特定的选项跳过自动检测构建时，可不依赖某些工具。详见具体脚本的说明。</p>
<h3 id="控制台和终端"><a class="header" href="#控制台和终端">控制台和终端</a></h3>
<p>　　除了自动检测环境（ Win32 或非 Win32 下使用 ANSI 转义序列）开启的彩色（前景色）文本，构建环境没有使用依赖特定终端的字符界面。因此可以使用不同的控制台或终端模拟器。</p>
<p><strong>注意</strong> 在 Windows 平台上若使用 ConEmu 出现 0xC0000005 错误，尝试<a href="https://code.google.com/p/conemu-maximus5/wiki/MicrosoftBugs">升级到最新版本后勾选 Inject ConEmuHk 选项</a> ，或直接使用 <code>cmd</code> 代替。</p>
<h3 id="线程执行环境"><a class="header" href="#线程执行环境">线程执行环境</a></h3>
<p>　　除非另行指定，线程执行环境使用 ISO C++ 的定义，参见 <a href="http://www.eel.is/c++draft/intro.multithread">ISO C++ [intro.multithread]</a> 。</p>
<p>　　库或接口的集合对多线程环境的依赖性满足以下要求：</p>
<ul>
<li>明确<strong>不依赖多线程执行环境</strong>时，保证在指定<a href="Terminology.zh-CN.html">平台</a>上可用的的公开 API 可构建并满足接口约定的语义，可在单线程执行环境中运行。</li>
<li>明确<strong>严格不依赖多线程执行环境</strong>时，在不依赖多线程执行环境的要求上，还应保证语义一致。</li>
<li>否则，不保证接口提供的功能可用。</li>
</ul>
<p>　　YSLib 整体不依赖多线程执行环境。特定的依赖多线程执行的情形包括以下话题：</p>
<ul>
<li>使用 ISO C++ 线程环境（首先要求实现满足<a href="Development.zh-CN.html">整体要求</a>）：
<ul>
<li>运行时环境需要部署的线程支持库，参见以下章节对各个平台的说明。</li>
<li>特定的依赖线程环境语义的接口，参见具体组件的开发文档（如 <code>doc/YSLib.txt</code> ）及源代码中的 API 注释或以此<a href="BuildDocumentation.zh-CN.html">构建 API 文档</a>。</li>
</ul>
</li>
<li>特定的平台实现使用非 ISO C++ 线程模型或实现（不保证<a href="Terminology.zh-CN.html">平台中立</a>）：
<ul>
<li>不会作为对所有平台必要的公开接口。</li>
<li>YCLib 提供 POSIX API 封装。</li>
<li>其它实现细节参见开发文档 <code>doc/YCLib.txt</code> 等。</li>
</ul>
</li>
</ul>
<h3 id="链接时优化lto"><a class="header" href="#链接时优化lto">链接时优化(LTO)</a></h3>
<p>　　YSLib 默认在 release 构建配置下通过向编译器和链接器传递命令行参数 <code>-flto</code> 等启用 LTO 。若工具链不支持 LTO ，可能需要自行修改脚本去除相关选项——这不被正式支持。</p>
<p>　　MSYS2 的 MinGW 目标的 binutils-git 包的 <code>gnu-ar</code> 较早启用了 LTO 插件，可以直接使用。现在 MSYS2 的 MinGW 目标的 binutils 包也应支持。其它工具链需自行验证。</p>
<p><strong>注意</strong> <a href="http://gcc.gnu.org/gcc-4.9/changes.html">GCC 4.9 起使用 LTO 默认不启用 -ffat-lto-objects 选项</a>，因此需要链接器具有 LTO 插件支持，否则在启用 <code>-flto</code> 选项时会出现无法解析符号的链接错误。</p>
<p><strong>注意</strong> <a href="https://github.com/gcc-mirror/gcc/blob/master/gcc/lto-wrapper.c#L1309">GCC 的 LTO wrapper 默认使用 <code>make</code></a> ，若没有 <code>make</code> 也没有通过指定 <code>MAKE</code> 环境变量替代，构建时使用 <code>-flto</code> 会失败。</p>
<h2 id="pcdsds"><a class="header" href="#pcdsds">PC/DS(DS)</a></h2>
<p>　　支持的构建环境：</p>
<ul>
<li>DS 交叉编译环境，包括
<ul>
<li>使用 <code>make</code> 的公共构建环境</li>
<li>ARM 目标平台 C/C++ 交叉编译环境</li>
<li>生成 .nds 文件的 <code>ndstool</code> 工具</li>
<li>环境变量 <code>DEVKITARM</code> 指定工具路径（见以下说明）</li>
</ul>
</li>
</ul>
<p>　　支持的运行环境：</p>
<ul>
<li>Nintendo/iQue DS[Lite/i/LL]
<ul>
<li>仅测试了 iQue DS Lite</li>
</ul>
</li>
<li>DeSmuME 0.9.9 <strong>（注意新版本因为<a href="http://wiki.desmume.org/index.php?title=Faq#How_can_I_run_homebrew_games_that_require_DLDI_patching_.3F">自动 DLDI</a> 存在缺陷，暂时不支持运行自制程序。）</strong></li>
</ul>
<p>　　环境变量 <code>DEVKITARM</code> 指定一个 POSIX 路径，其中的 <code>bin</code> 子目录下包括工具。示例（ POSIX shell 使用 Windows 路径）：</p>
<pre><code>export DEVKITARM=/C/devkitPro/devkitARM
</code></pre>
<p>　　建议使用发布时最新版本的 <a href="http://devkitpro.org/">devkitPro</a> 。</p>
<p>　　devkitPro 在 Windows 下提供 MSYS ，在 devkitPro 安装目录下 <code>msys/bin</code> 包含 <code>bash</code> 等程序。可把此路径添加到环境变量 <code>PATH</code> 。也可使用 MSYS2 替代。</p>
<p>　　发布和一般提交时仅测试 devkitPro 最新版本，目标平台三元组 arm-none-eabi。</p>
<h2 id="pcwin32"><a class="header" href="#pcwin32">PC(Win32)</a></h2>
<p>　　Windows 平台使用 Microsoft VC++ 构建。因为一些已知的问题，暂不正式支持。参见以下 MinGW32 平台的构建条件以获取 Windows 可执行文件。</p>
<p>　　但以下的部分信息和 MinGW 通用。</p>
<h3 id="windows-子系统subsystem"><a class="header" href="#windows-子系统subsystem">Windows 子系统(subsystem)</a></h3>
<p>　　<a href="http://zh.wikipedia.org/zh-cn/Windows_NT%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84">Windows NT 内核以上支持不同的称为<em>子系统</em> 的用户模式运行时环境</a> ，主要包括 Win32 子系统、 OS/2 子系统和 POSIX 子系统。</p>
<p>　　因为标准库实现以及 YFramework 的部分组件依赖 Win32 API ， YSLib 在 Windows 上的实现依赖 Win32 子系统。</p>
<p>　　Microsoft Visual C++ 提供 <a href="http://msdn.microsoft.com/zh-cn/library/fcc1zstk.aspx"><code>/SUBSYSTEM</code> 链接器选项</a>来指定不同的子系统。在此 <code>CONSOLE</code> 指定控制台程序，而 <code>WINDOWS</code> 指定非控制台的通常使用 GUI 的程序，它们都使用 Win32 子系统实现。</p>
<p>　　控制台程序和 GUI 程序的入口不同，也有一些行为上的不同。例如，启动控制台程序默认会显示命令行窗口； GUI 程序忽略命令行的交互式输入。</p>
<h3 id="操作系统版本"><a class="header" href="#操作系统版本">操作系统版本</a></h3>
<p>　　Windows 操作系统版本一般对（非交叉编译的）构建没有直接影响，但有以下例外：</p>
<p>　　GCC 的<strong>预编译头文件不保证对系统兼容</strong>：升级系统后可能出现错误，例如升级 Windows 10 1803 以后的系统，使用旧的预编译头文件（而不更改编译器二进制文件），可能出现以下内部错误：</p>
<pre><code>internal error in mingw32_gt_pch_use_address, at config/i386/host-mingw32.c:184: MapViewOfFileEx: 试图访问无效的地址。
</code></pre>
<p>　　此时删除所有预编译头文件，或不使用预编译头文件重新构建即可。类似的问题在其它的项目中<a href="https://jira.reactos.org/browse/CORE-8053">也是已知的问题</a>，使用类似的方式解决。</p>
<p>　　另外，<a href="https://github.com/msys2/MINGW-packages/issues/5067">部分 Windows 版本可能存在不明原因的内核缺陷导致类似的问题</a>。不仅限于构建，这些问题可能对运行也有影响。</p>
<h3 id="预编译头文件"><a class="header" href="#预编译头文件">预编译头文件</a></h3>
<p>　　部分构建使用可选的预编译头文件。</p>
<h2 id="pcmingw32"><a class="header" href="#pcmingw32">PC(MinGW32)</a></h2>
<p>　　MinGW32 包含 32 位和 64 位宿主和目标平台。关于 MinGW 或 MinGW32 的称谓，参见<a href="https://github.com/FrankHB/pl-docs/blob/master/zh-CN/mingw-vs-mingw-v64.md">这里</a>的说明。</p>
<p>　　支持的构建环境：</p>
<ul>
<li>目标 32 位(i686) MinGW GCC 工具链。
<ul>
<li>支持不同的 MinGW 运行时
<ul>
<li><a href="https://sourceforge.net/projects/mingw-w64/">MinGW-W64</a> （目标三元组 i686-w64-mingw32 ）。</li>
<li><a href="http://mingw.org/">MinGW.org</a> （目标平台三元组 i686-pc-mingw32 ）</li>
</ul>
</li>
<li>要求标准库多线程支持，否则只支持构建 YBase ，不支持构建 YFramework 。
<ul>
<li>当前 <a href="https://gcc.gnu.org">GCC 官方</a>的 libstdc++ 只提供 POSIX 线程模型的支持，不支持 Win32 线程模型。</li>
<li>可考虑使用 <a href="https://github.com/lhmouse/mcfgthread">mcfgthread</a></li>
</ul>
</li>
<li>仅测试 Windows 上的本机构建（构建平台三元组同目标平台三元组）。
<ul>
<li>一般提交时仅测试 MinGW-W64 的发行版。</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>　　非正式支持的构建环境：</p>
<ul>
<li>目标 64 位(x86_64) MinGW GCC 工具链（目标平台三元组 x86_64-w64-mingw32 或 x86_64-pc-mingw32 ）。</li>
<li>以上工具链中使用 LLVM 和 Clang++ 代替 GCC 。
<ul>
<li>只测试 MSYS2 。</li>
<li>当前暂不支持 LLD（ MSYS2 包 <code>mingw32/mingw-w64-i686-lld</code> ）。</li>
</ul>
</li>
</ul>
<p>　　对 i686 平台， YSLib 版本库中 <code>/YFramework/MinGW32/lib-i686</code> 目录用于保存外部依赖项 FreeType2 和修改版 FreeImage 的二进制文件。</p>
<p>　　对 x86_64 平台，需要自行编译依赖项。若构建环境存在可二进制兼容的 FreeType2 ，只需要编译修改版本的 FreeImage 。</p>
<p>　　支持的运行环境：</p>
<ul>
<li>Microsoft Windows XP 或以上版本操作系统
<ul>
<li>对于 64 位目标工具链构建的程序，需要 64 位操作系统</li>
</ul>
</li>
<li>构建环境匹配的附加运行库，默认支持的工具链包括：
<ul>
<li><code>libwinpthread-1.dll</code></li>
<li><code>libgcc_s_dw2-1.dll</code></li>
<li><code>libstdc++-6.dll</code></li>
</ul>
</li>
</ul>
<p>　　注意以上运行库未在发布版本中打包。此处依赖的详细说明参见开发文档 <code>doc/Dependencies.txt</code> @1.5.2 。</p>
<p>　　若缺少 DLL ，也可在 MinGW32 GCC 发行版中的 <code>bin</code> 目录下找到。</p>
<p><strong>特别注意</strong> 应使用对应的正确的线程模型（使用 POSIX 或 MCF 而不是 Win32 ，后者没有实现标准库的线程支持）以及异常模型（ i686 为 Dwarf2 和 SjLj 之一，特定构建版本相关）。运行时 DLL 不匹配会导致错误。</p>
<h3 id="msys2"><a class="header" href="#msys2">MSYS2</a></h3>
<p>　　建议使用 <a href="http://sourceforge.net/projects/msys2">MSYS2</a> ，相关问题可参考<a href="https://sourceforge.net/p/msys2/wiki/Home/">官方 Wiki</a> 。</p>
<p>　　MSYS2 以从 <a href="https://wiki.archlinux.org/index.php/Main_page_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29">Arch Linux</a> 移植的 <a href="https://wiki.archlinux.org/index.php/Pacman_%28%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29">pacman</a> 作为包管理器，可以直接通过命令行安装和移除不同的包，包括开发工具。以下环境也可用于开发其它 MSYS2 或 MinGW32 应用（忽略标注为 YSLib 的步骤即可）。</p>
<h4 id="体系结构和命令行调用"><a class="header" href="#体系结构和命令行调用">体系结构和命令行调用</a></h4>
<p>　　一个 MSYS2 环境同时支持 MSYS2 和 i686(x86) 和 x86_64(x64) 的 MinGW32 三个目标平台。其中 MSYS2 目标类似 <a href="https://www.cygwin.com/">Cygwin</a> ，运行时依赖特定的 POSIX 兼容层 DLL （这里一般是 msys-2.0.dll ），性能往往较依赖 <a href="https://msdn.microsoft.com/en-us/library/abx4dbyh.aspx">MSVCRT</a> （默认版本现在 Windows 系统中应都已存在部署）的 MinGW32 目标低。所以不需要严格的 POSIX 兼容的应用尽量使用 MinGW 而不是 MSYS2 目标。</p>
<p>　　MSYS2 自身也存在不同的体系结构而成为目标平台。和 MinGW32 不同，每个基础环境是 i686 和 x86_64 之一。在 x64 Windows 上，可以通过部署多个基础环境，合理设置环境变量 <code>PATH</code> 来切换使用 i686 或 x86_64 （而 32 位 Windows 只支持 i686 ）路径；但一般情形下只需要使用其中之一。这个决定一般会作用到所有 MSYS2 程序，如 <code>bash</code> 。</p>
<p>　　不论是 i686 还是 x86_64 的 MSYS2 基础环境，都可以选择安装 i686 或 x86_64 的 MinGW32 目标的包，但因为使用不同的 MSYS2 程序，两者并非可完全替换。</p>
<p><strong>注意</strong> 因为基础环境中 <code>uname</code> 是位于 <code>/usr/bin</code> 的 MSYS2 程序，基础环境的体系结构会影响 <code>uname</code> 的结果而导致目标体系结构的自动判断结果不同，当前可能会影响后续需要的命令，详见 <a href="Sysroot.zh-CN.html">MinGW Sysroot 开发指令</a>。</p>
<p><strong>注意</strong> MSYS2 程序和不同体系结构的（本机或其它 MSYS2 ）程序混用可能出现问题。参见下文关于 MSYS2 程序运行问题的说明。</p>
<p>　　一个 MSYS2 环境中可能同时存在不同目标的程序，通过合理控制环境变量 <code>PATH</code> 的顺序或在调用时加前缀(prefix) 控制。例如 <code>/usr/bin/gcc.exe</code> 和 <code>/mingw32/bin/gcc.exe</code> 可能同时存在，分别是 MSYS2 和 i686 MinGW32 的 GCC ，可通过以下方式确定调用 MinGW32 GCC ：</p>
<ul>
<li>在 <code>PATH</code> 中使 <code>/mingw32/bin</code> 尽量靠前来指定 <code>gcc</code> 调用 MinGW32 而不是 MSYS2 GCC</li>
<li>若存在 <code>i686-w64-mingw32-gcc</code> 等明确目标平台的版本，一般可以直接在命令行中代替 <code>gcc</code></li>
<li>明确路径前缀，即使用 <code>/mingw32/bin/gcc</code> 代替 <code>gcc</code></li>
</ul>
<p>　　某些工具可能在附加路径前缀 <code>/mingw32</code> 指定此类程序的安装位置。但当前 YSLib 不提供工具控制这些部署方式，默认只使用第一种方式：手动配置 <code>PATH</code> 。</p>
<p>　　MSYS2 MinGW 工具链使用 POSIX 线程模型。</p>
<p>　　MSYS2 MinGW i686 工具链使用 Dwarf2 异常模型。</p>
<p>　　当前 YSLib 不支持 MSYS 目标。</p>
<h4 id="主要配置步骤"><a class="header" href="#主要配置步骤">主要配置步骤</a></h4>
<p>　　（某些步骤和原理也可参考<a href="https://sourceforge.net/p/msys2/wiki/MSYS2%20installation/">官方 Wiki</a> 。）</p>
<ul>
<li>进入<a href="https://sourceforge.net/projects/msys2/files/Base/">官方发布站点</a>/<a href="http://mirror.bit.edu.cn/msys2/Base/">北京理工大学镜像</a>/<a href="https://mirrors.tuna.tsinghua.edu.cn/msys2/distrib/">清华大学 TUNA 镜像</a>/<a href="http://mirrors.ustc.edu.cn/msys2/distrib/">中国科学技术大学开源软件镜像</a>的其中一个子目录下载 MSYS2 基础环境
<ul>
<li>目录 <code>i686</code> 和 <code>x86_64</code> 针对 MSYS2 而非 MinGW32 目标</li>
<li>一般尽量选择较新的 <code>x86_64</code> 版本</li>
<li>如果有能解压缩 <code>.xz</code> 的软件，可以直接下载压缩包，否则选择 <code>.exe</code> 文件；对应版本内容一致</li>
</ul>
</li>
<li>安装 MSYS2 基础环境到自定义的目录如 <code>C:\msys2</code> （以下称为<strong>MSYS2 根目录</strong>）
<ul>
<li>注意 Win32 下 <code>PATH_MAX</code> 为 <code>260</code> ，此处最好避免过长的路径以使一些软件具有更好的兼容性</li>
<li>对压缩包直接利用现有工具解压；对可执行文件直接执行安装 </li>
<li>之后，<strong>必须</strong>执行 MSYS2 根目录下的 <code>msys2_shell.bat</code> 确保完成安装</li>
</ul>
</li>
<li>设置环境变量
<ul>
<li>可总是使用 MSYS2 根目录下自带的批处理文件打开 终端（默认是 <code>mintty</code> ），会自动在终端环境的 <code>PATH</code> 变量前加入对应所需的路径，不需要另行设置
<ul>
<li>对较新的版本（安装了 <code>filesystem-2016.05-2</code> 或更新版本的包）的 MSYS2 基础环境安装，分别运行 <code>msys2_shell.cmd -msys</code> 、 <code>msys2_shell.cmd -mingw32</code> 和 <code>mingw64_shell.bat -mingw64</code> 进入对应的 MSYS2 、 MinGW32 和 MinGW64 的 shell</li>
<li>对未更新 <code>filesystem-2016.05-2</code> 或更新版本的包的 MSYS2 旧版本基础环境安装，分别运行 <code>msys2_shell.cmd</code> 、 <code>mingw32_shell.bat</code> 和 <code>mingw64_shell.bat</code> 进入对应的 MSYS2 、 MinGW32 和 MinGW64 的 shell</li>
</ul>
</li>
<li>也可直接一次性设置 Windows 系统环境变量（注意需要符合 Windows 的路径格式，每个路径之间以分号分隔），这样可以对其它命令行环境（如 <code>cmd</code> ）生效
<ul>
<li>需要设置 <code>bash</code> 所在的 MSYS 工具的目录（即 MSYS2 根目录下的 <code>/usr/bin</code> ）以及 MinGW 目标编译器和其它工具所在的目录（对 32 位的目标为 MSYS2 根目录下的 <code>/mingw32/bin</code> ）</li>
<li><strong>注意</strong> 因为 MSYS 和 MinGW 是不同的目标，使用不同的 GCC （可能被同时安装），需要保证 MinGW 编译器被优先搜索，所以 MinGW 目录一般应在 MSYS 目录之前</li>
</ul>
</li>
<li><a href="http://sourceforge.net/p/msys2/tickets/4/">一些构建环境可能会依赖环境变量 <code>MSYSTEM</code> 的值， MSYS2 根目录批处理文件进入的不同环境对此有不同的设置</a>，但当前 YSLib 不依赖此变量，可以不另行设置</li>
</ul>
</li>
<li>确保能搜索到正确的 MinGW 编译器
<ul>
<li>可以进入 Shell 执行命令 <code>/usr/bin/which gcc</code> ，确定输出的结果为 MinGW 编译器（默认为 <code>/mingw32/bin/gcc.exe</code> 和 <code>/mingw64/bin/gcc.exe</code> 之一）而不是 MSYS 编译器（默认为 <code>/usr/bin/gcc.exe</code> ）</li>
<li>若已确保 MSYS 根目录下 <code>/usr/bin</code> 目录在环境变量 <code>PATH</code> 中，直接进入 <code>cmd</code> 或 Shell 直接执行 <code>which gcc</code> ，方法和效果与上述方法相同</li>
<li>可以直接在命令行执行 <code>gcc -v</code> 查看输出，确认 <code>Target: </code> 带有后缀 <code>-w64-mingw32</code></li>
</ul>
</li>
<li>建议手动执行 <code>pacman -Syu</code> 自行升级，或 <code>pacman -S</code> 安装所需的包的最新版本</li>
<li>若用于构建 YSLib ，建议<a href="GettingSources.zh-CN.html">获取源代码</a>后，进入 <code>bash</code> （此处也可以使用其它 Shell ）后运行 POSIX Shell 脚本 <code>Tools/msys2-pacman-update.sh</code> 以确保 YSLib 构建需要的依赖项被安装
<ul>
<li>脚本不会重复安装已经安装的包</li>
</ul>
</li>
</ul>
<p>　　上述脚本调用 MSYS2 的包管理器 <code>pacman</code> 分批下载安装或更新所需工具：首先安装必要的工具，其次安装可选（但推荐）的工具。具体内容详见脚本代码。若安装工具时需要确认，按 <code>Y</code> 并回车。</p>
<h4 id="配置安装源"><a class="header" href="#配置安装源">配置安装源</a></h4>
<p>　　官方镜像配置参见 <a href="https://github.com/Alexpux/MSYS2-packages/tree/master/pacman-mirrors">pacman-mirrors</a> 。</p>
<p>　　若 <code>pacman</code> 下载过慢，可用文本编辑器打开 MSYS 根目录下的 <code>/etc/pacman.d</code> 中的配置文件，编辑对应的镜像地址。如对于 32 位的 MinGW 包，在 <code>mirrorlist.mingw32</code> 的其它非注释行之前插入：</p>
<pre><code>## 清华大学 TUNA 镜像（ 2016-09-23 已变更，注意大小写）
Server = http://mirrors.tuna.tsinghua.edu.cn/msys2/mingw/i686
## 中国科学技术大学开源软件镜像（之前曾停止更新，最后更新 2015-06-18 ； 2015-11-01 已恢复）
Server = http://mirrors.ustc.edu.cn/msys2/mingw/i686
## 北京理工大学镜像（最后更新早于 2017-02-09）
Server = http://mirror.bit.edu.cn/msys2/REPOS/MINGW/i686
</code></pre>
<p>　　因为包 mingw-w64-x86_64-freetype 的 FreeType2 可二进制兼容， x86_64 平台只需要编译修改版本的 FreeImage 。</p>
<h4 id="msys2-程序运行问题"><a class="header" href="#msys2-程序运行问题">MSYS2 程序运行问题</a></h4>
<p>　　MSYS2 类似 Cygwin ，依赖 <code>fork</code> 调用创建新进程。这可能会出错。</p>
<p>　　在执行以下步骤（参考<a href="http://sourceforge.net/p/msys2/tickets/74/">这里</a>）后，重新运行程序：</p>
<ul>
<li>关闭窗口或用任务管理器终止 <code>sh.exe</code> 和 <code>bash.exe</code> 等进程并尽量确保没有基于 MSYS2 环境的其它程序正在被运行</li>
<li>执行 MSYS 根目录下的 <code>autorebase.bat</code></li>
</ul>
<p>　　也可以参考 <a href="https://www.cygwin.com/faq.html#faq.using.fixing-fork-failures">Cygwin 的解决方法</a>。</p>
<p>　　混用 x86/x64 程序（不管是 Win32 还是 MSYS 程序）导致的类似问题可能经以上步骤仍然无法修复，这可由 MSYS2 <a href="http://sourceforge.net/p/msys2/tickets/208/">在特定操作系统上的一个缺陷</a>引起。变通做法是只使用固定目标的程序，例如只使用 i686 MSYS 基础系统执行 i686 MinGW32 GCC 。注意 i686 MinGW32 GCC 是 x86 的 Win32 程序。尽管它不是 MSYS2 程序，但可在 LTO 时调用 MSYS2 程序 <code>make</code> ，这时候可能出错。</p>
<p>　　如果确定只使用少数程序，在命令行指定替换。例如 x86_64 的 MSYS2 bash 环境中使用 i686 MinGW32 GCC ，指定 LTO 调用的 <code>make</code> ：</p>
<pre><code>export MAKE=/path-to-another-msys2-root/mingw32/make
</code></pre>
<p>　　或直接替换所有 <code>make</code> ：</p>
<pre><code>export make=/path-to-another-msys2-root/mingw32/make
</code></pre>
<p><strong>注意</strong> <code>%SystemRoot%\System32\cmd.exe</code> 在 x64 Windows 下是 x64 程序，对应的 x86 版本是 <code>%SystemRoot%\SysWOW64\cmd.exe</code> 。</p>
<h3 id="gcc-with-the-mcf-thread-model"><a class="header" href="#gcc-with-the-mcf-thread-model">GCC with the MCF thread model</a></h3>
<p>　　也可使用 <a href="https://gcc-mcf.lhmouse.com/">MCF 线程模型构建的 GCC</a> ，基于 MinGW-W64 和 mcfgthread ，使用 MCF 线程模型。</p>
<p>　　这个发行版没有 <code>make</code> 。</p>
<p>　　需自行编译依赖项。</p>
<p>　　未在提交中测试。</p>
<h3 id="mingw-builds"><a class="header" href="#mingw-builds">MinGW-Builds</a></h3>
<p>　　也可使用 <a href="http://mingw-w64.sourceforge.net/">MinGW-W64</a> 发行版，如 <a href="http://sourceforge.net/projects/mingw-w64/files/latest/download">mingw-builds</a> ，并自行获得和配置脚本 <code>Tools/msys2-pacman-update.sh</code> 中被安装的工具。</p>
<p>　　需使用基于 POSIX 线程模型的版本，否则只可用 YBase 。</p>
<p>　　需自行编译依赖项。</p>
<p>　　当前未测试。</p>
<h3 id="nuwennet"><a class="header" href="#nuwennet">Nuwen.net</a></h3>
<p>　　对 x86_64 平台可使用 <a href="http://nuwen.net/mingw.html">newen.net</a> 提供的 MinGW 发行版，包含比较多的第三方库。</p>
<p>　　仍需自行编译依赖项以支持 YFramework （当前不支持）。</p>
<p>　　因为 15.2 之前的版本仅支持 Win32 线程模型，不支持 <code>std::thread</code> 等标准库线程 API ，不支持生成 YFramework ，只支持生成 YBase 。</p>
<p>　　当前未测试。</p>
<h3 id="windows-子系统subsystem-1"><a class="header" href="#windows-子系统subsystem-1">Windows 子系统(subsystem)</a></h3>
<p>　　基本内容参见以上 PC(Win32) 平台关于 Windows 子系统(subsystem) 的介绍。</p>
<p>　　在 MinGW 工具链的命令行中，选项 <code>-mconsole</code> 和 <code>-mwindows</code> 对应 Microsoft VC++ 工具链的子系统选项。若没有指定，一般默认为前者。通常 <code>-mwindows</code> 隐式使用一些附加的库，如 <code>-lgdi32 -lcomdlg32</code> 。和 VC++ 不同，当前使用的 MinGW 实现一般可以支持统一使用 <code>main</code> 作为入口，不需要特别修改。</p>
<p>　　对 <code>gcc</code> 或 <code>g++</code> ，使用 <code>-dumpspecs</code> 查看内建支持的 specs 。 Clang/Clang++ 不适用 specs ，需要查看文档和源代码。</p>
<h2 id="pcandroid"><a class="header" href="#pcandroid">PC/Android</a></h2>
<p>　　支持的构建环境：</p>
<ul>
<li>Android 开发环境（仅测试 Windows x64 宿主环境），包括：
<ul>
<li>使用 <code>make</code> 的公共构建环境。</li>
<li>JDK（仅测试 Oracle JDK 1.8 ；注意 Android 仅支持部分 Java 8 特性）。</li>
<li>Android SDK 。</li>
<li>Android SDK Build-tools 。</li>
<li>Android NDK （仅使用独立工具链）。</li>
<li>用于打包 APK 的私钥（用 Tools/create-android-debug-keystore.sh 可生成默认私钥）。</li>
</ul>
</li>
</ul>
<p>　　支持的运行环境：</p>
<ul>
<li>Android 模拟器，运行操作系统 Android 5 （对应 API level 21 ），或更高版本（未测试，可能有兼容性问题）。</li>
<li>物理设备，操作系统要求同上（未正式测试，可能有兼容性问题）。</li>
</ul>
<h1 id="pclinux"><a class="header" href="#pclinux">PC/Linux</a></h1>
<p>　　当前仅用于可移植性测试。要点：</p>
<ul>
<li>当前仅测试 x86-64 （提供 FreeImage 二进制文件）</li>
<li>可用被支持版本的 G++ 或 Clang++ </li>
<li>因为不提供 freetype2 的二进制库，需要保证 freetype2 库文件可用，可以通过 <code>pkg-source</code> 找到或位于 <code>/usr/lib</code> 路径中</li>
<li>使用 XCB 作为系统库，但功能不全</li>
</ul>
<p>　　Windows 10 可使用 <a href="https://zh.wikipedia.org/zh-cn/Windows_Subsystem_for_Linux">WSL(Windows Subsystem for Linux)</a> 。</p>
<p>　　注意 Windows 10 秋季创意者更新（版本 1709 ）的 WSL 存在<a href="https://github.com/Microsoft/WSL/issues/2606">已知可导致并行构建失败的缺陷</a> ，以及可能有的<a href="https://github.com/Microsoft/BashOnWindows/issues/2534">其它问题</a> ，本项目不针对这些问题单独提供变通。</p>
<h1 id="其它构建环境"><a class="header" href="#其它构建环境">其它构建环境</a></h1>
<p>　　集成开发环境是可选的，参见<a href="Build.zh-CN.html">构建</a>。</p>
<p>　　关于文档构建需要的依赖，参见<a href="BuildDocumentation.zh-CN.html">构建文档</a>。</p>
<p>　　关于执行工具脚本需要的环境，参见<a href="Tools/Scripts.zh-CN.html">脚本</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="获取源代码"><a class="header" href="#获取源代码">获取源代码</a></h1>
<p>　　建议通过 <a href="https://www.mercurial-scm.org/">Mercurial</a> 或 <a href="http://git-scm.com/">Git</a> 获取仓库中的最新代码。</p>
<p><strong>注意</strong> 构建过程可依赖源代码中不直接提供的二进制文件。详见<a href="Build.zh-CN.html">构建</a>中的说明。</p>
<h2 id="通过-mercurial"><a class="header" href="#通过-mercurial">通过 Mercurial</a></h2>
<p>　　安装 Mercurial ，使用命令行</p>
<pre><code>hg clone https://hg.osdn.net/view/yslib/YSLib YSLib
</code></pre>
<p>　　得到源代码的本地副本。</p>
<p>　　若已有本地副本，可使用</p>
<pre><code>hg pull -u
</code></pre>
<p>　　同步更新到最新版本。</p>
<p>　　或者安装 GUI 客户端（如 <a href="http://tortoisehg.bitbucket.org/">TortoiseHg</a> ）进行以上操作。具体使用参考软件附带的手册。</p>
<h2 id="通过-git"><a class="header" href="#通过-git">通过 Git</a></h2>
<p>　　安装 Git ，使用以下命令行之一得到源代码的本地副本：</p>
<pre><code>git clone https://github.com/FrankHB/YSLib.git YSLib
</code></pre>
<pre><code>git clone https://gitee.com/FrankHB/YSLib.git YSLib
</code></pre>
<p>　　若已有本地副本，可使用</p>
<pre><code>git pull
</code></pre>
<p>　　同步更新到最新版本。</p>
<p>　　或者安装 GUI 客户端（如 <a href="http://tortoisegit.net/">TortoiseGit</a> ）进行以上操作。具体使用参考软件附带的手册。</p>
<p><strong>注意</strong> Git 版本库是 Mercurial 版本库的镜像。不同版本库可具有不同的传输性能；使用合适的镜像可能大幅改善同步的体验。上述版本库都是官方维护的，大多数时候不需要担心同步时效性，但镜像版本库的更新仍可能比主版本库稍晚数分钟到数小时。</p>
<h2 id="下载已发布版本"><a class="header" href="#下载已发布版本">下载已发布版本</a></h2>
<p>　　<a href="Releases.zh-CN.html">已经发布的版本</a>列出了可以直接下载的测试发布版本。</p>
<p>　　可以在以下<a href="Archives.zh-CN.html">归档</a>中获得特定发布版本的源代码和部分二进制文件。</p>
<p>　　注意这些代码通常比版本库中的旧。在 <a href="Releases.zh-CN.html">Beta 阶段</a>前也不表示更稳定。</p>
<h2 id="文件权限"><a class="header" href="#文件权限">文件权限</a></h2>
<p><strong>已知缺陷</strong> Windows 上的 Mercurial 不跟踪可执行位。</p>
<p>　　若在其它环境中因此无法执行脚本，在版本库根目录下执行以下 shell 命令变通：</p>
<pre><code>find . -type f -name &quot;*.sh&quot; -exec chmod +x {} \;
</code></pre>
<p>　　因为约定<a href="Tools/Scripts.zh-CN.html">总是使用 <code>*.sh</code> 作为可执行的脚本的扩展名</a>，不需要考虑其它文件。</p>
<h2 id="历史资源"><a class="header" href="#历史资源">历史资源</a></h2>
<p>　　因为代码托管站点不再提供服务，以下资源已过时：</p>
<ul>
<li>曾经可用，当前服务已经停止：
<ul>
<li><a href="https://code.google.com/">Google Code</a>: <code>hg clone https://yslib.googlecode.com/hg/ YSLib</code></li>
<li><a href="http://gitcafe.com">GitCafe</a>: <code>git clone https://gitcafe.com/FrankHB/YSLib.git YSLib</code></li>
</ul>
</li>
<li>已经无法同步：
<ul>
<li><a href="https://bitbucket.org">Bitbucket</a>: <code>hg clone https://bitbucket.org/FrankHB/yslib YSLib</code></li>
</ul>
</li>
<li>被取代：
<ul>
<li><a href="http://git.oschina.net">OSChina</a>: <code>git clone http://git.oschina.net/FrankHB/yslib.git YSLib</code>（使用 Gitee 代替）</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="准备-1"><a class="header" href="#准备-1">准备</a></h1>
<ul>
<li>参见<a href="Development.zh-CN.html">开发说明</a></li>
<li>参见<a href="ProjectDependencies.zh-CN.html">项目依赖性</a>了解 YSLib 子项目之间的联系</li>
</ul>
<h1 id="外部依赖项构建"><a class="header" href="#外部依赖项构建">外部依赖项构建</a></h1>
<p>　　这个步骤是可选的。若已获取二进制的库文件，可以跳过。</p>
<p>　　YSLib 发布的文件和对应使用的外部依赖项（包括二进制的库文件）可以<a href="Archives.zh-CN.html">从归档仓库下载</a>。</p>
<p>　　进入 <code>3rdparty</code> 对应库的目录查看 <code>Readme</code> 文件说明。按此说明进行构建，一般方法为：</p>
<ul>
<li>自行获取指定的公开发行的源代码</li>
<li>复制 <code>3rdparty</code> 库的目录中的文件到源代码，替换源代码中的原始文件</li>
<li>运行指定的构建脚本命令行</li>
</ul>
<h1 id="库和示例程序构建"><a class="header" href="#库和示例程序构建">库和示例程序构建</a></h1>
<p>　　以下主要描述构建项目的默认目标：库和示例程序 <code>YSTest</code> 。对特定的构建方式，支持附加的其它目标。</p>
<p><strong>注意</strong> 除了 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 外，当前没有实现子项目间的依赖管理。由于<a href="Releases.zh-CN.html">非正式版不保证二进制兼容性</a>，直接增量构建可能在更新代码后失败。此时可手动清理构建生成的中间目录即 <code>build</code>。</p>
<p>　　另见<a href="BuildDocumentation.zh-CN.html">构建文档</a>。</p>
<h2 id="使用构建工具和脚本"><a class="header" href="#使用构建工具和脚本">使用构建工具和脚本</a></h2>
<p>　　这是宿主平台的建议构建方式，支持所有的构建目标。</p>
<p>　　基本使用详见 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 和 <a href="Sysroot.zh-CN.html">Sysroot</a> 。</p>
<p>　　b600 起用于发布和测试的二进制文件使用 SHBuild 构建。</p>
<p>　　当前版本的构建使用以下方式：</p>
<ul>
<li>调用 <code>Tools/install-sysroot.sh</code> 构建 Sysroot 。
<ul>
<li>确保环境变量 <code>SHBuild_UseDebug</code> 和 <code>SHBuild_UseRelease</code> 的值非空。</li>
<li>确保环境变量 <code>SHBuild_NoStatic</code> 、 <code>SHBuild_No3rd</code> 和 <code>SHBuild_NoDev</code> 的值为空。</li>
</ul>
</li>
<li>在 Sysroot 部署完成后，设置环境变量 <code>PATH</code> 包含 Sysroot 布局下的<a href="Sysroot.zh-CN.html">二进制目录</a>。
<ul>
<li>对配置名 <code>debug-static</code>、<code>debug</code>、<code>release-static</code> 和 <code>release</code> ，以配置名作为第一参数分别调用 <code>YSTest/SHBuild-YSTest.sh</code> 构建示例项目 <code>YSTest</code> 的各个配置。</li>
<li>类似地，调用 <code>YDE/install-all.sh</code> 构建 <a href="YDE.zh-CN.html">YDE</a> 中所有包的各个配置。</li>
</ul>
</li>
</ul>
<h2 id="microsoft-visual-studio"><a class="header" href="#microsoft-visual-studio">Microsoft Visual Studio</a></h2>
<p>　　源代码包含 Microsoft Visual Studio 2012/2013 解决方案 .sln 文件。可以直接生成解决方案。注意若修改被依赖项目代码后直接生成，依赖项目也不会重新编译，需要手动清除或重新编译。</p>
<p>　　当前包含了平台中立项目（便于源代码管理，不实际生成）、 DS 项目 、 MinGW32 项目和 Android 项目，但仅支持生成使用 make 的平台（ DS 和 Android ，需要对应的工具链支持）。因为正确支持的语言特性不足， Visual Studio 使用的编译器不能正常生成 Win32 项目。</p>
<p>　　使用 Microsoft Visual Studio 打开文件，需特定的环境变量以保证使用 makefile 的项目可构建。以下（使用 兼容 <code>bash</code> 的）路径仅为示例：</p>
<p>　　DS 项目：</p>
<pre><code>DEVKITPRO=/opt/devkitpro
</code></pre>
<p>　　Android 项目：</p>
<pre><code>ANDROID_SDK = /d/Android/sdk
PATH = /d/clang-android/bin:/c/Program\ Files/Java/jdk1.8.0_211/bin:$PATH
</code></pre>
<p><strong>注意</strong> Visual Studio 项目使用的 makefile 命令行依赖 <code>bash</code> 以及时检测到错误停止生成，可参见<a href="Prerequisitions.zh-CN.html">先决条件</a>配置宿主环境。</p>
<p>　　支持生成的 Visual Studio 项目包含依赖性，不需要另行设置；也支持清理命令。</p>
<h2 id="codeblocks"><a class="header" href="#codeblocks">Code::Blocks</a></h2>
<p>　　从 b217 (2011-06-13) 起支持。</p>
<p>　　源代码包含 Code::Blocks 工作空间 .workspace 文件，建议使用 Code::Blocks 12.11 或以上版本打开。</p>
<p><strong>注意</strong> 打开工作空间后直接生成，其中的项目不都能成功构建，因为并非所有项目都保证能生成。项目名没有平台后缀的不用于构建，仅作为项目原型便于开发。</p>
<p>　　当前包含了平台中立项目（项目名不含下划线，便于源代码管理，不实际生成）、 DS 项目和 MinGW32 项目，支持构建 DS 项目和 MinGW32 项目，每个分别包含 debug 和 release 配置。除此之外， MinGW32 项目还支持 debug_DLL 配置和 release_DLL 配置，用于生成动态链接库或使用动态链接库生成可执行文件。</p>
<p>　　对于 DS 可以分别编译其它各个项目，但不能运行。可以在工具菜单添加 DeSmuME 命令行运行。</p>
<p>　　b599 (2015-05-21) 起支持通过<a href="Tools/Scripts.zh-CN.html">脚本 GenerateProjects.sh</a> 生成 .cbp 文件。和 Visual Studio 不同，项目文件的内容不保证最新。这些文件以后仅保证在<a href="Releases.zh-CN.html">发布版本</a>更新。</p>
<p>　　b600 前用于发布和测试的二进制文件使用此方式构建。因为编译时使用的文件路径不同等原因，构建的二进制文件和 SHBuild 不完全等价。</p>
<h2 id="make-命令行"><a class="header" href="#make-命令行">make 命令行</a></h2>
<p>　　和 Visual Studio 类似，Code::Blocks 项目文件仅用于查看项目文件，当前不作为首要的构建途径被支持。</p>
<p>　　虽然 Code::Blocks 具有模块化设计，但仍有一些欠缺可配置性及文档的逻辑被集成在核心（使用 C++ 实现，且不容易改动）而造成问题，如：</p>
<ul>
<li>头文件搜索使用字符串匹配。
<ul>
<li>这直接导致在编辑器中无法定位宏名形式的 <code>#include</code> 的路径。</li>
<li>这种形式实际被 YFramework 及 FreeType 使用。</li>
</ul>
</li>
<li>在运行时环境插入 <code>PATH</code> 环境变量的前缀，不保证和构建时相同也不可由用户指定去除。
<ul>
<li>前缀包括 <code>.</code> 、链接器和调试器的可执行文件所在的路径。</li>
<li>因为是前缀，当前路径及链接器和调试器可执行文件的路径直接污染环境变量，无法通过其它设置去除。</li>
<li>当这些路径具有和构建时不同版本的动态库时，使用 Code::Blocks 运行程序会使用错误的动态库。</li>
<li>因此，使用 Code::Blocks 运行程序时，为了使用正确的动态库，不同的版本的动态库不能和工具链共存。</li>
</ul>
</li>
</ul>
<p>　　由于这些自身的局限性，Code::Blocks 不适合作为现代的集成开发环境，没有在现状以外其它的改进支持的计划。</p>
<p>　　使用 <code>make</code> 构建适用于使用 Makefile 的平台，当前包括 DS 和 Android 。</p>
<p>　　设 $Configuration 是生成配置名称，则</p>
<p>　　在各个项目目录下运行</p>
<pre><code>make -r BUILD=$Configuration
</code></pre>
<p>　　即可生成。</p>
<p>　　在各个项目目录下运行</p>
<pre><code>make -r BUILD=$Configuration rebuild
</code></pre>
<p>　　即可重新生成。</p>
<p>　　在各个项目目录下运行</p>
<pre><code>make -r BUILD=$Configuration clean
</code></pre>
<p>　　即可清除生成。</p>
<p><strong>注意</strong> 因为不同子项目的 makefile 之间不追溯依赖关系，直接运行 makefie 需明确依赖顺序，参见<a href="ProjectDependencies.zh-CN.html">项目依赖性</a>。</p>
<p>　　和其它构建方式类似，YFramework 依赖于 YBase 。对 DS 项目，注意附加的项目依赖性以确定生成顺序：</p>
<ul>
<li>YSTest/DS_ARM9 依赖 YFramework 。</li>
<li>YSTest 依赖 YSTest/DS_ARM7 和 YSTest/DS_ARM9 。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="准备-2"><a class="header" href="#准备-2">准备</a></h1>
<ul>
<li><a href="GettingSources.zh-CN.html">获取源代码</a></li>
<li>安装带有图形界面前端的 Doxygen</li>
<li>安装 Graphviz/Dot 工具（见注意事项）</li>
</ul>
<h1 id="构建"><a class="header" href="#构建">构建</a></h1>
<p>　　使用 Doxywizard(Doxygen GUI) 打开目录下的 Doxygen 文件，选择 Run 选项卡，点击 Run doxygen 按钮等待完成即可。</p>
<p>　　构建文档的内容主要来自源文件中的注释。</p>
<p>　　默认的输出路径在 <code>doc/html</code> 。打开其中的 <code>index.html</code> 进入主页。</p>
<h1 id="注意事项"><a class="header" href="#注意事项">注意事项</a></h1>
<ul>
<li>Dot 工具的路径是被硬编码的。
<ul>
<li>如果不确定安装的位置，使用前清空 <code>DOT_PATH</code> ，并设置 <code>PATH</code> 环境变量使二进制文件能被找到。可以直接编辑 Doxyfile 或者在 Expert 选项卡的 Dot 项中设置 <code>DOT_PATH</code> 。</li>
</ul>
</li>
<li>当前配置使用 <code>DOT_IMAGE_FORMAT</code> 为 <code>svg</code> 而不是默认的 <code>png</code> ，生成的文件不支持 Intenet Explorer 9 以前版本的浏览器。</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概述"><a class="header" href="#概述">概述</a></h1>
<p>　　这是单列的测试顶级子项目。</p>
<p>　　预期覆盖整个项目中的各个<a href="Features.zh-CN.html">库</a>，但目前仅测试 YBase 。框架部分的主要测试由示例程序 YReader 完成。</p>
<h1 id="准备-3"><a class="header" href="#准备-3">准备</a></h1>
<ul>
<li>参见<a href="Build.zh-CN.html">构建</a></li>
<li>参见<a href="Development.zh-CN.html">开发说明</a></li>
<li>配置满足<a href="Prerequisitions.zh-CN.html">先决条件</a>的对应平台运行环境</li>
</ul>
<h1 id="依赖"><a class="header" href="#依赖">依赖</a></h1>
<p>　　当前测试脚本 <code>test.sh</code> 依赖<a href="Tools/Scripts.zh-CN.html">工具脚本</a> ，并使用相同的解释环境。</p>
<h1 id="运行"><a class="header" href="#运行">运行</a></h1>
<p>　　测试脚本 <code>test.sh</code> 构建测试程序并运行。</p>
<p>　　当前测试程序只包括 YBase::YStandardEx 的相关内容。</p>
<p>　　以标准输出显示测试项的数量和每个测试项的结果。通过为 <code>PASS.</code> ，失败为 <code>FAIL.</code> 。</p>
<h2 id="配置"><a class="header" href="#配置">配置</a></h2>
<p>　　变量 <code>TestDir</code> 表示当前测试使用的目录，默认值即为 <code>test</code> 目录。</p>
<p>　　和工具脚本类似，变量 <code>SHBuild_ToolDir</code> 指定工具脚本目录。测试脚本据此包含构建配置所需的工具脚本。因为默认定位到此路径，不需要依赖 <a href="Sysroot.zh-CN.html">Sysroot</a> 安装脚本。</p>
<p>　　在包含工具脚本前，测试脚本使用（当前被直接硬编码在脚本中）以下配置：</p>
<pre><code>CXXFLAGS_OPT_UseAssert=true
SHBuild_Debug=debug
SHBuild_NoAdjustSubsystem=true
</code></pre>
<p>　　脚本不会调用 <code>SHBuild</code> 。脚本直接接受的参数附加为使用 <code>$CXX</code> 构建时命令行选项。</p>
<p>　　和构建 YBase 和 YFramework 库的工具脚本类似，测试脚本支持预编译头文件。但因为默认直接使用 <code>TestDir</code> 作为输出路径，修改配置后可能需要手动清理 <code>gch</code> 文件以免预编译头文件失效。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="准备-4"><a class="header" href="#准备-4">准备</a></h1>
<ul>
<li>参见<a href="Build.zh-CN.html">构建</a></li>
<li>参见<a href="Development.zh-CN.html">开发说明</a></li>
<li>配置满足<a href="Prerequisitions.zh-CN.html">先决条件</a>的对应平台运行环境</li>
</ul>
<h1 id="平台环境"><a class="header" href="#平台环境">平台环境</a></h1>
<p>　　以下适用包含 YSLib 程序和其它程序的构建和运行环境。并非每一个程序都需要区分特定平台，一些程序的行为是平台中立的。关于 YSLib 版本库内的及安装 YSLib 部署的脚本的运行环境，另见<a href="Development.zh-CN.html">脚本运行</a>的相关说明。</p>
<h2 id="yslib-程序"><a class="header" href="#yslib-程序">YSLib 程序</a></h2>
<p><strong>注意</strong> 示例程序最大化地使用了 YSLib 的平台模拟特性，支持特定的<a href="Development.zh-CN.html">目标平台</a>在运行时作为<a href="Development.zh-CN.html">宿主平台</a>对另一平台的<a href="Development.zh-CN.html">平台模拟</a>，即运行的原生示例程序和被模拟平台的原生程序保持基本相同的功能效果；但并不保证所有其它 YSLib 程序同样支持。</p>
<p>　　被正式支持的平台模拟列表如下：</p>
<ul>
<li>PC 模拟 DS</li>
</ul>
<p>　　被非正式支持的平台模拟列表如下：</p>
<ul>
<li>Android 模拟 DS</li>
</ul>
<h1 id="硬件资源要求"><a class="header" href="#硬件资源要求">硬件资源要求</a></h1>
<p>　　占用的硬件资源不确定，取决于平台配置以及具体应用程序。</p>
<p><strong>注意</strong> 特定平台可能有额外限制，详见各个平台运行时环境的说明。</p>
<h1 id="文件系统"><a class="header" href="#文件系统">文件系统</a></h1>
<p>　　为最大化可移植性，原则上 YSLib 的程序逻辑<strong>不依赖自身组件具有显式编码的具体文件路径</strong>，因此默认不要求在具体系统约定的周知(well-known) 的文件系统位置（如 <a href="https://docs.microsoft.com/zh-cn/windows/win32/dlls/dynamic-link-library-search-order">Windows DLL 搜索路径</a>中的目录和 [FHS](https://zh.wikipedia.org/zh-cn/%E6%96%87%E4%BB%B
6%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86) 定义的目录）部署。但具体平台配置可以自行限定目录布局作为默认运行时环境，如 <a href="Sysroot.zh-CN.html">Sysroot</a> 。其中外部文件可有默认路径，参见以下相关章节。</p>
<p>　　YSLib 中的库使用的文件系统路径具有以下约束：</p>
<ul>
<li>不依赖兼容 POSIX 的文件系统和路径表示。
<ul>
<li>特别地，不依赖文件系统是否具有文件名的大小写敏感性。</li>
<li><strong>推论</strong> 为保证可移植性，文件系统路径大小写敏感，需要显式区分而加以明确。</li>
<li>这样仍可兼容 FAT 等大小写不敏感的文件系统。</li>
</ul>
</li>
<li>要求支持符合 YSLib 项目规范的开发（参见项目的 <code>doc/ProjectRules.txt</code> ）。</li>
</ul>
<p>　　一般地， YBase 不要求文件系统访问；使用 YFramework 框架的程序，由 YFramework 中的框架初始化等逻辑引入文件系统访问。</p>
<h1 id="二进制依赖项"><a class="header" href="#二进制依赖项">二进制依赖项</a></h1>
<p>　　按以上文件路径约定，构建得到的目标程序没有预设特定的位置限制，可按需转移。</p>
<p>　　运行程序前，应确保程序能找到二进制依赖项：</p>
<ul>
<li>确保<a href="Prerequisition.zh-CN.html">先决条件</a>中的依赖项可以在 <code>PATH</code> 环境变量的目录被找到，或者复制到程序所在的目录。</li>
<li>对于静态链接 YFramework 和 YBase 程序，不需要其它二进制程序文件的部署。</li>
<li>使用 DLL 的程序可能依赖 YFramework.dll 和 YBase.dll ，或者 debug 配置的 YFrameworkd.dll 和 YBased.dll 。这些库已经在 sysroot 的 <code>bin</code> 目录下安装，因此可以直接把 <code>bin</code> 目录加入 <code>PATH</code> 环境变量，而不必复制或移动库文件。</li>
</ul>
<p><strong>说明</strong> 在任意被支持的平台上，YSLib 避免使用导致在特定平台上被特殊处理且无法可靠避免这种行为而确保兼容性一致的外部依赖项名称（若因为外部环境更新导致此类问题，则需在 YSLib 的新版本适当修改后支持）。例如，支持 <a href="http://www.geoffchappell.com/studies/windows/win32/apisetschema/index.htm">API Set Schema</a> 的 Windows 版本加载 DLL 时，<a href="https://stackoverflow.com/a/47530043/2307646"><code>LdrLoadDll</code> 解析以 <code>api-</code> 或 <code>EXT-</code> 起始的文件名进行重定位</a> ，因此设计时确保外部依赖项对应的文件名不以这些前缀起始。</p>
<h1 id="外部文件"><a class="header" href="#外部文件">外部文件</a></h1>
<p>　　外部文件包括：</p>
<ul>
<li>在文件系统中部署的外部二进制依赖项。</li>
<li>配置文件：可被修改以改变程序的运行时行为。</li>
<li>其它数据文件。</li>
</ul>
<p>　　数据文件提供程序运行时所需的必要或可选的信息。配置文件可能作为数据文件使用。</p>
<p>　　外部文件的路径应符合前述关于文件路径的约定。</p>
<h2 id="文件格式"><a class="header" href="#文件格式">文件格式</a></h2>
<p>　　除非另行指定，使用以下文件格式：</p>
<ul>
<li>配置文件是内容为 <a href="Features/NPL.zh-CN.html">NPL</a> 配置的 UTF-8 文本文件，具有 UTF-8 BOM</li>
<li>其它数据文件为二进制文件</li>
</ul>
<h2 id="文件系统布局-1"><a class="header" href="#文件系统布局-1">文件系统布局</a></h2>
<p>　　除配置文件可能指定默认的具体位置（详见下文）外，YFramework 程序的不需依赖特别的文件系统布局。</p>
<p>　　除非另行指定（暂无），YFramework 不创建文件系统目录。</p>
<p>　　<a href="Sysroot.zh-CN.html">Sysroot</a> 提供类 UNIX 系统使用的布局作为可选项。</p>
<h2 id="文件访问约定"><a class="header" href="#文件访问约定">文件访问约定</a></h2>
<p>　　除非另行指定，YFramework 对外部文件的访问适用本节约定。</p>
<p><strong>注意</strong> 除非另行指定，程序访问配置文件的时机是未指定的。</p>
<h3 id="基本要求"><a class="header" href="#基本要求">基本要求</a></h3>
<p>　　应确保外部文件满足以下条件，否则运行时出错，或在另行指定（暂无）的特定情形下不保证行为符合预期：</p>
<ul>
<li>具有适当的（可读和可写）权限以允许程序访问其内容及元数据，或在必要时进行创建。</li>
<li>需要写入的文件所在的位置应该具有足够的空间。</li>
</ul>
<h3 id="文件映射和内存映像"><a class="header" href="#文件映射和内存映像">文件映射和内存映像</a></h3>
<p>　　文件读写使用 YCLib::MemoryMapping ，优先使用内存文件映射。在文件无法访问时，部分文件可能使用内存映像代替。</p>
<p><strong>注意</strong> 除非使用内存映像，应确保外部文件的内容可读；否则，可在之后引发无法恢复的错误；参见当前实现使用的 <a href="Features.zh-CN.html">YCLib::MemoryMapping 的注意事项</a>。</p>
<h3 id="共享文件"><a class="header" href="#共享文件">共享文件</a></h3>
<p>　　宿主平台使用协同锁(advisory lock) 对并发文件内容访问提供有限的共享保护，避免基于 YFramework 程序并发访问外部文件时的竞争。不使用强制锁(mandatory lock) 以利于提升性能。</p>
<p><strong>注意</strong> 除检查文件创建外，不提供相关文件系统元数据并发访问保护。</p>
<p><strong>注意</strong> 因为锁定非强制，宿主不保证其它机制访问文件的程序（如非 YFramework 程序）在这里产生冲突，有可能破坏文件内容。用户应避免对相关文件造成此类访问的破坏性编辑。</p>
<p><strong>注意</strong> 因为访问顺序未指定，不同 YFramework 实例可能修改相同的文件（如配置文件）而导致外部可见的影响。</p>
<p>　　未来可能添加完整的对共享文件内容修改的传递和检查的机制。</p>
<h2 id="配置生成和输入输出"><a class="header" href="#配置生成和输入输出">配置生成和输入输出</a></h2>
<p>　　配置文件可能提供默认内容，在外部文件不存在或读取失败时尝试创建。默认内容一般由框架直接提供。</p>
<ul>
<li>自动生成并保存外部文件时需确保程序可在指定目录下创建文件。
<ul>
<li>具体目录视具体文件而定。</li>
<li>可在运行前部署正确的配置文件以避免自动生成。</li>
</ul>
</li>
<li>若无法满足，生成保存在内存中的临时配置映像之后的修改不会保存到外部文件。
<ul>
<li><strong>注意</strong> 某些版本的 Windows （如 Windows Vista 以后的版本）在特定的目录（如 <code>%PROGRAMFILES%</code> ）中创建文件默认需要管理员权限。</li>
</ul>
</li>
</ul>
<h2 id="公共配置文件"><a class="header" href="#公共配置文件">公共配置文件</a></h2>
<p>　　文件 <code>yconf.txt</code> 为 YFramework 程序的公共<a href="Tutorial/Configuration.zh-CN.html">配置</a>文件，在框架初始化时，先于其它配置文件之前处理。若不存在，提供默认内容。其位置是预先指定的，和平台相关。详见下一章对框架初始化的说明。</p>
<p>　　为避免 YFramework 程序在运行时出错或行为不符合预期，注意确保满足前述访问约定的要求。若无法在程序映像文件所在目录（详见以下关于框架初始化的说明）创建文件，配置不能保存到外部文件。</p>
<p>　　在 Win32 上一个正确的公共配置文件的内容可能是这样的：</p>
<pre><code>YFramework 
(
	DataDirectory &quot;C:\Data\\&quot;
)
(
	FontDirectory &quot;C:\Windows\Font\\&quot;
)
(
	FontFile &quot;C:\Windows\Font\FZYTK.TTF&quot;
)
</code></pre>
<p>　　这里指定的路径分别为数据目录路径、字体文件目录路径和字体文件路径。</p>
<h2 id="数据目录"><a class="header" href="#数据目录">数据目录</a></h2>
<p>　　用于存放 YFramework 程序必要的数据以及运行时的配置。</p>
<p>　　通过 <code>yconf.txt</code> 中项 <code>DataDirectory</code> 的值指定数据目录的路径。</p>
<p>　　自动生成的配置中数据目录的默认路径如下：</p>
<ul>
<li>DS ： <code>/Data</code> 目录</li>
<li>Win32 ：同默认生成配置文件所在的目录</li>
<li>Android ： SD 卡目录（自动检测同上）下的 <code>Data</code> 目录</li>
<li>其它平台：当前工作目录</li>
</ul>
<p>　　当前可用数据文件位于 YSLib 项目的 <code>/Data</code> 下，可自行复制到数据目录。</p>
<h3 id="chrlib-的-gbk-转换例程初始化"><a class="header" href="#chrlib-的-gbk-转换例程初始化">CHRLib 的 GBK 转换例程初始化</a></h3>
<p>　　对使用 CHRLib 提供的 GBK 编码转换的程序，需保证数据目录下存在数据文件 <code>cp113.bin</code> 。</p>
<p>　　对 Win32 平台， CHRLib 初始化 GBK 转换例程读取数据文件失败时，首先尝试使用 NLS 替代：</p>
<ul>
<li>通过读取注册表取得 NLS 文件路径，默认为系统目录下的 <code>C_936.NLS</code></li>
<li><strong>注意</strong> 并非所有 Windows 安装带有指定的 NLS 文件。例如，某些版本的 64 位 Windows 10 可能在 <code>%windir%\system32\C_936.NLS</code> 但不存在 <code>%windir\SysWOW64\C_936.NLS</code> 。由于 64 位 Windows 默认<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa384187.aspx">对系统目录重定向</a>，导致 32 位的 YFramework 初始化找不到注册表指定的默认 NLS 文件。当前不特别处理这种情况，因此 NLS 不可用。</li>
<li>若 Win32 NLS 初始化仍然失败，则 CHRLib 初始化 GBK 转换例程失败。</li>
</ul>
<p>　　对其它平台，数据文件读取失败则 CHRLib 初始化 GBK 转换例程失败。</p>
<p>　　初始化失败后，使用 CHRLib 转换 GBK 编码的程序在调用转换例程时抛出异常，可能导致程序非正常退出。</p>
<h3 id="mime-数据"><a class="header" href="#mime-数据">MIME 数据</a></h3>
<p>　　数据目录下的配置文件 <code>MIMEExtMap.txt</code> 存储 MIME 数据。若不存在，提供默认内容。</p>
<h2 id="字体目录和文件路径"><a class="header" href="#字体目录和文件路径">字体目录和文件路径</a></h2>
<p>　　只要其中之一有效即可（若没有成功指定字体文件路径，则默认字体文件路径不确定）。</p>
<p>　　自动生成的配置中字体文件的默认路径如下：</p>
<ul>
<li>DS ： <code>/Font/FZYTK.ttf</code></li>
<li>Win32 ：系统字体目录下的 <code>SimSun.ttc</code></li>
<li>Android ： <code>/system/fonts/DroidSansFallback.ttf</code></li>
<li>Linux ： <code>./SimSun.ttc</code></li>
</ul>
<p>　　自动生成的配置中字体目录的默认路径如下：</p>
<ul>
<li>DS ： <code>/Font</code> 目录</li>
<li>Android ： <code>/system/fonts</code> 目录</li>
<li>其它平台：同数据目录</li>
</ul>
<h1 id="特定平台运行环境"><a class="header" href="#特定平台运行环境">特定平台运行环境</a></h1>
<h2 id="ds"><a class="header" href="#ds">DS</a></h2>
<p>　　以下说明中， <code>$NDSEmulator</code> 为模拟器 <a href="DeSmuME.en-US.html">DeSmuME</a> 可执行文件的绝对路径， <code>$TargetPath</code> 为 ROM 映像文件（ <code>.nds</code> 文件）的路径， $FAT_Path为 FAT 目录路径（见以下说明）。</p>
<p>　　之前经测试的最小版本为 0.9.6 。建议使用最新版本。</p>
<p>　　运行时，需在运行模拟器的宿主机中准备一个目录作为映射到设备中的虚拟 FAT 目录。宿主的目录在运行中不会被 DeSmuME 修改；宿主目录的文件系统不要求为 FAT 。运行时会加载虚拟目录的内容。</p>
<p><strong>注意</strong> 官方版的 DeSmuME 不支持包含非 ASCII 字符的宿主路径而忽略这些文件。部分修改版可能没有这个限制。</p>
<p><strong>注意</strong> 因为 DS 模拟器和烧录卡需要加载 ROM 映像到 RAM 后才能运行，映像大小会影响可用运行内存，使用 debug 配置构建的 YSTest 示例版本不一定在 DS 上支持所有功能。相关支持限制及变更详见 YSLib 项目文档 <code>doc/Test.txt</code> 。</p>
<p>　　可通过以下方式之一指定 FAT 目录。</p>
<h3 id="slot-1-映射"><a class="header" href="#slot-1-映射">Slot 1 映射</a></h3>
<p>　　Slot 1 （即 NDS ROM 卡槽，硬件介质可以是 NDS 卡带，或烧录卡和存储卡的组合）的模拟从 DeSmuME 0.9.8 版本起支持。</p>
<p>　　运行命令行示例：</p>
<pre><code>&quot;$NDSEmulator&quot; &quot;$TargetPath&quot; --preload-rom --slot1-fat-dir=&quot;$FAT_Path&quot;
</code></pre>
<p>　　其中 <code>--preload-rom</code> 对 0.9.10 和 0.9.11 版本是必须的（以支持自动 <a href="https://wiki.gbatemp.net/wiki/DLDI">DLDI(en-US)</a> 补丁），否则加载失败。这个选项可以在模拟器（Windows 版本）的 GUI 菜单中 <code>Config</code> → <code>ROM Loading</code> 中选择。最新版本的源码会对自制 ROM 自动启用 ROM 预先加载的选项而不用另行配置，可以省略这个选项。</p>
<h3 id="slot-2-映射"><a class="header" href="#slot-2-映射">Slot 2 映射</a></h3>
<p>　　Slot 1 （即 GBA ROM 卡槽，硬件介质可以是 GBA 卡带或其它扩展）的模拟需要配置为使用 <code>GBA Movie Player (Compact Flash)</code> 。</p>
<p>　　运行命令行示例：</p>
<pre><code>&quot;$NDSEmulator&quot; &quot;$TargetPath&quot; --cflash-path=&quot;$FAT_Path&quot;
</code></pre>
<p>　　对 0.9.10 和 0.9.11 版本，需同 Slot 1 映射添加 <code>--preload-rom</code> 或使用菜单设置加载选项，否则同样无法加载（尽管源码中表示 <code>--preload-rom</code> 是适用 Slot 1 而不是 Slot 2 的选项）。</p>
<p>　　这个选项也可以通过 GUI 配置。在 0.9.9 版本前，使用菜单 <code>Emulation</code> → <code>GBA Slot</code> 。自 0.9.9 版本起，使用菜单 <code>Config</code> → <code>Slot 2 (GBA Slot)</code> 。</p>
<p><strong>注意</strong> DeSmuME svn4030 及之后的一些版本（至少包括 0.9.8 ）会在载入 MPCF 映像时错误地忽略 <code>--cflash-path</code> 选项，以 仿真(Emulation) → GBA 插槽(GBA Slot) 菜单中的设置或对应配置文件 <code>desmume.ini</code> 中指定正确的路径。</p>
<p>　　在 <code>desmume.ini</code> 中有效的最小配置：</p>
<pre><code>[GBAslot]
type=1
[GBAslot.CFlash]
fileMode=0
path=H:\NDS\efsroot\
</code></pre>
<p>　　这里 <code>H:\NDS\efsroot</code> 是 <code>$FAT_Path</code> 的一个示例。</p>
<p><strong>注意</strong> 自 Slot1 0.9.10 起，当 Slot 1 设置为 R4 时会覆盖 Slot 2 设置加载 R4 路径（ Dev+ 版本显示自动 DLDI 补丁在 Slot 1 设置为 R4 从 <code>GBA Movie Player (Compact Flash)</code> 改为 <code>R4(DS) - Revolution for DS</code> ），因此需确保<strong>Slot 1 设置不为 R4 ，或正确设置了 Slot 1 R4 的路径</strong>（而改用 Slot 1 映射）。</p>
<h2 id="mingw32"><a class="header" href="#mingw32">MinGW32</a></h2>
<p>　　自 build 431 起，YFramework 使用的 <a href="https://freeimage.sourceforge.io/">FreeImage</a> 修改版集成 <a href="https://zh.wikipedia.org/zh-cn/Libjpeg#libjpeg-turbo">libjepg-turbo</a> ，需要 CPU 支持 <a href="https://zh.wikipedia.org/zh-cn/SSE2">SSE2</a> 指令集扩展。</p>
<p>　　除 2005 年前生产的硬件外绝大多数环境已经满足这个条件。当前几乎所有兼容 IA-32 的市售 CPU 都包含 SSE2 支持。特别地，支持 x86_64 指令集的 CPU 要求支持 SSE2 ，在使用 x86_64 的 64 位 Windows 上运行 32 位 Win32 程序（通过 <a href="https://zh.wikipedia.org/zh-cn/WoW64">WoW64</a> ）也支持 SSE2 。</p>
<h2 id="android"><a class="header" href="#android">Android</a></h2>
<p>　　可使用 <code>adb</code> 命令安装 APK 包，如：</p>
<pre><code>&quot;$ANDROID_SDK/platform-tools/adb&quot; -e install -r &quot;$1&quot;
</code></pre>
<p>　　此处 <code>-e</code> 指定 TCP/IP 设备（通常是模拟器），若使用 USB 设备（通常是物理机器）应移除或使用较新的 <code>adb</code> 的 <code>-d</code> 选项代替； <code>&quot;$1&quot;</code> 指定 APK 文件路径。</p>
<p>　　之后，在 Android 的 GUI 环境下直接运行安装的程序。</p>
<p>　　若因签名变更等原因无法覆盖安装或更新，需要先卸载后再安装。</p>
<p><strong>注意</strong> Android 安装 <code>.apk</code> 包时需要占用额外存储资源。为避免内置存储空间不足导致不直接表现安装失败（需要 <code>logcat</code> 查看）但直至运行时找不到二进制库而导致启动失败，应保留足够的空间，特别是对占用较大的 debug 配置构建的映像。保留空间的大小一般大于 <code>.apk</code> 作为 <code>.zip</code> 解压缩占用的空间。另见<a href="https://code.google.com/p/android/issues/detail?id=21670">此处报告的未确认的类似问题</a>。</p>
<h1 id="框架初始化"><a class="header" href="#框架初始化">框架初始化</a></h1>
<p>　　框架初始化服务于整个框架。</p>
<p>　　初始化的重要策略之一是在程序启动时减少不必要的初始化，以允许实现以下目的：</p>
<ul>
<li>减少可能的外部依赖（如不需要使用文字的程序就不初始化字体缓存，也不需要依赖外部字体文件和字体配置等）。</li>
<li>减少可能的运行时程序资源占用。</li>
<li>保留静态链接时优化去除没有调用的代码以减少二进制可执行文件大小的可能性。</li>
</ul>
<p>　　按当前框架的设计，框架初始化在 DS 平台在程序运行初始阶段完成。其它平台可延迟初始化，按需调用。</p>
<p>　　并非所有 YFramework 中的 API 都要求框架初始化。以下功能隐含自动进行的框架初始化：</p>
<ul>
<li>使用默认字体缓存。</li>
<li>使用 MIME 数据时。</li>
</ul>
<p>　　框架初始化加载配置文件，其中配置文件路径的确定方式参见以下节的说明。成功公共加载配置文件后，框架初始化检查配置文件的内容，并访问框架公共配置。若检查失败，抛出异常。</p>
<p>　　修改 YFramework 模块 Helper::Initialization 重新编译后，可修改默认设置改变初始化行为。以下行为<strong>可能会在未来改变</strong>。</p>
<h2 id="根路径"><a class="header" href="#根路径">根路径</a></h2>
<p>　　**根路径(root path)**是框架初始化时参考的基本路径，由如下方式确定：</p>
<ul>
<li>Win32 和 Linux（除 Android ）：程序映像所在的目录。</li>
<li>Android ：SD 卡目录（自动按顺序检测 <code>/sdcard</code> 、 <code>/mnt/sdcard</code> 或 <code>/storage/sdcard0</code> 之一）。</li>
<li>其它平台：第一次初始化时的当前工作目录。</li>
</ul>
<p>　　确定根路径在框架初始化或要求确定根路径时进行。若定位程序映像，同时会解析符号链接。若定位根路径失败，抛出异常。</p>
<p>　　抛出的异常默认不被框架处理，可使程序退出。用户代码捕获特定异常可改变默认退出行为。</p>
<h2 id="配置路径"><a class="header" href="#配置路径">配置路径</a></h2>
<p>　　公共配置文件 <code>yconf.txt</code> 所在目录的路径前缀（结尾带有路径分隔符）称为框架的<strong>配置路径(configuration path)</strong>，决定和平台相关的配置加载起始位置。配置路径和配置文件相对路径（对 <code>yconf.txt</code> ，即配置文件名）组合得到配置文件路径。</p>
<p>　　配置路径的确定方式和平台相关。</p>
<p>　　任意平台总能确定一个首选的配置路径。</p>
<p>　　除首选的配置路径外，一些平台还支持一个或多个不同的<strong>后备(fallback) 配置路径</strong>。在读写特定的配置文件时，若根路径访问失败，但存在后备配置路径，依序使用这些路径重试直至成功或全部访问失败。这样的配置文件当前包括 <code>yconf.txt</code> 。具体应用可使用初始化 API 以类似的方式加载其它配置文件。</p>
<p>　　以下是具有后备配置路径的平台中确定配置路径的顺序：</p>
<ul>
<li>Linux（除 Android ）：
<ul>
<li>首先使用首选的配置路径。</li>
<li>若环境变量 <code>HOME</code> 非空，则路径 <code>$HOME/.YSLib/</code> 是后备配置路径。</li>
</ul>
</li>
<li>Win32 ：在 Linux 的基础上：若 <code>$HOME</code> 非空，则路径 <code>$HOME/.YSLib/</code> 是后备配置路径。
<ul>
<li>同 Linux 平台的使用顺序（对应使用 Win32 的环境变量和路径语法，即备份路径 <code>%HOME%\.YSLib\</code> ）。</li>
<li>若环境变量 <code>USERPROFILE</code> 非空，则路径 <code>%USERPROFILE%\.YSLib\</code> 是后备配置路径。</li>
</ul>
</li>
</ul>
<p>　　后备配置路径中若子目录 <code>.YSLib</code> 不存在则被创建。若创建失败，配置路径访问失败。</p>
<p>　　对不具有后备路径的平台，首选的配置路径总是根路径。否则，首选的配置路径由以下方式确定：</p>
<ul>
<li>程序映像所在的位置可推断出符合类似 FHS 的文件系统布局（称为局部 FHS 目录布局），则首选的配置路径为程序映像所在的目录的上一级目录的 <code>var</code> 子目录下的 <code>YSLib</code> 子目录。
<ul>
<li>推断文件系统布局为以 POSIX 环境变量语法表示为 <code>$PREFIX/</code>、<code>$PREFIX/$BIN/</code>、<code>$PREFIX/lib/</code> 和 <code>$PREFIX/share/</code> 这些路径前缀都存在且可作为目录访问，其中 <code>$PREFIX</code> 是程序映像所在的目录的上级目录，而 <code>$BIN</code> 是程序映像所在的目录的名称（按 FHS 通常为 <code>bin</code> ，此处不检查）。</li>
<li>这保证创建映像的可执行程序映像的目录中内容不被修改，以符合 FHS 。</li>
</ul>
</li>
<li>否则，首选的配置路径为根路径。
<ul>
<li>确定配置路径要求确定根路径。</li>
</ul>
</li>
</ul>
<p>　　对不具有后备路径的平台不检查文件系统布局，也不要求实现确保程序映像路径的操作，以简化实现。</p>
<p><strong>注意</strong> 若后备配置路径的配置文件可访问，直接使用此配置文件保存配置，不再创建配置文件。若需要恢复在首选配置路径创建配置文件的行为，需确保后备配置路径的配置文件不可访问（例如，移除所有后备配置路径的这些配置文件）。</p>
<h2 id="配置文件加载"><a class="header" href="#配置文件加载">配置文件加载</a></h2>
<p>　　加载配置文件 <code>yconf.txt</code> 时，首先按上述的顺序确定各个配置路径，每确定一个路径时访问其中的配置文件。若全部失败（如找不到可读的文件），则尝试自动生成配置并创建配置文件。创建配置文件的位置和顺序同上述确定配置路径的顺序。若创建配置文件全部失败，则放弃创建配置文件，直接使用生成的配置。</p>
<p>　　不存在配置文件时，配置不能通过 Helper::Initialization 的 API 持久化保存，尝试保存配置会失败。</p>
<h2 id="其它初始化"><a class="header" href="#其它初始化">其它初始化</a></h2>
<p>　　成功后，框架进一步处理公共配置文件以外的其它初始化；详见以上具体配置文件的相关章节。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="版本库结构和文件说明"><a class="header" href="#版本库结构和文件说明">版本库结构和文件说明</a></h1>
<p>　　版本库依赖支持子目录的层次文件系统。以下只包括版本库根目录下的顶级子目录和少数特定的二级子目录及其中的部分文件的说明。</p>
<ul>
<li><code>.git</code> Git 目录（可通过 hg-git 同步）</li>
<li><code>.hg</code> Mercurial 目录</li>
<li><code>3rdparty</code> 第三方依赖项</li>
<li><code>Data</code> 最终用户环境中部署的数据目录</li>
<li><code>Tools</code> 开发使用的（辅助）工具
<ul>
<li><code>Tools/SHBuild</code> SHBuild 构建工具</li>
<li><code>Tools/Scripts</code> 用于构建和建立 SHBuild 环境的工具脚本</li>
</ul>
</li>
<li><code>YBase</code> 顶级子项目 YBase</li>
<li><code>YFramework</code> 顶级子项目 YFramework</li>
<li><code>YSTest</code> 测试用示例项目目录（项目名为 YSTest ，以实际内容命名的项目名为 YReader ）
<ul>
<li><code>YSTest/Android</code> 示例项目 YReader 的 Android 平台项目（未完成正式支持）</li>
<li><code>YSTest/DS_ARM7</code> 示例项目 YReader 的 ARM7 项目（仅用于 DS 平台，用于生成 ARM7 ELF 二进制映像）</li>
<li><code>YSTest/DS_ARM9</code> 示例项目 YReader 的 ARM9 项目（包括 DS 平台 ARM9 部分，于生成 ARM9 ELF 二进制映像；源代码和其它平台共享）</li>
<li><code>YSTest/DS</code> 示例项目 YReader 的 DS 平台可执行文件项目（仅用于 DS 平台，用于生成 NDS 文件）</li>
<li><code>YSTest/MinGW32</code> 示例项目 YReader 的 MinGW32 平台可执行文件项目（仅用于 MinGW32 平台，用于生成 EXE 文件）</li>
</ul>
</li>
<li><code>build</code> 默认构建目录（可选构建时生成）</li>
<li><code>doc</code> 开发文档</li>
<li><code>doc/vsd</code> 架构示意 Visio 文档</li>
<li><code>test</code> 测试代码目录</li>
<li><code>.gitignore</code> Git 忽略文件</li>
<li><code>.hgeol</code> Mercurial EOL 插件配置文件</li>
<li><code>.hgignore</code> Mercurial 忽略文件</li>
<li><code>.hgtags</code> Mercurial 标签文件</li>
<li><code>CC BY-SA 3.0 legalcode.txt</code> 文档许可证： Creative Commons Legal Code Attribution-ShareAlike 3.0 Unported</li>
<li><code>Doxyfile</code> Doxygen 配置文件</li>
<li><code>FTL.TXT</code> 许可证： The FreeType Project LICENSE</li>
<li><code>gpl-2.0.txt</code> 许可证： GNU GENERAL PUBLIC LICENSE Version 2</li>
<li><code>gpl-3.0.txt</code> 许可证： GNU GENERAL PUBLIC LICENSE Version 3</li>
<li><code>LICENSE.txt</code> 整体许可证</li>
<li><code>LICENSE_HISTORY.txt</code> 整体许可证：历史版本</li>
<li><code>license-fi.txt</code> 许可证： FreeImage Public License - Version 1.0</li>
<li><code>Readme.zh-CN.txt</code> 自述文件</li>
<li><code>YSTest.sln</code> Visual Studio 解决方案文件</li>
<li><code>YSTest.workspace</code> Code::Blocks 工作空间文件</li>
</ul>
<p><strong>注释</strong> 以上布局中的顶级子目录可作为顶级子项目或作为项目模块在开文档中引用，其名称起始使用大写字母，以目录的名称原文作为模块名称。其它构建时生成以外的目录也可被引用，但不使用目录名称作为模块名称。</p>
<p>　　顶级子项目或其中的平台子目录中，可包含以下目录：</p>
<ul>
<li><code>include</code> 可被安装部署的公开头文件</li>
<li><code>source</code> 被构建的源文件</li>
</ul>
<p>　　以下目录会被默认支持的构建配置生成：</p>
<ul>
<li><code>YDE/</code> 下以 <code>.</code> 起始的特定宿主平台为子目录名的构建目录是 <a href="Sysroot.zh-CN.html">stage 2 环境</a>下的 <a href="YDE.zh-CN.html">YDE 项目</a>的生成文件目录</li>
<li><code>build/</code> 下以特定的宿主平台为子目录名的默认构建目录，默认配置构建时会创建不同的平台目录，其中的子目录可包括：
<ul>
<li><code>.stage1</code> <a href="Tools/SHBuild.zh-CN.html">stage 1 环境</a> 构建和生成目录</li>
<li><code>.test</code> <a href="Test.zh-CN.html">测试项目</a>构建和生成文件目录</li>
<li>以 <code>.</code> 起始的其它 <a href="Sysroot.zh-CN.html">Sysroot</a> 构建目录，用于创建 <a href="Sysroot.zh-CN.html">stage 2 环境</a>的 YSLib 库以及基于 stage 2 环境的 Sysroot 方式的 YSTest 的构建</li>
<li>其它非 Sysroot 的 YSLib 和 YSTest 项目生成文件目录</li>
</ul>
</li>
<li><code>sysroot</code> 使用<a href="Tools/Scripts.zh-CN.html">脚本</a>构建的默认 <a href="Sysroot.zh-CN.html">Sysroot （含 stage 2 环境）</a> 生成目录</li>
</ul>
<h2 id="文件系统布局约定"><a class="header" href="#文件系统布局约定">文件系统布局约定</a></h2>
<p>　　版本库遵循一定的文件系统布局规则。这些规则在这里和一些开发文档中被描述。没有通过这些描述被明确的布局应被视为实现细节，其改变可不被文档描述。</p>
<p>　　不论是否是实现细节，特定的路径都可被版本库的忽略文件路径涵盖。</p>
<p><strong>注意</strong> 版本库中的文件系统布局和 Sysroot 约定的部署实例的布局相互独立，不适用此处的规则，且布局可能存在差异。</p>
<p>　　虽然没有在项目初始指定，版本库中部分目录和文件结构及使用方式与现有的一些约定类似或兼容：</p>
<ul>
<li>部分文件系统布局和使用符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs">cxx-pflR1</a> 。
<ul>
<li>顶级子目录 <code>build</code> 符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.build"><code>build/</code></a> 指定的目的和作用。</li>
<li>顶级子项目或其中的平台子目录中的子目录 <code>include</code> 和 <code>source</code> 对应符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.include"><code>include/</code></a> 和 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.src"><code>src/</code></a> 指定的目的和作用，其使用符合<a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#src.header-placement">分离放置布局</a>。</li>
<li>顶级子目录 <code>test</code> 符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.tests"><code>tests/</code></a> 指定的主要目的和作用，但不限于非单元测试。</li>
<li>顶级子目录 <code>Data</code> 符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.data"><code>data/</code></a> 指定的主要目的和作用，但强调最终用户环境，且不适用生成文档的源代码。</li>
<li>顶级子目录 <code>doc</code> 符合 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.docs"><code>docs/</code></a> 指定的目的和作用。</li>
<li>因为不使用版本管理的子模块机制，不使用 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#tld.libs"><code>libs/</code></a> 和 <a href="https://api.csswg.org/bikeshed/?force=1&amp;url=https://raw.githubusercontent.com/vector-of-bool/pitchfork/develop/data/spec.bs#submod.extras"><code>extras/</code></a> ，符合指定的规则。</li>
</ul>
</li>
<li>部分文件系统布局和使用符合 <a href="http://jdebp.uk/FGA/slashpackage.html">Jonathan de Boyne Pollard 约定的 slashpackage 内部结构</a>。
<ul>
<li>顶级子项目或其中的平台子目录中的子目录 <code>source</code> 符合指定的目的和作用。</li>
<li>默认构建目录是名为 <code>build</code> 的一级子目录，可能不存在，符合指定的目的和作用。</li>
<li>除构建目录外的文件预期不应被构建过程修改，默认与之兼容。</li>
<li>不要求 <code>source</code> 链接到 <code>build</code> ，与之不兼容。</li>
<li>构建 Sysroot 可能直接链接文件到输出目录，与之不兼容。</li>
<li>仅要求部署过程正常时的部署目标目录的完整性，不要求更新是原子的或可事务性回滚，与之不兼容。</li>
</ul>
</li>
</ul>
<h1 id="项目结构和特性"><a class="header" href="#项目结构和特性">项目结构和特性</a></h1>
<p>　　项目内容以模块为单位组织。关于模块的概念及其表示形式，详见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。因为特性众多，在此只列出较上层的基本结构，不总是精确到具体模块。</p>
<h2 id="ybase-yframework-基础库"><a class="header" href="#ybase-yframework-基础库">YBase ：YFramework 基础库</a></h2>
<p>　　详见 <code>doc/YBase.txt</code> 。</p>
<p>　　替代标准库的特性另见 <a href="StandardUsing.en-US.html">StandardUsing(en-US)</a> 。</p>
<ul>
<li>YStandardEx ： YFramework 标准扩展库</li>
<li>LibDefect ：标准库修正</li>
<li>YTest ：YFramework 基础测试库</li>
</ul>
<h2 id="yframework--yframework-框架库"><a class="header" href="#yframework--yframework-框架库">YFramework ： YFramework 框架库</a></h2>
<p>　　详见 <code>doc/YFramework.txt</code> 。</p>
<ul>
<li>CHRLib ：字符编码处理库
<ul>
<li>编码标识</li>
<li>目前支持 UTF-8/UCS-2/UCS-4/GBK ，可扩充</li>
<li>默认编码 UTF-8</li>
</ul>
</li>
<li>YCLib ： YSLib 基础库
<ul>
<li>Platform ：平台定义</li>
<li>平台相关 API 封装</li>
<li>平台相关硬件抽象</li>
<li>Win32 专用接口（略）</li>
</ul>
</li>
<li>YSLib ：YShell 库（主体，暂定）
<ul>
<li>Adaptor ：适配器层
<ul>
<li>Configuration ： 库配置</li>
<li>YReference ：智能指针封装（基于 Loki 实现【已移除】/使用 ISO C++11 标准库）</li>
<li>简单的内存调试设施</li>
<li>附加容器（可选 Loki 的 yasli 容器，默认不启用）</li>
<li>Anti-Grain Geometry 2.4 移植（修复了一处在 2.5 仍然存在的 bug ），因在 DS 上效率太低所以默认不启用【已移除】</li>
<li>Font ：字体管理（基于 FreeType 2 实现）</li>
<li>Image ：平台中立的图像输入和输出（基于 FreeImage 实现）</li>
</ul>
</li>
<li>Core ： YSLib 核心</li>
<li>Service ：YSLib 服务</li>
<li>UI ： YSLib 用户界面</li>
<li><a href="Features/NPL.zh-CN.html">NPL</a></li>
<li>Helper ：助手库：初始化、宿主支持等</li>
</ul>
</li>
</ul>
<h2 id="yreader-示例"><a class="header" href="#yreader-示例">YReader ：示例</a></h2>
<ul>
<li>ShlExplorer ：文件列表浏览</li>
<li>控件测试：按钮点击、窗口拖曳、 FPS （伪）显示等</li>
<li>Shell 切换</li>
<li>ShlReader ：文本浏览
<ul>
<li>读取并显示文本文件的内容</li>
<li>随机跳转</li>
<li>书签设置、读取和保存</li>
</ul>
</li>
<li>HexBrowser：十六进制浏览</li>
</ul>
<h1 id="构建-1"><a class="header" href="#构建-1">构建</a></h1>
<p>　　支持使用多种途径进行<a href="Build.zh-CN.html">构建</a>。支持<a href="Terminology.zh-CN.html">多平台构建</a>。另见 <a href="Sysroot.zh-CN.html">Sysroot</a> 和以下的“轮子列表”章节。</p>
<p>　　<a href="Terminology.zh-CN.html">依赖</a>以模块为单位组织。接口（如公开 API 头文件）不出现循环依赖。</p>
<p>　　可通过修改代码以裁剪、定制库实现内部的模块构建（如为了减小编译后的二进制映像体积），但应注意在 YSLib 项目文档中列出的显式依赖规则。未来可能会支持构建时的定制配置工具。</p>
<h1 id="abi"><a class="header" href="#abi">ABI</a></h1>
<p>　　目前除 YBase::LibDefect 和具体实现兼容外，不保证 ABI 稳定。</p>
<p>　　具体策略详见 YSLib 项目文档 <code>doc/</code> 下各个库的文档。</p>
<h1 id="api"><a class="header" href="#api">API</a></h1>
<p>　　对各 API 的说明和注意事项详见 YSLib 项目中的源代码，可<a href="BuildDocumentation.zh-CN.html">构建文档</a>。</p>
<h2 id="平台相关-api-注意事项"><a class="header" href="#平台相关-api-注意事项">平台相关 API 注意事项</a></h2>
<ul>
<li>YCLib::MemoryMapping 中 <code>platform::MappedFile</code> 的实现需确保文件内容可访问，否则取指针后，可在之后的操作中引发不可恢复的错误。
<ul>
<li>在硬件支持 MMU 的平台上，使用内存映射实现。
<ul>
<li>读取错误产生不可恢复的错误。
<ul>
<li>因为无法确保确定的调用位置，框架不做任何处理。
<ul>
<li>除非用户程序进行处理，这将导致程序崩溃。</li>
</ul>
</li>
<li>Win32 平台：失败时<a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa366801(v=vs.85).aspx">引发 <code>EXCEPTION_IN_PAGE_ERROR</code> 结构化异常</a>。</li>
<li>POSIX 宿主平台：失败时<a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/signal.h.html">引发 <code>SIGSEGV</code> 信号</a>。</li>
</ul>
</li>
<li>因此不支持不可靠的远程文件。</li>
</ul>
</li>
<li>其它平台（当前包括 DS ），使用文件流模拟。
<ul>
<li>若 <code>platform::MappedFile</code> 初始化失败会直接抛出异常。除非用户代码忽略，可避免引发后续失败（引起未定义行为）。</li>
</ul>
</li>
<li>当前仅支持只读映射。若修改取得的映射指针指向的存储，在使用内存映射实现的平台上也可引发上述行为类似的不可恢复的错误。</li>
</ul>
</li>
</ul>
<h2 id="标准库使用"><a class="header" href="#标准库使用">标准库使用</a></h2>
<p>　　YSLib 对 C++ 标准库<a href="Prerequisitions.zh-CN.html">具有明确的要求</a>，且仅使用<a href="StandardUsing.en-US.html">明确的标准库特性</a>。</p>
<p>　　和 <a href="http://llvm.org/docs/CodingStandards.html#c-standard-library">LLVM 编码标准对 C++ 标准库的使用(en-US)</a>类似， YSLib 强调尽可能依赖标准库的公开接口。仅在具有充足理由时不依赖标准库而提供和使用自定义 API （基本上总是因为设计和实现的质量不足够满足需求和以上要求的原因）。</p>
<p>　　对标准库特性使用的具体限制见<a href="Development.zh-CN.html">开发说明</a>及 YSLib 项目文档 <code>doc/LanguageConvention.txt</code> 等规则。</p>
<p>　　相关的其它原理另见下节。</p>
<h2 id="轮子列表"><a class="header" href="#轮子列表">轮子列表</a></h2>
<p>　　本项目发明了一些轮子。为了符合<a href="Home.zh-CN.html">不重复发明轮子的项目内容规则</a>，在发现更好的替代时，其中一些会被逐渐移除。</p>
<p>　　但是，其余一些轮子，因为特定的原因，不视为对此规则的违反而得以保留，包括一些在当前实现中使用的和较新版本语言规范中提供的兼容的特性。</p>
<p>　　主要包括以下内容：</p>
<ul>
<li>YBase.YStandardEx
<ul>
<li>为了兼容性需要，一些标准库接口的实现会被保留。但当合适的版本可用时，通过条件包含选择别名声明，优先使用标准库提供的版本。</li>
<li>Meta 、 TypeTraits 以及其它元编程设施
<ul>
<li>其它元编程设施因为没有被标准化、风格和可用性问题，提供了 C++14 兼容的元函数和类似 <a href="https://github.com/ericniebler/range-v3">Range-v3</a> 及 <a href="http://boostorg.github.io/hana/">Boost.Hana</a> 的实现使用的接口。</li>
</ul>
</li>
<li>IntegerSequence
<ul>
<li>主要接口兼容 C++14 的 <code>std::integer_sequence</code> ，但早于提案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3493.html">N3493</a> 。</li>
<li>提供了更丰富的底层接口如 <code>make_peano_sequence</code> 。</li>
</ul>
</li>
<li>Operators
<ul>
<li>接口类似 <a href="http://www.boost.org/doc/libs/1_60_0/libs/utility/operators.htm">Boost.Operators</a> ，但有以下不同：
<ul>
<li>要求 C++11 支持。</li>
<li>使用代码量较少的紧凑的实现，不支持对不符合标准的编译器的多数实现细节上的变通。</li>
<li>不支持链式模板参数（这是为了兼容不支持偏特化的编译器的变通）。</li>
<li>提供对 <code>noexcept</code> 的支持。</li>
</ul>
</li>
<li>接口类似 <a href="https://github.com/taocpp/operators">The Art of C++ / Operators</a>（原 df.operators ）。</li>
<li>除以上列出外，还有以下差异和特性：
<ul>
<li>操作符模板使用别名而不保证是类。</li>
<li>支持可选的操作符参数，默认推断 <code>constexpr</code> 。</li>
<li>重载操作符实现为模板友元以支持推断 <code>constexpr</code> 同时允许在派生类中提供显式覆盖实现。</li>
</ul>
</li>
<li>此外，提供部分不在上述类似接口中提供的成员操作符重载。</li>
</ul>
</li>
<li>Any
<ul>
<li>接口类似 <a href="http://www.boost.org/doc/libs/1_60_0/doc/html/any.html">Boost.Any</a> ，包括内部非公开的 <code>unsafe_any_cast</code> 作为扩展；此外 <code>any</code> 成员也有一些扩展。</li>
<li>除了 <code>any</code> 外还提供底层实现相关的扩展，用于实现 AnyIterator ，<strong>这无法被简单取代</strong>。</li>
<li>Any 的<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1939.html">提案</a>最早于 2006 年基于 Boost.Any 提出，未考虑 C++11 特性。此实现早于标准库提案的<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3390.html">后续修订版本</a>实现。</li>
<li>现在和 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4081.html">WG21 N4081</a> 的 <code>std::experimental::any</code> 同步，但仍然保持扩展。</li>
<li>使用了小对象优化实现，这也符合后来<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3804.html">更新的提案</a>中的建议。
<ul>
<li>空间性能<strong>明显比 Boost.Any 高效</strong>。</li>
<li><strong>libstdc++ 的 <code>std::experimental::any</code> 也使用了类似的实现，但<a href="https://gcc.gnu.org/ml/libstdc++/2014-06/msg00093.html">比此处的实现晚 1 年以上</a></strong>。早期 libstdc++ 实现还存在<a href="https://gcc.gnu.org/ml/libstdc++/2015-05/msg00052.html">遗漏考虑对齐</a>和<a href="https://gcc.gnu.org/ml/libstdc++/2015-07/msg00091.html">自赋值</a>的缺陷，这些问题在此处从不存在。</li>
</ul>
</li>
<li>提供 <code>emplace</code> 相关扩展，可避免构造 <code>any</code> 对象或赋值时冗余初始化目标类型的值。</li>
<li>提供 <code>unchecked_*</code> 成员和 <code>unchecked_any_cast</code> 模板扩展，要求参数非空，因为省略检查比对应的检查空值的接口（ <code>unchecked_any_cast</code> 对应 <code>unsafe_any_cast</code> ）更高效。</li>
</ul>
</li>
<li>Optional
<ul>
<li>ISO C++17 的 <code>&lt;optional&gt;</code> 在 ISO C++11 下的移植和扩展。</li>
<li>支持几乎所有特性，除 <code>operator-&gt;</code> 因为核心语言特性限制不总是支持结果是常量表达式。</li>
<li>支持少量扩展接口： <code>make_optional_inplace</code> 和 <code>ref_opt</code> 。</li>
</ul>
</li>
<li>Map
<ul>
<li>ISO C++17 的 <code>&lt;map&gt;</code> 在 ISO C++11 下的移植和扩展。</li>
<li>支持不完整键类型，不依赖特定扩展（如 libstdc++ 的 <code>std::map</code>）。</li>
</ul>
</li>
<li>Invoke
<ul>
<li>提供 <code>std::invoke</code> 的替代。 </li>
</ul>
</li>
<li>Apply
<ul>
<li>提供 <code>std::apply</code> 的替代。</li>
</ul>
</li>
<li>Function
<ul>
<li>提供 <code>std::function</code> 的替代。 </li>
</ul>
</li>
<li>Rational
<ul>
<li>类模板 <code>fixed_point</code> 和提案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0037r1.html">P0037R1</a> 中的有相似之处，但模板参数类型更明确，且提出较早。</li>
</ul>
</li>
<li>一些非直接的（以同名接口一一替代的）标准库替代接口
<ul>
<li>减少了标准库对应的限制，提升了易用性。</li>
<li>不一定和标准库的对应功能的 API 同名。</li>
<li><code>lref</code> 部分取代 <a href="http://www.eel.is/c++draft/refwrap"><code>std::reference_wrapper</code></a> （涉及 <code>std::bind</code> 的使用无法取代）。
<ul>
<li>和 <code>std::reference_wrapper</code> 不同而和 <a href="http://www.boost.org/doc/libs/1_60_0/libs/core/doc/html/boost/reference_wrapper.html"><code>boost::reference_wrapper</code></a> 类似，
不<a href="http://www.eel.is/c++draft/refwrap#3">提供 weak result type</a> ，不<a href="http://www.eel.is/c++draft/requirements#res.on.functions-2">要求模板参数为完整类型</a>。</li>
<li>保证满足 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4277.html">WG21 N4277</a> 提出的 TrivialCopyable 要求。</li>
<li>提供配套的 <code>ref</code> 和 <code>cref</code> 外还有和 <a href="http://www.boost.org/doc/libs/1_60_0/libs/core/doc/html/core/ref.html">Boost 接口</a>一致但支持 <code>lref</code> 的 <code>is_reference_wrapper</code> 和 <code>unwrap_reference</code> 元函数。</li>
</ul>
</li>
<li><code>mapped_set</code> 用 <code>ystdex::map</code> 模拟 <code>std::set</code> 。
<ul>
<li>不要求键类型保持 <code>const</code> 。这意味着（和 C++98/03 类似）只要不影响比较操作的等价关系，元素可以使用无 <code>mutable</code> 修饰的成员而保持 <code>const</code> 类型检查。</li>
<li>使用 ADL <code>set_value_move</code> 优化插入等操作，允许转移值。</li>
<li>在 C++11 下即支持<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3657.htm">泛型查询</a>接口。</li>
<li>因为使用 <code>ystdex::map</code>  ，支持不完整键类型。</li>
</ul>
</li>
</ul>
</li>
<li>一些通常典型地用于标准库内部实现的接口
<ul>
<li>实际上也适于被用户代码使用。</li>
<li><code>has_mem_value</code> 、 <code>has_nested_allocator</code> 和 <code>enable_if_transparent_t</code> 等检查类型要求的元编程设施。</li>
<li><code>search_map</code> 提供关联容器查找，适合实现 <code>map</code> 等的 <code>operator[]</code> 和 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4279.html"><code>try_emplace</code></a> 等设施。
<ul>
<li>支持迭代器提示参数。使用比当前(2016-03) 最新开发版本的 libstdc++ 更紧凑的实现（而 <a href="http://stackoverflow.com/questions/34382073/re-implementing-stdmaptry-emplace-from-c17-in-c11">libc++ 对 <code>map::try_emplace</code>，用 <code>lower_bound</code> 近似</a>，也包括对用户代码提供提示参数的情况（直接忽略提示），后者尽管满足复杂度要求但特定情况下容易更低效。</li>
</ul>
</li>
</ul>
</li>
<li>其它可在 C++11 下使用的标准库扩展
<ul>
<li>ISO/IEC TS 19568:2015 C++ Extensions for Library Fundamentals （最终草案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4480.html">N4480</a>） 以及 ISO/IEC DTS 19568 C++ Extensions for Library Fundamentals, Version 2 （草案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4564.pdf">N4564</a>）的一些接口在 C++11 下的实现和 YStandardEx 扩展。
<ul>
<li>提供元函数 <code>and_</code> 、 <code>or_</code> 和 <code>not_</code> 。
<ul>
<li>是早于提案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0013r0.html">P0013R0</a> 的实现。</li>
<li>比原始提案及 libstdc++ 中使用的实现更简单。</li>
<li>以别名模板的形式支持 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0013r1.html">P0013R1</a> 。</li>
</ul>
</li>
<li>函数模板 <code>apply</code> 利用更加强大（投影到不同参数位置进行调用）的 <code>call_projection</code> 实现，而非直接基于 <code>integer_sequence</code> 。</li>
<li>类模板 <code>optional</code> 。</li>
<li>类 <code>any</code> 大体兼容这里的接口规范。</li>
<li>类模板 <code>string_view</code> 。</li>
<li>类模板 <code>observer_ptr</code> 。</li>
<li>部分比较操作使用 Operators 实现，保证一般预期的可用性同时简化实现及改善编译性能，但不完全和规范一致。</li>
</ul>
</li>
<li>函数模板 <code>destroy</code> 是早于提案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0040r0.html">P0040R0</a> 的实现。
<ul>
<li>使用不同的参数形式被重命名为 <code>destruct</code> 等模板。</li>
<li>实现和 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0040r0.html">P0040R2</a> 兼容的相关接口。</li>
</ul>
</li>
<li>类型特征 <code>unwrap_reference</code> 早于提案 <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0318r0.pdf">P0318R0</a> 提供，功能近似。</li>
</ul>
</li>
</ul>
</li>
<li>YFramework
<ul>
<li>一些接口存在第三方的高效实现，但不足以同时在性能和功能上取代现有接口和实现。（以下性能测试因为实际环境基准问题当前仅用于内部测试，未正式支持。）</li>
<li>CHRLib
<ul>
<li>提供的 UTF-8 解码实现之一在主要支持平台（即 MinGW32 ）上实测为当前已知最快的实现。
<ul>
<li>第二快的是 <a href="https://github.com/miloyip/rapidjson">RapidJSON</a> 。虽然同样使用状态转移查找表，它使用刻意避免分支判断的实现机制，使用的表较大而对缓存可能不友好，导致在典型的实现中反而不一定更快。此外实测表明，使用 GCC 的 <code>__attribute__((flatten))</code> 即能明显影响这里的性能，程度和算法优化相比无法忽视。</li>
<li>其它朴素实现都明显落后于<a href="http://bjoern.hoehrmann.de/utf-8/decoder/dfa/">使用状态查找表</a>算法的性能。</li>
</ul>
</li>
</ul>
</li>
<li>YSLib.Core.YEvent
<ul>
<li>在不进行体系结构和 ABI 相关优化的限制前提下， <code>YSLib::GEvent</code> 的性能超过<a href="https://github.com/FrankHB/nano-signal-slot">这里</a>的除了 <code>jl_signal</code> 所有实现。而后者基于特定实现的 ABI 进行了较为复杂的优化。（待定：整合<a href="https://github.com/NoAvailableAlias/signal-slot-benchmarks">新的测试</a>。）</li>
<li>除了没有 Boost.Signal2 的线程安全和定制返回类型策略的接口外，所有功能都不弱于上述测试中的例子。</li>
<li>此外，基于 <code>ystdex::make_expanded</code> 提供允许省略未使用的参数这个实用特性，是以上测试用例都不具备的。事实上，尚没有已知的 C++ 库中提供类似的特性。其它语言可能提供类似的特性简化 GUI 开发，如 <a href="https://msdn.microsoft.com/en-us/library/windows/apps/mt204783.aspx">{x:Bind}</a> ，但实现原理上，其运行时性能不可能超过此处的方式（静态语言在翻译时确定参数列表）。</li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="项目依赖性"><a class="header" href="#项目依赖性">项目依赖性</a></h1>
<p>　　示例项目 YSTest 在 DS 上依赖 YSTest/DS_ARM7 和 YSTest/DS_ARM9 两个项目。
YSTest/DS_ARM9 依赖于 YFramework ；在其它平台直接依赖 YFramework 。</p>
<p>　　YFramework 依赖 YBase 。</p>
<p>　　除了 MinGW 外使用 Make 构建。需要添加静态库时，把相应的 .a 文件加入相应的 lib 目录下，否则需要手动修改对应的 <code>Makefile</code> 。</p>
<p>　　MinGW 使用 Code::Block 或 <a href="Sysroot.zh-CN.html">Sysroot</a> 构建。</p>
<h2 id="生成路径"><a class="header" href="#生成路径">生成路径</a></h2>
<p>　　默认构建的根目录位于版本库下的 <code>build</code> 目录。</p>
<p><strong>注意</strong> 本节以下内容不适用于 <a href="Sysroot.zh-CN.html">Sysroot</a> 。</p>
<p>　　设 <code>$(Platform)</code> 是平台名称，<code>$(Configuration)</code> 是生成配置名称，则各个项目生成的文件和中间文件都在项目的 <code>build/$(Platform)/$(Configuration)</code> 子目录下。 修改 <code>Makefile</code> 的配置可以分离生成文件和中间文件的输出路径。</p>
<p>　　默认生成配置名称可以是 <code>debug</code> 或 <code>release</code>（注意此项的大小写会在 <code>Makefile</code> 中表现出区别）。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概述-1"><a class="header" href="#概述-1">概述</a></h1>
<p>　　NPL 是 YSLib 提供的语言集合，它在语言规范层次上被设计为可扩展的。</p>
<p>　　通过派生(derive) 现有的语言（ <strong>NPL 方言</strong>），避免完全重新设计新的语言，来满足需要一些新语言的场合下的需求。被派生的语言是 NPL 的<strong>抽象语言实现</strong>。翻译或执行 NPL 或 NPL 抽象语言实现的程序是 NPL （方言）的<strong>具体语言实现</strong>。具有具体语言实现的方言仍可以派生新的语言作为<a href="https://en.wikipedia.org/wiki/Domain-specific_language">领域特定语言</a>。</p>
<p>　　派生领域特定语言的一个其它的例子是 <a href="https://en.wikipedia.org/wiki/XML">XML</a> 。</p>
<h1 id="语法"><a class="header" href="#语法">语法</a></h1>
<p>　　NPL 的语法基于形式文法上可递归构造的<strong>表达式</strong>，其中的子表达式在此称为<strong>项</strong>。</p>
<p>　　非正式地， NPL 使用类似 <a href="https://en.wikipedia.org/wiki/S-expression">S 表达式</a>的基本语法，但不使用二元有序对（和终止符号）而直接支持列表；即表达式直接以是否为括号作为边界，分为<strong>列表表达式</strong>和<strong>非列表表达式</strong>。</p>
<p>　　正式语法中，项可以是列表或非列表项的<strong>混合表达式</strong>(<code>composite-expression</code>) 规约列表项中的一部分代替有序对的地位，以要求任意项可被无歧义地进行从左到右的语法分析。</p>
<p>　　NPL 只要求小括号作为列表表达式的边界。其它替代的括号由派生实现约定。对于适用于多个 NPL 实现的可移植代码，避免使用其它语言中习惯作为代替括号边界的字符表示替代的括号以外的含义，特别地， ISO C++ 文法 <code>balanced-token</code> 中的边界字符 <code>()[]{}</code> 。</p>
<p>　　NPL 对标识符的限制较为宽松。 ISO C 和 ISO C++ 的所有标识符都是 NPL 标识符。但派生实现可加以限制。</p>
<p>　　NPL 不提供专用的注释语法。以特定形式的项（如表示字符串的字面量）替代注释是预期的惯用法(idiom) 。这不妨碍派生语言可能添加预处理器扩展特性。</p>
<h1 id="语义"><a class="header" href="#语义">语义</a></h1>
<p>　　NPL 提供了一些通用的概念但不构成语义规则。语义规则由派生实现约定。</p>
<h1 id="实现"><a class="header" href="#实现">实现</a></h1>
<p>　　在 YFramework/NPL 提供一些参考具体实现。当前 YFramework 主要使用抽象实现 NPLA 的具体<em>派生(derived)</em> 的实现 NPLA1 ，在这个基础上用于不同的目的，如<a href="Features/../Tutorial/Configuration.zh-CN.html">程序配置</a>、<a href="Features/../Tutorial/GUI.zh-CN.html">动态加载的 GUI</a> 等。</p>
<p>　　这些实现基于模块 YSLib::Core::ValueNode 提供的数据结构，可以方便地修改和组合语法和语义节点的内容。</p>
<p>　　NPLA 提供了比大多数现有的程序设计语言更强大的一般抽象。这集中体现在：</p>
<ul>
<li>和 NPL 的原始设计一致，不提供也不要求区分实现的阶段(phase) 。</li>
<li>支持一等环境(first-class environment) 不修改现有语言的求值算法即可实现共享类似语法的新语言。</li>
<li>允许以一般手段表达求值和未求值表达式的差异。</li>
</ul>
<p>　　这意味着 NPLA 是本质上动态的语言，但和一般语言不同，用户可以很大程度上动态地替换现有语言实现，包括在运行时替换一个解释实现为一个或多个优化编译器。这也意味着语言设计上既不需要区分解释实现和编译实现（本质上不对立），也不需要区分动态和静态（因为随时能从基础语言上构造出静态子集）。</p>
<p>　　这样的特性设计在绝大多数语言中不存在并且几乎无法支持。作者已知唯一的例外是 <a href="http://web.cs.wpi.edu/%7Ejshutt/kernel.html">Kernel</a> ，在这些特性上有极大的相似，尽管实际上基本特性是<strong>独立设计的</strong>，并且在基本设计哲学上有极大不同（ NPL 和 <a href="ftp://ftp.cs.wpi.edu/pub/techreports/pdf/05-07.pdf">RnRK</a> 中明确的 guidelines有很大不同且基本不兼容）。不过，考察设计的完整性， NPL 的派生语言也从中借鉴了一些重要的附加特性：</p>
<ul>
<li><a href="http://lambda-the-ultimate.org/node/4093"><code>$vau</code></a> 、 <em>合并子(combiner)</em> /<em>应用子(applicative)</em> /<em>操作子(operative)</em> 等术语。</li>
<li>在绑定构造中支持模式匹配的形式参数树(parameter tree) 。</li>
<li>一些以合并子形式提供的操作。
<ul>
<li>一般的作为接口提供的合并子在 NPL 中仍称为函数；合并子是作为表达式的函数的特定的求值结果。（在 Scheme 中，合并子中的应用子对应过程(procedure) 。）</li>
<li>相似的操作主要体现在名称和语义上。因为一些基本设计的差异，不保证完全兼容。</li>
<li>相似操作的实现不尽相同，但其中不通过宿主语言的直接的实现（称为<em>派生(derivation)</em> ）有一部分几乎完全相同。</li>
<li>使用 <code>$</code> 作为一些标识符（如 <code>$lambda</code> ）的前缀是独立设计的巧合；现在含义已和 Kernel 一致，表示 <em>special form</em> 。</li>
</ul>
</li>
</ul>
<p>　　一些值得注意的和类似语言的主要设计差异（原理详见开发文档）：</p>
<ul>
<li>NPL 和 Kernel 类似，强调一等对象(first-class object) ，但含义有所不同。此处的“对象”和 ISO C 及 ISO C++ 中的定义类似，具有比 Kernel 更严格的含义。
<ul>
<li>和 Kernel 合并子及 Scheme 过程类似， NPLA 默认使用按值调用(call by value) ；但与之不同，不隐式对实际参数别名(aliasing) ，不共享对象。</li>
</ul>
</li>
<li>NPLA 和派生实现的语法和整体的求值类似 Scheme 和 Kernel 大多数基于 S 表达式的 <a href="https://en.wikipedia.org/wiki/Lisp_%28programming_language%29">Lisp</a> 方言，但有一些显著的区别。
<ul>
<li>NPLA1 明确区分约定包括列表项的求值规则。和传统习惯不同， NPLA1 中括号明确不需要表示应用的含义，这可以减少一些场合（如命令行）需要输入的过多的连续括号。</li>
<li>和 RnRS 定义的 Scheme 以及 Kernel 一致，不支持某些 Lisp 方言的方括号 <code>[]</code> 替代圆括号 <code>()</code> 的语法。</li>
<li>不提供注释语法。</li>
<li>语言实现中内置预处理处理中缀 <code>;</code> 和 <code>,</code> ，作为前缀合并子 <code>$sequence</code> 和 <code>list</code> 的语法糖。两者的含义和 Kernel 中的相同（类似 Scheme 的 <code>begin</code> 和 <code>list</code> ）。</li>
</ul>
</li>
<li>和 Kernel 相似而和 Scheme 不同，使用操作子及一等环境和 <code>eval</code> 代替 Scheme 的<a href="https://en.wikipedia.org/wiki/Hygienic_macro">卫生宏(hygienic macro)(en-US)</a> 及宏展开的作用。
<ul>
<li>和 Kernel 类似，鼓励使用直接求值风格而不是引用(quote) 。</li>
<li>不过 NPLA 也提供了 <code>$quote</code> 的派生而非如 Kernel 一样完全避免。</li>
</ul>
</li>
<li>和 Kernel 不同， NPL 明确支持资源抽象，<strong>不保证支持</strong>循环引用，而 NPLA 明确<strong>不支持</strong>循环引用。</li>
<li>NPLA 明确支持基于 C++ 实现的对象模型和互操作，且明确<strong>不要求</strong>支持全局 <a href="https://zh.wikipedia.org/zh-cn/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6_%28%E8%A8%88%E7%AE%97%E6%A9%9F%E7%A7%91%E5%AD%B8%29">GC</a> 。
<ul>
<li>从在互操作的目的出发，和 C++ 具有相似性和相容性。
<ul>
<li>支持基于 C++ 抽象机语义的更一般的副作用（除原生 <code>volatile</code> 外）和一等状态(first-class states)  。</li>
<li>和 ISO C++ 类似，在语言规格中保留特定的未定义行为，而不要求实现避免。</li>
<li>暂时不直接支持多线程环境，但可以在不同线程上同时使用不同的实现的实例。</li>
<li>函数默认使用不隐式别名的按值调用和返回传递复制或转移值，和 C++ 对应上下文的复制初始化(copy initialization) 语义一致。（不过求值为操作子的 NPL 函数在 C++ 没有直接的对应。）</li>
</ul>
</li>
<li>在<a href="http://www.wpi.edu/Pubs/ETD/Available/etd-090110-124904/unrestricted/jshutt.pdf">vau 演算的论文</a> 中，提及不支持全局 GC 有较大的 admistrative cost 但没有详细讨论和语言特性的联系。</li>
</ul>
</li>
<li>即便不支持全局 GC ，当前实现仍然<strong>明确支持</strong> PTC(proper tail call) 。
<ul>
<li>PTC 基于语言规则而不是实现行为定义，详见 <a href="https://www.researchgate.net/profile/William_Clinger/publication/2728133_Proper_Tail_Recursion_and_Space_Efficiency/links/02e7e53624927461c8000000/Proper-Tail-Recursion-and-Space-Efficiency.pdf">proper tail recursion</a> ，这里和 Kernel 提供的保证含义一致。</li>
<li>没有在其它语言发现这种不支持全局 GC 和支持类似 C++ 副作用的情形下的 PTC 支持的先例。</li>
</ul>
</li>
<li>和 Kernel 不同， NPLA 不完全强制对象类型的封装(encapsulation) ；且基于支持互操作的考虑，支持开放的类型系统，而不要求覆盖所有值（即要求对象类型分区(partition) ）。</li>
<li>对机器数（不论是整数还是浮点数）的操作被剥离了，当前不被支持，需要用户代码添加个别操作。</li>
<li>NPLA 的规约(reduction) 框架和 vau 演算的操作语义几乎完全一致，不过实际上（因为先前语言设计上的不确定）显著地保留了更多的可扩展和可修改性。</li>
</ul>
<h2 id="当前实现"><a class="header" href="#当前实现">当前实现</a></h2>
<p>　　当前派生实现的 NPLA1 由 YFramework 提供 API 。其中包括 REPL (read-eval-print loop) 的解释实现。外部文件的形式的 NPLA1 脚本可被基于这些 API 实现的 <a href="Features/SHBuild.zh-CN.html">stage 1 SHBuild</a> 调用并用于 YFramework 的构建。</p>
<p>　　由 YFramework 对外部编码的假设，NPLA1 实现加载的文件流的剩余内容的编码视为 UTF-8 ；同时支持 CR+LF 或 LF 为换行符。</p>
<h1 id="进一步阅读-1"><a class="header" href="#进一步阅读-1">进一步阅读</a></h1>
<p>　　语言特性设计的需求参见<a href="https://github.com/FrankHB/pl-docs/blob/master/en-US/calling-for-language-features.md">这里(en-US)</a> 。</p>
<p>　　关于 NPL 语言及当前使用的实现的规格，参照 YSLib 项目文档 <code>doc/NPL.txt</code> 。</p>
<h2 id="kernel-实现"><a class="header" href="#kernel-实现">Kernel 实现</a></h2>
<p>　　NPL 文法是 S-expression 语法和 Kernel 兼容语义的简化，某些 NPLA1 程序可以原封不动地作为 Kernel 程序运行。因为参考文献可用性以及相似性几乎独一无二，建议深入使用前参照 Kernel 相关的文档并实际使用，以和 NPL 进行比较（当前 NPL 开发文档也引用包括 RnRK 在内的一些规格说明）。现有较完整可用的一个 Kernel 实现是 <a href="http://klisp.org/">Klisp</a> 。</p>
<h2 id="计划支持特性"><a class="header" href="#计划支持特性">计划支持特性</a></h2>
<p>　　在 Kernel 中已存在但当前 NPLA1 未支持，而计划在未来添加的特性：</p>
<ul>
<li>一等续延(first-class continuation)
<ul>
<li><a href="http://okmij.org/ftp/continuations/against-callcc.html">基于一些显著的理论和实现可用性的理由</a>，需要考察有界续延(delimited continuation) （如 <code>shift</code>/<code>reset</code> ）而不是传统的 <code>call/cc</code> 的支持。</li>
<li>和 Klisp 的异步实现方式类似但不同， NPLA1 核心已使用一种同 <a href="http://www.ccs.neu.edu/home/dvanhorn/pubs/vanhorn-might-icfp10.pdf">CESK-style 的抽象机</a> 的异步风格独立重新实现（<a href="http://www.brics.dk/RS/05/16/BRICS-RS-05-16.pdf">原理参考</a>），并兼容混合原有实现。并且状态支持已提供基本操作，但仍待更多测试。</li>
</ul>
</li>
<li><a href="http://klisp.org/docs/Promises.html#Promises">Promises</a>
<ul>
<li>虽然 NPLA1 之前有部分原生实现，但计划改用基于封装类型派生。</li>
</ul>
</li>
<li><a href="http://klisp.org/docs/Keyed-Variables.html#Keyed-Variables">Keyed Variables</a>
<ul>
<li>有效的 keyed dynamic varabile 实现可能依赖一等续延数据结构。</li>
<li>有效的 keyed static varabile 实现需要调整环境数据结构。</li>
</ul>
</li>
<li><a href="http://klisp.org/docs/Ports.html#Ports">Ports</a>
<ul>
<li>需要调查内存映射文件和其它系统支持。</li>
</ul>
</li>
<li><a href="http://klisp.org/docs/Libraries.html#Libraries">Libraries</a>
<ul>
<li>可能需要提供多种不同的接口。</li>
</ul>
</li>
</ul>
<p>　　已提供但考虑可能优化实现的特性：</p>
<ul>
<li><a href="http://klisp.org/docs/Encapsulations.html#Encapsulations">封装类型</a>
<ul>
<li>需要调查互操作相关的特性和持久化支持。</li>
</ul>
</li>
</ul>
<p>　　计划考虑提供其它设计替代选项的 Klisp 特性：</p>
<ul>
<li><a href="http://klisp.org/docs/Characters.html#Characters">Characters</a>
<ul>
<li>满足互操作要求的前提下，使用设计更合理的类型替代。</li>
</ul>
</li>
<li><a href="http://klisp.org/docs/Vectors.html#Vectors">Vectors</a>
<ul>
<li>使用更完善的用户自定义派生类型替代。</li>
</ul>
</li>
</ul>
<p>　　其它 NPL 计划实现特性：</p>
<ul>
<li>模块化框架</li>
<li>支持类型系统的子语言
<ul>
<li>类似 <a href="https://docs.racket-lang.org/ts-reference/index.html">Typed Racket</a> 。</li>
</ul>
</li>
<li>测试框架</li>
<li>基于 <code>$let-safe</code> 的静态环境操作替换优化</li>
<li>用于编译的中间代码格式和二进制代码生成框架
<ul>
<li>类似 <a href="https://www.scheme.com/">Chez Scheme</a> 对 <a href="http://nanopass.org/">Nanopass</a> 的使用。</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Metacompilation">元编译(metacompilation)(en-US)</a> </li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="概述-2"><a class="header" href="#概述-2">概述</a></h1>
<p>　　Sysroot 是具有特定逻辑布局根目录兼容的目录，一般在文件系统中实现。</p>
<p>　　Sysroot 主要用于本机程序的开发环境构建和部署，以后也可能用于交叉构建(cross building) 。</p>
<p>　　在利用 Sysroot 开发之前有必要了解开发注意事项：</p>
<ul>
<li><a href="Build.zh-CN.html">构建</a></li>
<li><a href="Prerequisitions.zh-CN.html">先决条件</a></li>
</ul>
<p>　　Sysroot 使用的文件系统路径满足<a href="Run.zh-CN.html">运行</a>环境对外部文件的路径的约定。</p>
<p>　　当前 Sysroot 仅支持 MinGW 和 Linux 环境。</p>
<p>　　关于本文档讨论以外的脚本的其它行为，参见<a href="Tools/Scripts.zh-CN.html">脚本</a>的有关说明。</p>
<h1 id="布局"><a class="header" href="#布局">布局</a></h1>
<p>　　在满足前述要求的前提下， Sysroot 部署实例使用的文件系统布局原则上和<a href="https://zh.wikipedia.org/zh-cn/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E6%A0%87%E5%87%86">一般类 UNIX 系统使用的布局</a>同构，具体子目录布局如下：</p>
<ul>
<li><code>.shbuild</code> ：使用 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 构建时的临时目录（可以在部署后手动删除）。</li>
<li><a href="Tools/Scripts.zh-CN.html">系统前缀字符串</a>指定的作为<a href="Tools/Scripts.zh-CN.html">安装路径前缀</a>的最后一个路径组件的目录文件名（如 <code>usr</code> ）：被部署的用户空间目录，其中的内容使用 <a href="http://www.tldp.org/LDP/Linux-Filesystem-Hierarchy/html/usr.html">Linux</a> 等现代 UNIX 变体类似的约定：
<ul>
<li><code>bin</code> ：二进制文件。</li>
<li><code>include</code> ：头文件。</li>
<li><code>lib</code> ：库文件。</li>
<li><code>share</code> ：共享的数据文件。
<ul>
<li><code>share/NPLA1</code> ：NPLA1 脚本部署位置。</li>
</ul>
</li>
<li><code>var</code> ：程序运行时可修改的数据。</li>
</ul>
</li>
</ul>
<p>　　其中，除 <code>var</code> 外，这些目录中的内容在安装或维护部署情形外通常应保持只读。</p>
<p>　　对 MinGW32 和 MinGW64 平台，系统前缀字符串指定的路径和 MSYS2 构建系统的 <code>/etc/msystem</code> 脚本指定的 <code>MSYSTEM_PREFIX</code> 的值一致，对应 <a href="https://github.com/msys2/msys2/wiki/MSYS2-introduction#file-system">MSYS2 支持的两个 <code>mingw</code> 子系统路径</a>。</p>
<p>　　上述 <code>bin</code> 目录可以加入环境变量 <code>PATH</code> 中以便其中的程序被命令行执行。当前若使用 <a href="YDE.zh-CN.html">YDE</a> 构建脚本，这是必要的。</p>
<p>　　依赖 Sysroot 的程序可预期以上布局符合约定，且功能允许时可访问这些子目录或其它文件，而不被要求能在不符合预期的环境下正常运行。这些程序可能根据上述子目录中的内容判断需要的不同操作。安装或者维护 Sysroot 布局的程序提供附加的保证，不依赖全部或者部分路径符合预期，而在必要时可创建文件使布局满足这些预期。具体的操作可在不同程序的功能描述中明确。</p>
<p>　　没有在此约定的 Sysroot 中的子目录和其它文件路径为未来的版本保留：这些路径不被当前版本使用，但可能被之后的版本使用。依赖 Sysroot 的程序和用户应注意避免占用保留路径引起变更版本时引起的兼容问题。</p>
<p><strong>注意</strong> Sysroot 实例的布局<em>不是</em><a href="Features.zh-CN.html">版本库文件布局</a>。但是，关于部署文件时有关被部署的文件的要求，参见版本库文件布局中的相关约定。</p>
<h1 id="安装脚本"><a class="header" href="#安装脚本">安装脚本</a></h1>
<p>　　YSLib 项目提供生成可打包的 Sysroot 的安装脚本，位于 <code>Tools/Scripts/install-sysroot.sh</code> 。输出的 Sysroot 的默认位置为版本库根目录下的 <code>sysroot</code> 目录。安装 Sysroot 时构建和部署多个项目，详见以下各节。</p>
<h2 id="基本安装"><a class="header" href="#基本安装">基本安装</a></h2>
<p>　　使用 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 构建和部署运行环境，包括库和工具。</p>
<p><strong>建议阅读以下关于选项以及<a href="Tools/Scripts.zh-CN.html">脚本</a>说明后再运行命令。</strong></p>
<p>　　可进入 <code>bash</code> 运行以下 GNU bash 脚本：</p>
<pre><code>Tools/install-sysroot.sh
</code></pre>
<p>　　直接在默认输出位置构建和部署基础环境。</p>
<p><strong>注意</strong> 当前构建脚本默认使用 <code>uname</code> 判断构建系统的体系结构。对 MSYS2 等环境，结果为基本系统的体系结构而不一定和作为构建目标的宿主系统相同。如使用 64 位基本系统构建 32 位目标，需确保环境变量 <code>MSYSTEM</code> 设置为 <code>MINGW32</code>（在启动 MSYS2 提供的 shell 入口时应正确设置，但直接调用 <code>bash</code> 并不保证），或使用以下命令代替：</p>
<pre><code>SHBuild_Host_Arch=i686 Tools/install-sysroot.sh
</code></pre>
<p>　　此处<a href="Prerequisitions.zh-CN.html">自动环境检测</a>的机制同 shell 脚本 <code>Tools/Scripts/SHBuild-common.sh</code> 中的函数 <code>SHBuild_PrepareBuild</code> ，详见<a href="Tools/Scripts.zh-CN.html">脚本</a>的说明。</p>
<h2 id="构建和部署"><a class="header" href="#构建和部署">构建和部署</a></h2>
<p>　　构建过程包括 <code>SHBuild</code> 可用的<a href="Tools/SHBuild.zh-CN.html">多阶段构建</a>。</p>
<p>　　构建时在 Sysroot 输出目录种保存中间输出。当前不清理这些中间输出。</p>
<p>　　通过脚本选项，在 <a href="Tools/SHBuild.zh-CN.html">stage 2 SHBuild</a> 需要的库时，也可生成其它的 YSLib 库（静态库和调试版本的库）。</p>
<p>　　YSLib 库和依赖的外部的第三方库的二进制文件和对应的头文件在构建后被部署到 Sysroot ，并在之后用于构建 stage 2 SHBuild 。</p>
<p>　　完成构建 stage 2 SHBuild 后，脚本部署 stage 2 SHBuild 和脚本（参见以下节）到 Sysroot 。</p>
<h3 id="脚本部署"><a class="header" href="#脚本部署">脚本部署</a></h3>
<p>　　在 stage 2 SHBuild 构建后，部署 SHBuild 同时安装（复制）版本库中的以下位置的 脚本文件（无视路径前缀）到 Sysroot 的对应安装路径：</p>
<ul>
<li>NPLA1 脚本安装到 <code>share/NPLA1</code> ：
<ul>
<li><code>Tools/Script/SHBuild-BuildApp.txt</code></li>
<li><code>Tools/Script/SHBuild-YSLib-common.txt</code></li>
</ul>
</li>
<li>Shell 脚本安装到 <code>bin</code> ：
<ul>
<li><code>Tools/Script/SHBuild-common.sh</code></li>
<li><code>Tools/Script/SHBuild-common-options.sh</code></li>
<li><code>Tools/Script/SHBuild-common-toolchain.sh</code></li>
<li><code>Tools/Script/SHBuild-BuildApp.sh</code></li>
<li><code>Tools/Script/SHBuild-BuildPkg.sh</code></li>
</ul>
</li>
</ul>
<h3 id="可选工具"><a class="header" href="#可选工具">可选工具</a></h3>
<p>　　通过脚本选项，在部署 stage 2 SHBuild 后，也可安装 <code>Tools</code> 下的其它工具：</p>
<ul>
<li><a href="Tools/RevisionPatcher.zh-CN.html">RevisionPatcher</a></li>
<li><a href="Tools/SXML2XML.zh-CN.html">SXML2XML</a></li>
<li><a href="Tools/ProjectGenerator.zh-CN.html">ProjectGenerator</a></li>
</ul>
<h2 id="构建时的警告"><a class="header" href="#构建时的警告">构建时的警告</a></h2>
<p>　　除引导 <a href="Tools/SHBuild.zh-CN.html">stage 1 SHBuild</a> 最后的链接器警告外，因为升级或更换编译器和/或选项，导致预编译头文件（ <code>.gch</code> 文件）不能被识别的警告也可被安全忽略。</p>
<ul>
<li>此时编译器应能自动忽略这些文件。</li>
<li>若需要预编译头文件在后续重复构建时的性能提升，可以清理这些文件，一般在对应项目生成的相同目录；可手动搜索构建目录中所有 <code>.gch</code> 文件并删除后再运行构建脚本，默认包括以下位置：
<ul>
<li>项目中的 <code>/Tools/SHBuild</code> 用于 stage 1 SHBuild 构建。</li>
<li>项目中的 <code>/build</code> 构建目录。</li>
<li>安装 stage 1 SHBuild 后默认在部署的 <code>/sysroot/.shbuild</code> 继续构建目录。</li>
</ul>
</li>
<li>若不需要使用预编译头文件，可参考<a href="Tools/Scripts.zh-CN.html">脚本</a>说明设置变量。</li>
<li>若仅需避免产生警告，确保编译器命令行使用恰当选项，如添加 <code>-Wno-invalid-pch</code> 。</li>
</ul>
<p><strong>注意</strong> 预编译头文件不保证对不同的 Windows 系统版本兼容，参见<a href="Prerequisitions.zh-CN.html">先决条件</a>中 PC(Win32) 平台关于操作系统版本的说明。</p>
<h1 id="sysroot-开发指令"><a class="header" href="#sysroot-开发指令">Sysroot 开发指令</a></h1>
<p>　　使用 Sysroot 开发，首先需安装 Sysroot 环境，参见以上安装脚本的说明。</p>
<h2 id="应用程序构建脚本"><a class="header" href="#应用程序构建脚本">应用程序构建脚本</a></h2>
<p>　　YSLib 应用程序可使用 SHBuild 构建。为简化构建流程，使用应用程序构建脚本包装对 SHBuild 的调用。</p>
<p>　　应用程序构建脚本不限制实现使用的语言，但在版本库中提供的脚本应符合<a href="Tools/Scripts.zh-CN.html">公共的约定</a>；此外，具体脚本可能需要指定适当的 <code>PATH</code> 以确保外部的工具可被调用。</p>
<p>　　典型地，应用程序构建脚本是 shell 脚本，可依赖 Sysroot 环境已构建的 Sysroot 环境，并调用 NPLA1 脚本。</p>
<p>　　<a href="ProjectDependencies.zh-CN.html">YSTest</a> 支持使用脚本 <code>/YSTest/SHBuild-YSTest.sh</code> 构建，可作为例子参考。和其它在安装脚本部署的 stage 2 应用不同，当前默认情况下使用版本库中的 <code>build</code> 目录下的平台目录存放生成的文件（中间文件和生成的可执行程序示例）。</p>
<h2 id="部署"><a class="header" href="#部署">部署</a></h2>
<p>　　除安装脚本外，当前不提供直接部署程序。</p>
<p>　　参照<a href="Run.zh-CN.html">运行</a>确定二进制依赖项位置和调整运行时的配置。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概述-3"><a class="header" href="#概述-3">概述</a></h1>
<p>　　YDE 是 YSLib Desktop Environment 的简称，预期作为一个基于 YFramework 的桌面环境。</p>
<p>　　当前是一个 YSLib 的顶级子项目，构建需要 <a href="Sysroot.zh-CN.html">Sysroot</a> 支持。</p>
<p>　　YDE 包含一系列的<em>包(package)</em> 在单独的目录中作为次级子项目。</p>
<h1 id="构建-2"><a class="header" href="#构建-2">构建</a></h1>
<p>　　当前只提供 <code>build-all.sh</code> 使用 <a href="Tools/Scripts.zh-CN.html">SHBuild-BuildApp.txt</a> 构建所有包。</p>
<h2 id="准备-5"><a class="header" href="#准备-5">准备</a></h2>
<ul>
<li>参见<a href="Development.zh-CN.html">开发说明</a></li>
<li>参见 <a href="Sysroot.zh-CN.html">Sysroot</a> 和<a href="GettingStarted.zh-CN.html">入门</a> 的说明配置环境，确保 Sysroot 部署的 <code>usr/bin</code> 目录在 <code>PATH</code> 中</li>
<li>运行 <code>build-all.sh</code> ，可以提供参数</li>
</ul>
<p>　　构建的结果参见 <code>SHBuild-BuildApp.txt</code> 的文档。</p>
<h1 id="包列表"><a class="header" href="#包列表">包列表</a></h1>
<ul>
<li>ImageBrowser 图像浏览工具</li>
<li>Clock 模拟时钟</li>
</ul>
<h1 id="运行-1"><a class="header" href="#运行-1">运行</a></h1>
<p>　　参见<a href="Run.zh-CN.html">运行</a>了解所有基于 YFramework 的程序的说明。</p>
<p><strong>使用配置 <code>yconf.txt</code> ，详见<a href="Run.zh-CN.html">关于运行的说明</a>。</strong></p>
<h2 id="imagebrowser"><a class="header" href="#imagebrowser">ImageBrowser</a></h2>
<p>　　运行程序会打开命令行第一个参数作为路径的文件。支持从资源管理器拖拽到程序。</p>
<p>　　支持 YFramework 支持的图像格式：</p>
<ul>
<li>BMP</li>
<li>GIF</li>
<li>PNG</li>
<li>非渐进 JPEG</li>
</ul>
<p>　　支持滚轮缩放。</p>
<p>　　单击右上角退出按钮退出程序。</p>
<p>　　右键单击界面其它部分弹出上下文菜单。有以下菜单项：</p>
<ul>
<li>退出：关闭窗口，退出程序。</li>
<li>查看原始大小：当显示的图像不是原始大小时，缩放图像到原始大小。</li>
<li>翻转：旋转 180° 。</li>
<li>顺时针旋转：顺时针旋转 90° 。</li>
<li>逆时针旋转：逆时针旋转 90° 。</li>
<li>复制：复制当前显示的（可能经过缩放的）图像内容到剪贴板。</li>
</ul>
<p>　　旋转时保持图像中心位置不变。</p>
<p>　　中键单击界面其它部分查看原始大小。</p>
<p>　　支持键盘快捷键：</p>
<ul>
<li><code>Ctrl+C</code> 复制</li>
</ul>
<h2 id="clock"><a class="header" href="#clock">Clock</a></h2>
<p>　　右键单击界面退出程序。</p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="概要-2"><a class="header" href="#概要-2">概要</a></h1>
<p>　　本文档记录发布工程(release engineering) 相关的规则、历史记录和相关计划。</p>
<p>　　发布策略控制版本更新。</p>
<p>　　关于版本(revison) 的详细规则参见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。</p>
<h1 id="分支branching"><a class="header" href="#分支branching">分支(Branching)</a></h1>
<p>　　一个项目可有多个分支(branch) ，包括至少一个保持工作进行的活动(active) 分支。</p>
<p>　　发布时使用活动分支，以项目版本库的分支为准。</p>
<p>　　当前只有主分支(master branch) 。</p>
<h1 id="标识identification"><a class="header" href="#标识identification">标识(Identification)</a></h1>
<p>　　阶段(phase) 标识连续的版本，描述一个分支在一个时期内版本的发布状态。</p>
<p>　　当前位于 Alpha 非正式发布阶段。</p>
<h2 id="迭代阶段iteration-phase"><a class="header" href="#迭代阶段iteration-phase">迭代阶段(Iteration phase)</a></h2>
<p>　　迭代阶段是工程意义上的版本标识，适用于所有在开发、测试和维护生命周期中的分支，包括仅包含开发和测试版本的场合。</p>
<p>　　PreAlpha 阶段不对 API（应用程序编程接口）稳定性进行任何保证。</p>
<p>　　Alpha 阶段尽量保证公开 API 的非向后兼容的修改最小化，但仍然不保证兼容。</p>
<p>　　Beta 阶段保证主要项目的 API 向后兼容性。非兼容的改动不再在当前迭代周期内引入，否则视为缺陷。</p>
<p>　　Beta 阶段开始提供面向非开发者的部署方案。</p>
<p>　　允许在每个迭代周期中按以上顺序补充新的阶段。</p>
<p>　　关于项目内的提交版本(revision) ，详见项目文档 <code>doc/Dependencies.txt</code> 的约定。</p>
<h2 id="发布阶段release-phase"><a class="header" href="#发布阶段release-phase">发布阶段(Release phase)</a></h2>
<p>　　发布阶段使用的版本标识是被用户用于区分产品特性的标识。</p>
<p>　　正式标记形式为以 <code>V</code> 起始，跟随符合<a href="http://semver.org/lang/zh-CN/">语义化版本</a>规范<strong>语法</strong>的版本号。</p>
<p>　　版本号同时符合语义化版本规范的<strong>语义</strong>：在语言实现保持兼容的前提下，相同主版本(major version) 的发布应保持公开的命令行调用接口、API 和 ABI 向后兼容。主版本变化可引入不和先前迭代周期中保证兼容的改动。</p>
<p>　　由公开的<a href="Home.zh-CN.html">兼容性约定</a>，除非另行指定，作为公开的命令行接口的工具在相邻的次版本(minor version) 之间向后兼容。一般地，若工具实现的公开功能被继续支持，命令行工具不在提供向后兼容功能的替代工具前被移除。</p>
<p><strong>注意</strong> 非标记为发布版本的开发版本不需要保证以上要求。</p>
<p>　　不兼容未来计划的改动的特性可标记为弃用(deprecated) 以表示可能在之后不继续支持。</p>
<h3 id="非正式版"><a class="header" href="#非正式版">非正式版</a></h3>
<p>　　非正式版的版本号小于 1.0.0 ，不保证任何 ABI（应用程序二进制接口）兼容性。</p>
<p>　　所有非正式版共享一组迭代阶段。</p>
<h3 id="正式版"><a class="header" href="#正式版">正式版</a></h3>
<p>　　正式版的初始版本号为 1.0.0 。</p>
<p>　　正式版提供版本检查的 API 。</p>
<p>　　正式版对应的开发和测试版本使用以上除 PreAlpha 以外的阶段，具有上述相同的要求。</p>
<h1 id="支持策略"><a class="header" href="#支持策略">支持策略</a></h1>
<p>　　支持策略基于发布规则。</p>
<p>　　当前仅对最新的非正式版及版本库活动开发分支上的最新提交版本(tip) 提供公开支持。</p>
<p>　　正式版适用的规则另行具体指定。</p>
<h1 id="持续集成continuous-integration"><a class="header" href="#持续集成continuous-integration">持续集成(Continuous integration)</a></h1>
<h2 id="构建-3"><a class="header" href="#构建-3">构建</a></h2>
<p>　　提供有限的构建自动化(build automation) 支持。</p>
<p>　　关于使用的构建工具，参见<a href="Prerequisitions.zh-CN.html">先决条件</a>，并参见<a href="Build.zh-CN.html">构建</a>过程。</p>
<p>　　在宿主环境下使用项目内自行开发的工具支持，参见 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 和 <a href="Sysroot.zh-CN.html">Sysroot</a> 。</p>
<h1 id="里程碑和路线图"><a class="header" href="#里程碑和路线图">里程碑和路线图</a></h1>
<p>　　本节略述发布版本的参照目标，包括重要的特性实现。</p>
<p>　　关于包含较详细特性变更说明的发布版本的发布注记(release note) ，参见版本库中的文档 <code>doc/Dependencies.txt</code> ；关于提交版本的详细变更记录(change log) ，参见项目文档 <code>doc/ChangeLog.*.txt</code> 。</p>
<h2 id="已实现的重要特性"><a class="header" href="#已实现的重要特性">已实现的重要特性</a></h2>
<h3 id="prealpha"><a class="header" href="#prealpha">PreAlpha</a></h3>
<p>　　PreAlpha 阶段实现平台中立的基础设施和 GUI 。每个发布版本包含重要的新增特性。</p>
<ul>
<li><strong>PreAlpha 1</strong> 实现可在 DS 和 DeSmuME 运行的 GUI 程序。</li>
<li><strong>PreAlpha 2</strong> 完善 GUI 部件并提供框架。</li>
<li><strong>PreAlpha 3</strong> 支持 MinGW32 移植和动态库：平台中立设计的验证实现。</li>
<li><strong>PreAlpha 4</strong> 支持基于 <a href="Features/NPL.zh-CN.html">NPL</a> 的配置设置、构建工具 <a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 和运行时加载的 GUI 。</li>
<li><strong>PreAlpha 5</strong> 支持桌面程序特性：界面风格、动画及分离构建等。</li>
</ul>
<h3 id="alpha"><a class="header" href="#alpha">Alpha</a></h3>
<p>　　Alpha 阶段仍包含若干重要特性改进，但发布版本不再以添加单一特性为重点，而侧重提升环境的整体可用性。</p>
<ul>
<li><strong>V0.6</strong> 完善项目结构并提升宿主环境下的开发可用性支持。
<ul>
<li>添加整体测试。</li>
<li>添加桌面环境 YDE 。
<ul>
<li>当前主要用于示例。</li>
</ul>
</li>
<li>添加和完善若干专用于支持开发的工具。
<ul>
<li>添加 <a href="Tools/ProjectGenerator.zh-CN.html">ProjectGenerator</a> ，支持生成 Code::Blocks 项目。</li>
<li>支持宿主环境下的 SHBuild 自举 <a href="Sysroot.zh-CN.html">Sysroot</a> 部署。</li>
</ul>
</li>
</ul>
</li>
<li><strong>V0.7</strong> 完善各个平台的实现行为和互操作接口。
<ul>
<li>替换 DS 的文件系统实现。</li>
<li>支持宿主环境下的 YSLib 多个映像实例共存。
<ul>
<li>每个映像实例包括动态库和配置文件等<a href="Run.zh-CN.html">运行时支持环境</a>。</li>
<li>映像实例可以是 Sysroot ，也可以手动部署。</li>
<li>不要求映像实例具有相同的版本。</li>
<li>当前对环境变量透明；必要时，仍需手动指定 <code>PATH</code> 。</li>
<li>当前全面支持仅限 MinGW32 ：配置位置不再依赖当前工作目录。</li>
</ul>
</li>
<li>按独立的语言解释实现添加 NPL 接口。</li>
</ul>
</li>
<li><strong>V0.8</strong> 完善内部互操作性和部署。
<ul>
<li>改进运行时对象操作 API 。</li>
<li>扩充 NPLA/NPLA1 。
<ul>
<li>设计和实现新的求值规则。</li>
<li>提供较完整的 REPL 支持。</li>
</ul>
</li>
<li>在 SHBuild 中使用 NPLA1 代替系统默认的 shell 环境，用于实现部分 Sysroot 部署。</li>
</ul>
</li>
<li><strong>V0.9</strong> 增强 NPL 和部署环境。
<ul>
<li>继续完善 NPL 接口并提升实现性能。
<ul>
<li>默认使用异步调用实现，避免嵌套调用过深时的未定义行为，并支持 PTC 。</li>
<li>节点和环境等数据结构支持分配器。</li>
<li>显著优化分析器和求值的性能。</li>
<li>添加 NPLA1 源代码信息支持，并增强错误信息。</li>
<li>添加更多的标准库操作。</li>
</ul>
</li>
<li>增强配置管理。
<ul>
<li>支持后备路径。</li>
<li>支持检测类 FHS 的文件系统布局。</li>
</ul>
</li>
<li>Sysroot 安装构建脚本。</li>
</ul>
</li>
</ul>
<h2 id="重点计划目标"><a class="header" href="#重点计划目标">重点计划目标</a></h2>
<ul>
<li><strong>V0.10</strong> 计划进一步增强 NPL 和构建环境。
<ul>
<li>继续完善 NPL 接口并提升实现性能。</li>
<li>支持多个运行时实例交互。</li>
<li>基于 Sysroot 的多平台自动化部署方案。</li>
</ul>
</li>
</ul>
<h1 id="待定事项todos"><a class="header" href="#待定事项todos">待定事项(TODOs)</a></h1>
<p>　　版本发布的待定事项参照上述目标。</p>
<p>　　<a href="Home.zh-CN.html">贡献到问题跟踪系统</a>的内容可能包含特性请求和没有立刻解决的缺陷记录，其实现会被考虑列入待定事项。</p>
<p>　　完整列表当前仅被内部参照，没有公开。</p>
<h1 id="版本发布记录"><a class="header" href="#版本发布记录">版本发布记录</a></h1>
<p>　　发布页可能包括后续开发信息。</p>
<p>　　关于被发布的资源，参见<a href="Archives.zh-CN.html">归档</a> 。</p>
<h2 id="prealpha-发布页"><a class="header" href="#prealpha-发布页">PreAlpha 发布页</a></h2>
<h3 id="prealpha-1"><a class="header" href="#prealpha-1">PreAlpha 1</a></h3>
<p>http://tieba.baidu.com/p/767225536 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=3878 。</p>
<h3 id="prealpha-2"><a class="header" href="#prealpha-2">PreAlpha 2</a></h3>
<p>http://tieba.baidu.com/p/1043526998 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=17543 。</p>
<h3 id="prealpha-3"><a class="header" href="#prealpha-3">PreAlpha 3</a></h3>
<p>http://tieba.baidu.com/p/1511876559 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=22988 。</p>
<h3 id="prealpha-4"><a class="header" href="#prealpha-4">PreAlpha 4</a></h3>
<p>http://tieba.baidu.com/p/2288320823 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=25961 。</p>
<h3 id="prealpha-5"><a class="header" href="#prealpha-5">PreAlpha 5</a></h3>
<p>http://tieba.baidu.com/p/3069607390 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=26450 。</p>
<h2 id="alpha-发布页"><a class="header" href="#alpha-发布页">Alpha 发布页</a></h2>
<h3 id="06"><a class="header" href="#06">0.6</a></h3>
<p>http://tieba.baidu.com/p/3747376832 。</p>
<p>http://www.yayabo.cn/forum.php?mod=viewthread&amp;tid=26718 。</p>
<h3 id="07"><a class="header" href="#07">0.7</a></h3>
<p>http://tieba.baidu.com/p/4701412006 。</p>
<h1 id="版本日程记录"><a class="header" href="#版本日程记录">版本日程记录</a></h1>
<p>　　记录的时间来自存档和提交记录，使用时区 UTC+8 。</p>
<p>　　发布版本的计划时间为截止时间。评估计划完成情况时，实际时间应早于此时间。</p>
<h2 id="prealpha-1"><a class="header" href="#prealpha-1">PreAlpha</a></h2>
<p>　　早期开发版本计划未定。发布版本为每 100 个开发更新版本中形成。</p>
<p>　　计划（追溯）及里程碑版本：</p>
<ul>
<li><strong>PreAlpha 0</strong> 2009-02 W3
<ul>
<li>PALibTest: 2009-10-10</li>
</ul>
</li>
<li><strong>PreAlpha 1</strong> 2010-03 W1
<ul>
<li>YSTest b98: 2010-05-05</li>
</ul>
</li>
<li>使用 <a href="https://www.mercurial-scm.org/">Mercurial</a>
<ul>
<li>YSLib b132 2010-07-13</li>
</ul>
</li>
</ul>
<p>　　使用版本控制，开发更新版本对应提交版本。提交版本仅主分支版本。更新频率逐步控制为 8 提交版本/月，其中月以自然月计，折合 4 周工作量。</p>
<p>　　计划及实际发布版本：</p>
<ul>
<li><strong>PreAlpha 2</strong> 2011-03 W4
<ul>
<li>YSLib b200: 2011-04-11</li>
</ul>
</li>
<li><strong>PreAlpha 3</strong> 2012-04 W2
<ul>
<li>YSLib b300: 2012-04-12</li>
</ul>
</li>
<li><strong>PreAlpha 4</strong> 2013-04 W4
<ul>
<li>YSLib b400: 2013-04-24</li>
</ul>
</li>
<li><strong>PreAlpha 5</strong> 2014-05 W2
<ul>
<li>YSLib b500: 2014-05-30</li>
</ul>
</li>
</ul>
<h2 id="alpha-1"><a class="header" href="#alpha-1">Alpha</a></h2>
<p>　　保持提交和发布版本更新频率不变。</p>
<p>　　计划及实际发布版本：</p>
<ul>
<li><strong>V0.6</strong> 2015-05 W4
<ul>
<li>YSLib b500: 2015-05-26</li>
</ul>
</li>
<li><strong>V0.7</strong> 2016-06 W2
<ul>
<li>YSLib b500: 2016-06-11</li>
</ul>
</li>
</ul>
<p>　　为便于特性整合和进度统计， 2017 Q2 计划提交和发布版本基准周期增加 1 倍。</p>
<p>　　新的发布计划日程安排于 2017-07-01 启用。追溯 Alpha 发布历史并调整截止日程：</p>
<ul>
<li><strong>V0.6</strong> 2016-06 W2</li>
<li><strong>V0.7</strong> 2018-07 W2</li>
</ul>
<p>　　使用以下日程同步计划过渡到新的截止日期：</p>
<ul>
<li>同步目标外推 4 次，并对每个发布版本递增添加 4 周发布准备，至 <strong>V0.11</strong> 2027-01 W2 。</li>
<li>计划使用在新的基准周期外的至多和原提交周期相同的额外缓冲时间和截止日程同步。
<ul>
<li>因此，提交版本周期至多为原周期的 3 倍；即当前更新频率控制为至少 8/3 提交版本/月 。</li>
</ul>
</li>
<li>同时，抽取 6 周用于 <strong>V0.8</strong> 发布准备。
<ul>
<li>原计划外推 <strong>V0.8</strong> 发布时间为 2017-06 W4 ，推迟后为 2017-08 W2 。</li>
<li>新计划外推 1 次 2018-08 W2 ，同步版本后相差 24 月，补充到后续发布版本中。</li>
</ul>
</li>
</ul>
<p>　　随之改订的计划及待定发布版本：</p>
<ul>
<li><strong>V0.8</strong> 2017-08 W2
<ul>
<li>YSLib b800: 2017-08-10</li>
</ul>
</li>
<li><strong>V0.9</strong> 2020-10 W2
<ul>
<li>YSLib b900: 2020-10-13</li>
</ul>
</li>
<li><strong>V0.10</strong> 2023-12 W2
<ul>
<li>YSLib b1000: TBD</li>
</ul>
</li>
<li><strong>V0.11</strong> 2027-01 W2
<ul>
<li>YSLib b1100: TBD</li>
</ul>
</li>
</ul>
<h2 id="beta"><a class="header" href="#beta">Beta</a></h2>
<p>　　待定。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概要-3"><a class="header" href="#概要-3">概要</a></h1>
<p>　　归档文件目前存放于以下位置：</p>
<ul>
<li><a href="http://pan.baidu.com">百度云网盘</a>：进入 <a href="http://pan.baidu.com/s/1mgjxaY0#list/path=%2FShared%2FYSLib">YSLib 主仓库</a>查看所有发布的文件，可转存或直接下载。
<ul>
<li>因为分享限制，地址可能需要更新。</li>
</ul>
</li>
<li><a href="https://osdn.net">OSDN</a>：进入 <a href="https://osdn.net/projects/yslib/releases/">YSLib 项目下载页</a>查看发布的文件。</li>
</ul>
<p><strong>注意</strong> 作为归档的压缩包文件一般统一使用 7z ，但不同的归档使用不同的压缩算法和选项，对系统资源要求不尽相同。作为极端情况， V0.6 后的 <code>doc</code> 下的压缩包使用具有 1.5GiB 字典的 PPMd 达到约 5% 的压缩比，这一般也要求解压缩时需<strong>预留 20 倍压缩包大小的空余空间，以及 1.5GiB 空余（物理）内存</strong>。</p>
<h1 id="命名规约"><a class="header" href="#命名规约">命名规约</a></h1>
<p>　　文件名使用 <code>[平台环境标识-]包名-版本[-配置]</code>.后缀 。“<code>[]</code>”中为可选项。特定平台的目录名可参照此规约。</p>
<p>　　对于二进制文件和库文件，<a href="Terminology.zh-CN.html">平台环境标识</a>使用目标三元组分类：<code>archc-OS-toolchain</code> ；不限定体系结构的使用 &quot;<code>any</code>&quot; 。</p>
<p>　　发布时若文件没有更新，则不另行更新版本。若某个包不存在预期的版本，尝试使用之前最近的版本代替。</p>
<h2 id="顶级目录结构"><a class="header" href="#顶级目录结构">顶级目录结构</a></h2>
<ul>
<li><code>src</code> 可用于直接构建的源代码（包括外部依赖项的二进制库文件）包</li>
<li><code>example</code> 示例代码</li>
<li><code>doc</code> 文档（打包的 Doxygen 文档）</li>
<li><code>any</code> 体系结构中立的文件（头文件和数据文件）</li>
<li><code>arm-ds-eabi</code> DS 平台文件</li>
<li><code>i686-w64-mingw32</code> Win32 平台文件</li>
<li><code>arm-linux-androideabi</code> Android ARM 平台文件</li>
<li><code>x86_64-linux-gnu</code> Linux x64 平台文件</li>
</ul>
<p><strong>注意</strong> 因为包含所有平台的库文件过大且文件重复，考虑到存储和传输开销，V0.9 起不提供 YSLib 整体的源代码包（位于 <code>src</code>）。请直接参照<a href="GettingSources.zh-CN.html">获取源代码</a>中的来源，同步版本库或下载源代码，再下载所需平台的外部依赖项的归档文件，并按<a href="Development.zh-CN.html">开发说明</a>存储到相应位置。Sysroot 归档中仍包含对应的外部依赖项。</p>
<h2 id="包概要"><a class="header" href="#包概要">包概要</a></h2>
<p>以下为各个具体体系结构目录下的包的概要（并不一定保证每个体系结构具有所有这些包）。</p>
<ul>
<li><code>External</code> 外部依赖项</li>
<li><code>Sysroot</code> 打包的 Sysroot 文件</li>
<li><code>YSTest</code> YSTest 二进制文件</li>
<li><code>YDE</code> 二进制文件</li>
</ul>
<p>　　内容详见以下二进制文件说明。</p>
<p>　　以下为 <code>any</code> 目录下的包的概要。</p>
<ul>
<li><code>yslib-data</code> YSLib 运行时依赖的数据文件，参见<a href="Run.zh-CN.html">运行说明</a></li>
<li><code>ybase-header</code> YBase 头文件</li>
<li><code>yframework-header</code> YFramework 头文件</li>
</ul>
<p>V0.6 起不单独提供头文件，可使用源代码包或 Sysroot 包代替。</p>
<p>　　此外，源代码包名以 <code>-src</code> 为后缀，在 <code>src</code> 目录下；而 <code>Doxygen-html</code> 是通过 Doxygen 生成的 HTML/XHTML 文档的包名，在 <code>doc</code> 目录下。</p>
<h1 id="二进制文件说明"><a class="header" href="#二进制文件说明">二进制文件说明</a></h1>
<p>　　<a href="Releases.zh-CN.html">Beta 阶段</a>前，二进制文件不用于对所有被支持的平台提供完整可用的环境。</p>
<p>　　除以下另行指定， V0.6(build 600) 起，仅第一类支持（支持等级详见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> ）且具有 Sysroot 的平台配置提供完整的二进制文件，包括库和示例项目等。</p>
<h2 id="external"><a class="header" href="#external">External</a></h2>
<p>　　单独<a href="Build.zh-CN.html">构建</a>的<a href="Development.zh-CN.html">外部依赖项</a>，一般是二进制库文件。对所有支持的平台提供。</p>
<p>　　V0.6(build 600) 起<a href="Development.zh-CN.html">版本库中不再保持二进制文件</a>。源代码包 <code>src-*.7z</code> 中包括已经编译的外部依赖项。此外，各个平台目录下的 <code>External-*.7z</code> 单独对依赖项打包，可参照前文中的位置自行放置。</p>
<h2 id="a-hrefsysrootzh-cnhtmlsysroota"><a class="header" href="#a-hrefsysrootzh-cnhtmlsysroota"><a href="Sysroot.zh-CN.html">Sysroot</a></a></h2>
<p>　　b600 起提供在 release 配置下构建部署的 MinGW Sysroot ，包名为 <code>Sysroot</code> 。</p>
<p>　　因为归档文件限制，符号链接压缩为空文件。如需使用符号链接位置的库，可以手动恢复，流程参见<a href="Tools/Scripts.zh-CN.html">构建脚本</a>。</p>
<h2 id="ystest"><a class="header" href="#ystest">YSTest</a></h2>
<p>　　源代码中默认构建的<a href="Features.zh-CN.html">测试用示例项目</a>，按内容命名为 YReader 。</p>
<h2 id="a-hrefydezh-cnhtmlydea"><a class="header" href="#a-hrefydezh-cnhtmlydea"><a href="YDE.zh-CN.html">YDE</a></a></h2>
<p>　　b600 起提供 release 配置下在 Sysroot 上构建的 YDE 合集，包名为 <code>YDE</code> 。</p>
<p>　　其中的可执行文件依赖 YBase 和 YFramework 动态库。</p>
<h1 id="构建环境"><a class="header" href="#构建环境">构建环境</a></h1>
<p>　　<a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared">这里</a>提供了 YSLib 历史和当前版本使用的构建环境相关的归档，其中 YSLib 目录即上述发布仓库。</p>
<h2 id="基本环境和工具链"><a class="header" href="#基本环境和工具链">基本环境和工具链</a></h2>
<p>　　仅提供宿主环境操作系统为 Windows 的二进制文件。</p>
<h3 id="mingw32-目标和宿主环境"><a class="header" href="#mingw32-目标和宿主环境">MinGW32 目标和宿主环境</a></h3>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Fmingwbuilds">mingw-builds</a></li>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Fmingw-w64%2Fmingw-builds">合并到 mingw-w64 发布的 mingw-builds</a></li>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2FMSYS2%2FBase">MSYS2</a></li>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2FMSYS2%2FREPOS%2FMINGW">MSYS2 MinGW 包</a></li>
</ul>
<h3 id="ds-1"><a class="header" href="#ds-1">DS</a></h3>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2FdevkitPro">devkitPro</a></li>
</ul>
<h3 id="android-1"><a class="header" href="#android-1">Android</a></h3>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2FProgram%2FAndroid%2Fwindows-x86_64">Android 独立工具链和 SDK 工具</a></li>
</ul>
<h3 id="linux"><a class="header" href="#linux">Linux</a></h3>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Farchlinux.org">ArchLinux 包</a></li>
</ul>
<h2 id="文档工具"><a class="header" href="#文档工具">文档工具</a></h2>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fdoxygen.nl">Doxygen</a>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fgraphviz.org">GraphViz</a></li>
</ul>
</li>
</ul>
<h2 id="外部依赖项的源代码"><a class="header" href="#外部依赖项的源代码">外部依赖项的源代码</a></h2>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Ffreetype">FreeType2</a></li>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Ffreeimage%2FSource%20Distribution">FreeImage</a>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Flibjpeg-turbo">LibJPEG-Turbo</a></li>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Flibpng">LibPNG</a>
<ul>
<li><a href="https://pan.baidu.com/s/18CcFi4qGRwDMKkIt553tTQ#list/path=%2FShared%2Fsf.net%2Flibpng%2Fzlib">ZLib</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="shbuild"><a class="header" href="#shbuild">SHBuild</a></h1>
<p>　　位于 <code>Tools/SHBuild</code> ，是可以用来递归遍历目录编译链接本机程序和调用其它相关功能的命令行工具。当前仅支持 MinGW32/MinGW64 环境。其它平台详见以下章节。</p>
<p>　　直接（不带参数）运行 <code>SHBuild</code> 查询使用方法和选项等说明。</p>
<h2 id="构建-4"><a class="header" href="#构建-4">构建</a></h2>
<p>　　本节说明 SHBuild 的构建。关于使用 SHBuild 构建用户程序，参见前述概要和之后的章节。</p>
<p>　　除非另行指定，其它章节也适用于本节内构建的非最终阶段 SHBuild 。本章仅补充仅适用于这些 SHBuild 的特点和功能。</p>
<p>　　关于使用 <code>bash</code> 构建库、 SHBuild 、测试项目和基于 SHBuild 上的用户程序，参见<a href="Tools/../Sysroot.zh-CN.html">关于 <strong>MinGW Sysroot</strong> 的说明</a>。</p>
<p>　　当前只支持<a href="Tools/Terminology.zh-CN.html">本机构建</a>。</p>
<p>　　除了指定调用编译器等工具的名称外的其它情形对 SHBuild 是<em>透明(transparent)</em> 的，即 SHBuild 不使用<a href="Tools/Terminology.zh-CN.html">目标平台的标识</a>执行不同逻辑。这样，也可能不经修改调用命令的情况下成功<a href="Tools/Terminology.zh-CN.html">交叉构建</a>，但当前未测试。</p>
<h3 id="引导bootstrapping"><a class="header" href="#引导bootstrapping">引导(Bootstrapping)</a></h3>
<p>　　SHBuild 支持引导，即在受支持的构建环境中直接构建 SHBuild ，不依赖预先构建的 SHBuild 二进制映像。</p>
<p>　　运行脚本 <code>Tools/Scripts/SHBuild-build.sh</code> 生成 SHBuild 可执行文件。</p>
<p>　　脚本直接选取 YSLib 中的源文件作为依赖进行构建。因为直接调用编译器驱动链接，不支持显式指定并行编译，相对比较慢。编译的结果是静态链接的，二进制映像较大。</p>
<p>　　这个过程只需要 C++ 工具链和 shell ，不需要直接调用 <code>make</code> ，但 GCC 使用 <code>-flto</code> 进行优化仍然需要 GNU make 。</p>
<p>　　当前构建最后的链接器警告可以安全忽略。</p>
<p>　　如能成功使用以下的多阶段构建方法（会按需调用引导脚本），一般不建议使用直接构建的版本。</p>
<h3 id="自举self-hosting"><a class="header" href="#自举self-hosting">自举(Self hosting)</a></h3>
<p>　　SHBuild 支持自举，即可使用构建的 SHBuild 继续构建自身。</p>
<p>除需 <code>SHBuild</code> 外，对外部环境的要求和引导一致。</p>
<p>　　SHBuild 一直使用简单的源代码结构，设计初期即支持自举，现时仍不限制自举需要的版本。但由于仅测试相同版本的自举构建，因此一般建议使用相同版本。</p>
<p>　　以下多阶段构建在引导的基础上自举构建 SHBuild 。</p>
<p>　　此外，也可以直接使用 <code>SHBuild-self-host.sh</code> 和 <code>SHBuild-self-host-DLL.sh</code> 进行直接自举。这两个脚本主要用于内部测试。</p>
<h3 id="多阶段构建"><a class="header" href="#多阶段构建">多阶段构建</a></h3>
<p>　　使用<a href="Tools/Scripts.zh-CN.html">工具脚本</a>安装 <a href="Tools/../Sysroot.zh-CN.html">Sysroot</a> 时，按需构建 SHBuild 。当前这个过程分为两步：</p>
<ul>
<li>第一阶段(stage 1) ：引导。
<ul>
<li>调用脚本 <code>Tools/Scripts/SHBuild-build.sh</code> 构建 stage 1 SHBuild 。只依赖编译器进行编译链接。</li>
<li>主要用于下一阶段使用。不保证具有所有 SHBuild 的功能特性。一般不建议直接使用。</li>
</ul>
</li>
<li>第二阶段(stage 2) ：自举。
<ul>
<li>在脚本 <code>Tools/install-sysroot.sh</code> 内直接调用成功引导的 <code>SHBuild</code> ，构建时链接到之前构建的 YFramework 和 YBase 动态库。</li>
<li>自举结果为 stage 2 SHBuild ，这是当前最终生成的 SHBuild ，链接和运行依赖上述动态库。</li>
</ul>
</li>
</ul>
<p>　　这些阶段需要的外部环境对应称为 stage 1 环境和 stage 2 环境。</p>
<p>　　由于<a href="Tools/Terminology.zh-CN.html">多平台构建</a>的自然要求，这些环境需要相同（本机构建），或至少保持兼容性。当前工具脚本没有另行显示指定使用不同平台的接口，因此只支持本机构建。</p>
<h2 id="运行-2"><a class="header" href="#运行-2">运行</a></h2>
<p>　　SHBuild 通过参数执行命令，支持不同的运行模式：</p>
<ul>
<li>构建模式：调用递归扫描指定的目录以调用构建后端工具。</li>
<li>命令模式：执行内建的功能。</li>
</ul>
<p>　　命令模式以 <code>-xcmd,</code> 起始的选项指定。其它情形的运行使用构建模式。</p>
<p>　　命令行参数 <code>--</code> 钱的参数中，以 <code>-x</code> 起始的特定选项（详见运行 <code>SHBuild</code> 的说明）被作为 SHBuild 选项。命令行参数 <code>--</code> 后的参数不被识别为 SHBuild 选项，而被传递给后端或作为命令模式的参数。</p>
<h3 id="构建模式"><a class="header" href="#构建模式">构建模式</a></h3>
<p>　　构建模式递归扫描指定的源代码目录，以其中符合内建规则要求的文件作为输入，调用相应的后端命令行构建。构建包括对符合内建规则的输入的编译，以及对得到的目标文件进行链接。除 SHBuild 选项的命令行参数直接传除递给后端编译器。若需要构建复杂项目，可以使用其它的脚本支持。</p>
<p>　　调用的构建后端工具的名称以及链接器命令行选项可使用环境变量指定。此外，若环境变量 <code>SHBuild_CFLAGS</code> 和 <code>SHBuild_CXXFLAGS</code> 被定义为非空值，调用 C 和 C++ 编译器命令行时，变量的值会先于生成的命令选项以及上述命令行选项被传递。关于支持的环境变量，详见运行 <code>SHBuild</code> 的说明。</p>
<p>　　调用的后端命令行的不同的命令行选项之间应确保以空白符间隔。环境变量确定的选项不被检查；由 SHBuild 生成的命令行选项之间以一个空格分隔。</p>
<h3 id="内建规则"><a class="header" href="#内建规则">内建规则</a></h3>
<p>　　遍历扫描目录时，不需要使用领域特定语言的外部脚本，<code>SHBuild</code> 识别名称符合特定模式串的文件。</p>
<p>　　当前支持后缀名区分源文件。</p>
<p>　　文件名符合以下通配符模式的文件视为 C 源文件：</p>
<ul>
<li><code>*.c</code></li>
</ul>
<p>　　文件名符合以下通配符模式的文件视为 C++ 源文件：</p>
<ul>
<li><code>*.cpp</code></li>
<li><code>*.cc</code></li>
<li><code>*.cxx</code></li>
</ul>
<p>　　对以上文件，对应的内建 C 和 C++ 编译器规则分别被调用。其它文件不被视为源文件。</p>
<p>　　和 <code>make</code> 类似， SHBuild 的内建规则依赖文件修改时间(mtime) 判断一个目标是否最新。</p>
<p>　　内建规则使用的编译器和环境变量参见直接运行 <code>SHBuild</code> 的使用说明。</p>
<h3 id="命令模式"><a class="header" href="#命令模式">命令模式</a></h3>
<p>　　参见运行 <code>SHBuild</code> 的说明。</p>
<h2 id="构建应用程序"><a class="header" href="#构建应用程序">构建应用程序</a></h2>
<p>　　使用 SHBuild 构建应用程序所需的环境和多阶段构建的最后一个阶段的相同。当前和自举时相同，即 stage 2 环境。</p>
<h2 id="其它平台"><a class="header" href="#其它平台">其它平台</a></h2>
<p>　　除构建 stage 1 SHBuild 外，当前未正式支持 Linux 。</p>
<p>　　因为 SHBuild 本身和直接依赖的代码已经保证了可移植性，所以静态链接可以成功。得到的可执行文件除了没有扩展名，用法和前述 MinGW 下相同。</p>
<p>　　使用进一步编译 YFramework 可能会出错，因为 YFramework 中宿主 GUI 支持未在 Linux 上实现。这不影响已经构建的 SHBuild 的可用性。</p>
<p><strong>已知限制</strong> 若系统时间不正确，可能导致冗余的重复构建或无法构建。若文件时间戳无法被正确更新（如编译器或者文件系统实现问题导致无法在命令执行后正确地更新被修改的文件时间，或者不恰当的缓存配置导致修改时间没有立即更新），可能导致冗余的重复构建。</p>
<p>　　当前不支持上述以外的其它平台。</p>
<h2 id="npl-支持"><a class="header" href="#npl-支持">NPL 支持</a></h2>
<p>　　SHBuild 运行 <code>-xcmd,RunNPL</code> 和 <code>-xcmd,RunNPLFile</code> 命令支持解释 <a href="Tools/../Features/NPL.zh-CN.html">NPLA1</a> 翻译单元。</p>
<p>　　调用方式详见帮助文本。</p>
<p>　　后者的翻译单元为文本文件。当前支持文件头可选的 UTF BOM 。**若找到 BOM ，直接跳过继续读取文件内容。在 SHBuild 中不假设文件编码，直接以窄字符流透明地处理。后续编码内容格式按<a href="Tools/../Features/NPL.zh-CN.html"> YFramework 提供的当前实现</a>的方式支持。</p>
<p>　　因此，一般应使用 UTF-8 + BOM ，或不带 BOM 的 UTF-8 作为编码。</p>
<h3 id="应用"><a class="header" href="#应用">应用</a></h3>
<p>　　当前 stage 1 SHBuild 构建 YSLib 库使用<a href="Tools/Scripts.zh-CN.html">脚本</a>已以此方式实现。 Shell 脚本调用 stage 1 SHBuild 解释这些脚本，其中进一步调用 stage 1 SHBuild 执行其它构建命令。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="revisionpatcher"><a class="header" href="#revisionpatcher">RevisionPatcher</a></h1>
<p>　　位于 <code>Tools/RevisionPatcher</code> ，是开发过程中用于修改版本工具。</p>
<p>　　当前只支持从标准输入中提取版本号，内容要求为补丁文件。</p>
<p>　　默认使用标准输出打印结果，内容为从补丁文件提取的目标文件名以及新的版本号。</p>
<p>　　不修改任何其它文件。</p>
<p>　　版本号通过补丁内的信息计算。使用规则参见 YSLib 项目文档 <code>doc/ProjectRules.txt</code> 。</p>
<p>　　仅测试了 <code>hg diff</code> 导出的补丁文件。</p>
<h2 id="构建-5"><a class="header" href="#构建-5">构建</a></h2>
<p>　　依赖 YBase 和 YFramework 库，没有特别的构建支持，可以使用 stage 2 <a href="Tools/SHBuild.zh-CN.html"><code>SHBuild</code></a> ，详见 <a href="Tools/Scripts.zh-CN.html">sysroot 安装脚本</a> 。</p>
<h3 id="清单manifest-文件"><a class="header" href="#清单manifest-文件">清单(manifest) 文件</a></h3>
<p>　　因为文件名包含 <code>patch</code> ， <a href="https://github.com/bmatzelle/gow/issues/156">Windows 可能默认要求以管理员权限运行</a> 。安装脚本使用 manifest 文件指定免除此需要。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="revisionpatcher-1"><a class="header" href="#revisionpatcher-1">RevisionPatcher</a></h1>
<p>　　位于 <code>Tools/SXML2XML</code> ，用于转换 <a href="http://okmij.org/ftp/Scheme/xml.html">SXML</a> 文档到 <a href="http://www.w3.org/TR/rec-xml">XML</a> 文档。</p>
<p>　　当前只支持 UTF-8 编码，不支持 XML 命名空间。</p>
<p>　　默认使用标准输出打印结果。</p>
<h2 id="构建-6"><a class="header" href="#构建-6">构建</a></h2>
<p>　　依赖 YBase 和 YFramework 库，没有特别的构建支持，可以使用 stage 2 <a href="Tools/SHBuild.zh-CN.html"><code>SHBuild</code></a> ，详见 <a href="Tools/Scripts.zh-CN.html">sysroot 安装脚本</a> 。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="projectgenerator"><a class="header" href="#projectgenerator">ProjectGenerator</a></h1>
<p>　　位于 <code>Tools/ProjectGenerator</code> ，用于生成项目文件。</p>
<p>　　当前只支持 UTF-8 编码的 Code::Blocks <code>.cbp</code> 文件。</p>
<p>　　使用标准输出打印结果。</p>
<h2 id="构建-7"><a class="header" href="#构建-7">构建</a></h2>
<p>　　依赖 YBase 和 YFramework 库，没有特别的构建支持，可以使用 stage 2 <a href="Tools/SHBuild.zh-CN.html"><code>SHBuild</code></a> ，详见 <a href="Tools/Scripts.zh-CN.html">sysroot 安装脚本</a> 。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="概述-4"><a class="header" href="#概述-4">概述</a></h1>
<p>　　YSLib 项目提供一系列工具脚本。这些脚本主要集中位于 <code>Tools</code> 和 <code>Tools/Scripts</code> 。其余特定局部用途的脚本可能位于其它目录，这些脚本可能依赖版本库内的工具脚本或 YSLib 安装时部署的工具脚本。</p>
<p>　　关于脚本的解释环境和其它一般规则，参见<a href="Tools/../Development.zh-CN.html">关于脚本的开发说明</a>。</p>
<h1 id="tools"><a class="header" href="#tools">Tools</a></h1>
<p>　　未归类的工具目录。这个目录的脚本是可用于整个项目或非特定子项目的工具脚本，如公用的构建脚本。</p>
<p>　　工具脚本位于版本库目录 <code>Tools</code> 及其子目录 <code>Scripts</code> 下。</p>
<p>　　工具主要用于开发，包括构建和版本库维护。</p>
<p>　　一部分工具脚本也可被部署到 <a href="Tools/../Sysroot.zh-CN.html">Sysroot</a> 。在 <a href="Tools/SHBuild.zh-CN.html">stage 2 SHBuild</a> 安装后运行的脚本可依赖安装的 Sysroot 实例的文件系统布局。支持维护版本库的开发脚本应保证在此之前（不依赖 Sysroot 的实例或仅依赖构建 stage 1 后可用的有限环境）可用。</p>
<h2 id="toolsinstall-sysrootsh"><a class="header" href="#toolsinstall-sysrootsh">Tools/install-sysroot.sh</a></h2>
<p>　　Sysroot 安装脚本。用于直接构建和部署基础环境。</p>
<p>　　构建时会调用 <code>Tools/Scripts</code> 目录下的脚本，按需构建 <a href="Tools/SHBuild.zh-CN.html">stage 1 SHBuild</a> 后间接调用 <code>SHBuild</code> 构建 <code>YBase</code> 和 <code>YFramework</code> 的静态库和动态库，再构建依赖于动态库的 <code>SHBuild</code> 。</p>
<p>　　构建使用变量 <code>SHBuild_BuildDir</code> 指定的路径作为中间输出目录，默认为 YSLib 版本库根目录下的 <code>build/$(SHBuild_GetBuildName)</code> 目录。 </p>
<p>　　构建脚本同时可安装文件，完成 Sysroot 所需文件的部署。安装的起始目标位置由称为<strong>安装路径</strong>的目录路径指定，其字符串形式去除结尾分隔符的目录文件名为<strong>安装路径前缀</strong>。安装过程在必要时可创建 Sysroot 根目录、安装路径指定的目录及其子目录。安装路径的确定方式详见以下的使用方式。</p>
<p>　　部署时使用 stage 1 SHBuild 更新文件和目录，在必要时创建符号链接或硬链接，若失败则改为普通复制。仅当被部署的文件为中间目标启用硬链接，以免后续操作意外覆盖源文件。注意在 Windows 上创建符号链接可能因为权限不足失败，取决于用户和组策略。建议使用系统管理权限运行以避免可能的权限问题。</p>
<h3 id="基本使用"><a class="header" href="#基本使用">基本使用</a></h3>
<p>　　脚本中使用以下配置传递至 <code>SHBuild</code> ：</p>
<pre><code>: ${SHBuild_BuildOpt:=&quot;-xj,6&quot;}
: ${SHBuild_LogOpt:=&quot;-xlogfl,128&quot;}
: ${SHBuild_Opt:=&quot;${SHBuild_LogOpt} ${SHBuild_BuildOpt}&quot;}
</code></pre>
<p>　　因此可以直接用 <code>export</code> 或直接在命令行指定变量覆盖默认行为，如</p>
<pre><code>SHBuild_BuildOpt=-xj,2 Tools/install-sysroot.sh
</code></pre>
<p>　　使用 2 个并行线程构建。</p>
<p>　　脚本也支持变量配置构建使用的路径，默认如下：</p>
<pre><code>: ${SHBuild_SysRoot:=&quot;$YSLib_BaseDir/sysroot&quot;}
SHBuild_PrepareBuild
: ${SHBuild_BuildDir:=&quot;$YSLib_BaseDir/build/$(SHBuild_GetBuildName)&quot;}
</code></pre>
<p>　　其中，各个变量的作用参见以上 shell 环境变量的说明。</p>
<p>　　在 stage 1 SHBuild 构建调用 NPLA1 脚本 <code>Tools/Scripts/SHBuild-YSLib*.txt</code> ，调用方式和接受的配置（构建目标等）、具体默认设置和注意事项见对应 shell 脚本的文档相关章节。</p>
<h1 id="toolsscripts"><a class="header" href="#toolsscripts">Tools/Scripts</a></h1>
<p>　　这个目录的脚本可用于整个项目或项目核心部分的构建工具使用。</p>
<p>　　当前有以下脚本忽略重复的 <code>.</code> 或 <code>source</code> 命令：</p>
<ul>
<li>SHBuild-common.sh</li>
</ul>
<p>　　以前缀 <code>SHBuild_</code> 起始的名称保留使用。</p>
<p>　　其中，前缀 <code>SHBuild_Env_</code> 总是表示环境配置的只读变量名。这些变量若未被指定，可在第一次访问时（具体时机未指定）初始化为：</p>
<ul>
<li><code>SHBuild_Env_Arch</code> ：参见函数 <code>SHBuild_CheckUName</code> 。</li>
<li><code>SHBuild_Env_OS</code> ：参见函数 <code>SHBuild_CheckUName</code> 。</li>
<li><code>SHBuild_Env_TempDir</code> ：缓存函数 <code>SHBuild_GetTempDir</code> 的输出。 </li>
<li><code>SHBuild_Env_uname</code> ：缓存命令 <code>uname</code> 的输出。</li>
<li><code>SHBuild_Env_uname_m</code> ：缓存命令 <code>uname -m</code> 的输出。 </li>
</ul>
<h2 id="toolsscriptsgenerateprojectssh"><a class="header" href="#toolsscriptsgenerateprojectssh">Tools/Scripts/GenerateProjects.sh</a></h2>
<p>　　调用 <a href="Tools/ProjectGenerator.zh-CN.html">ProjectGenerator</a> 生成项目文件。</p>
<p>　　当前支持生成所有 <code>.cbp</code> 文件。</p>
<p>　　要求可使用 <code>hg</code> 或 <code>git</code> 命令取版本库根目录，否则不保证输出到正确的路径。</p>
<h3 id="变量-projectgenerator"><a class="header" href="#变量-projectgenerator">变量 ProjectGenerator</a></h3>
<p>　　调用 RevisionPatcher 的命令。默认直接使用 <code>which ProjectGenerator</code> 的结果，一般要求可执行文件在环境变量 <code>PATH</code> 中。</p>
<h2 id="toolsscriptspatchrevisionsh"><a class="header" href="#toolsscriptspatchrevisionsh">Tools/Scripts/PatchRevision.sh</a></h2>
<p>　　开发过程中使用 <a href="Tools/RevisionPatcher.zh-CN.html">RevisionPatcher</a> 维护源文件中版本号的脚本。</p>
<p>　　当前只支持 Mercurial 版本库的已添加或修改的未提交文件。</p>
<p>　　脚本首先把未提交的这些修改导出为补丁备份到版本库根目录的 <code>bak.patch</code> ，然后使用这些内容调用 RevisionPatcher 取得文件和对应的新的版本号列表，最后使用 <code>sed</code> 查找对应文件并更新版本号。</p>
<p>　　若没有找到 <code>\version r</code> 模式的版本号前缀则忽略写入版本号。写入的版本号不影响换行符。</p>
<h3 id="变量-patchbegin"><a class="header" href="#变量-patchbegin">变量 PatchBegin</a></h3>
<p>　　匹配版本号的起始行，应为一个表示行数的正整数。默认值为 <code>&quot;1&quot;</code> 。</p>
<h3 id="变量-patchbegin-1"><a class="header" href="#变量-patchbegin-1">变量 PatchBegin</a></h3>
<p>　　匹配版本号的结束行，应为一个表示行数的正整数。默认值为 <code>&quot;20&quot;</code> 。</p>
<h3 id="变量-revisionpatcher"><a class="header" href="#变量-revisionpatcher">变量 RevisionPatcher</a></h3>
<p>　　调用 RevisionPatcher 的命令。默认直接使用 <code>which RevisionPatcher</code> 的结果，一般要求可执行文件在环境变量 <code>PATH</code> 中。</p>
<h2 id="toolsscriptsshbuild-bootstrapsh"><a class="header" href="#toolsscriptsshbuild-bootstrapsh">Tools/Scripts/SHBuild-bootstrap.sh</a></h2>
<p>　　编译 <a href="Tools/SHBuild.zh-CN.html">stage 1 SHBuild</a> 时被包含的脚本。</p>
<p>　　其中指定了静态链接需要依赖的 YSLib 源文件以及头文件路径等。</p>
<h2 id="toolsscriptsshbuild-buildsh"><a class="header" href="#toolsscriptsshbuild-buildsh">Tools/Scripts/SHBuild-build.sh</a></h2>
<p>　　编译 <a href="Tools/SHBuild.zh-CN.html">stage 1 SHBuild</a> 的脚本。</p>
<p>　　使用变量 <code>SHBuild_Output</code> 指定输出路径。默认值为 <code>SHBuild</code> ，即在当前工作目录下生成名为 <code>SHBuild</code> 的可执行文件（视宿主平台不同可能带后缀如 Win32 带 <code>.exe</code> ）。</p>
<p>　　调用函数 <code>SHBuild_CheckPCH</code> 检查预编译头：若变量 SHBuild_NoPCH 非空则跳过预编译头，否则使用预编译头包含标准库头。预编译的头文件目标由 YBase 下的 <code>stdinc.h</code> ，之后构建时包含预编译头路径为 <code>$SHBuild_PCH_stdinc_h</code> 。后者的默认路径为当前工作目录下的 <code>stdinc.h</code> 。</p>
<p><strong>已知缺陷</strong> 不自动更新预编译头。</p>
<h2 id="toolsscriptsshbuild-buildappsh"><a class="header" href="#toolsscriptsshbuild-buildappsh">Tools/Scripts/SHBuild-BuildApp.sh</a></h2>
<p>　　应用程序构建脚本。这个脚本被保留，不再具有实际功能。</p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>bin</code> 目录下。</p>
<h2 id="toolsscriptsshbuild-buildpkgsh"><a class="header" href="#toolsscriptsshbuild-buildpkgsh">Tools/Scripts/SHBuild-BuildPkg.sh</a></h2>
<p>　　包构建脚本。当前只支持构建应用程序，具体步骤和使用的参数参见 <code>Tools/Script/SHBuild-BuildApp.txt</code> 。</p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>bin</code> 目录下。</p>
<h2 id="toolsscriptsshbuild-commonsh"><a class="header" href="#toolsscriptsshbuild-commonsh">Tools/Scripts/SHBuild-common.sh</a></h2>
<p>　　被应用程序构建脚本包含的脚本，提供公共基础功能。</p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>bin</code> 目录下。</p>
<p><strong>注意</strong> 这个脚本包含 <code>INC_SHBuild_common</code> 守卫变量检查，默认重复包含只被执行一次。</p>
<h3 id="函数-shbuild_popd"><a class="header" href="#函数-shbuild_popd">函数 SHBuild_Popd</a></h3>
<p>　　同 <code>bash</code> 内建 <code>popd</code> 但不回显标准输出。</p>
<h3 id="函数-shbuild_pushd"><a class="header" href="#函数-shbuild_pushd">函数 SHBuild_Pushd</a></h3>
<p>　　同 <code>bash</code> 内建 <code>pushd</code> 但不回显标准输出。</p>
<h3 id="函数-shbuild_put"><a class="header" href="#函数-shbuild_put">函数 SHBuild_Put</a></h3>
<p>　　使用 <code>printf</code> 输出非格式字符串。</p>
<h3 id="函数-shbuild_puts"><a class="header" href="#函数-shbuild_puts">函数 SHBuild_Puts</a></h3>
<p>　　使用 <code>printf</code> 输出非格式的换行的字符串。</p>
<p>　　换行符由变量 <code>SHBuild_EOL</code> 指定。当前默认值通过检查 <code>$COMSPEC</code> 是否定义，以确保 Windows 环境（包括 MSYS ）使用 CR+LF ，其它情况使用 LF 。</p>
<p>　　这个函数在可用时可用于代替 <code>echo</code> ，以取得对环境更好的适应性。</p>
<p><strong>注意</strong> 具体的检查逻辑实现可能在以后改变。</p>
<h3 id="函数-shbuild_assertnonempty"><a class="header" href="#函数-shbuild_assertnonempty">函数 SHBuild_AssertNonempty</a></h3>
<p>　　断言第一参数为名称的变量非空，否则显示出错并退出。</p>
<p>　　使用 <code>eval</code> 实现。</p>
<h3 id="函数-shbuild_checkedcall"><a class="header" href="#函数-shbuild_checkedcall">函数 SHBuild_CheckedCall</a></h3>
<p>　　检查第一参数为名称的命令存在，否则显示出错并退出。</p>
<p>　　使用 <code>hash</code> 实现以优化性能。</p>
<h3 id="函数-shbuild_checkedcallsilent"><a class="header" href="#函数-shbuild_checkedcallsilent">函数 SHBuild_CheckedCallSilent</a></h3>
<p>　　同 SHBuild_CheckedCall ，但不显示错误外的标准输出。</p>
<h3 id="函数-shbuild_initreadonly"><a class="header" href="#函数-shbuild_initreadonly">函数 SHBuild_InitReadonly</a></h3>
<p>　　断言第一参数为名称的变量非空，若空则使用 <code>eval</code> 对后续求值并初始化第一参数指定的只读变量。若发生初始化则在标准输出中显示。</p>
<h3 id="函数-shbuild_2m"><a class="header" href="#函数-shbuild_2m">函数 SHBuild_2m</a></h3>
<p>　　接受 1 个表示路径的参数，调用 <code>cygpath</code> 转换路径到 Windows 混合风格路径。</p>
<p>　　当 <code>cygpath</code> 不存在时返回原路径。</p>
<h3 id="函数-shbuild_2u"><a class="header" href="#函数-shbuild_2u">函数 SHBuild_2u</a></h3>
<p>　　接受 1 个表示路径的参数。</p>
<p>　　调用 <code>cygpath</code> 转换 Windows 路径到 UNIX 路径。</p>
<p>　　当 <code>cygpath</code> 不存在时返回原路径。</p>
<h3 id="函数-shbuild_echoescape"><a class="header" href="#函数-shbuild_echoescape">函数 SHBuild_EchoEscape</a></h3>
<p>　　当标准输出使用终端时调用 <code>echo -ne</code> 输出参数指定的 ANSI 转义序列。</p>
<p><strong>已知缺陷</strong> 不检查 <code>$TERM</code> 支持。</p>
<h3 id="函数-shbuild_echovar"><a class="header" href="#函数-shbuild_echovar">函数 SHBuild_EchoVar</a></h3>
<p>　　接受 2 个参数 x 和 y ，以特定颜色显示为 x = y 的形式。</p>
<h3 id="函数-shbuild_echovar_n"><a class="header" href="#函数-shbuild_echovar_n">函数 SHBuild_EchoVar_N</a></h3>
<p>　　接受 1 个参数 x ，调用 <code>SHBuild_EchoVar</code> 显示为 x = $x 的形式。</p>
<p>　　右侧求值时会替换参数中的 <code>.</code> 为 <code>_</code> 。</p>
<h3 id="函数-shbuild_checkuname"><a class="header" href="#函数-shbuild_checkuname">函数 SHBuild_CheckUName</a></h3>
<p>　　调用 <code>SHBuild_CheckedCall</code> 初始化只读变量 <code>SHBuild_Env_OS</code> 和 <code>SHBuild_Env_Arch</code> 的值。</p>
<p>　　变量 <code>SHBuild_Env_OS</code> 的值通过分类系统的值（一般即 <code>SHBuild_Env_uname</code> 的值）标识操作系统：</p>
<ul>
<li><code>OS_X</code> ：输入匹配 *Darwin* ，用于标识 OS X 系统</li>
<li><code>Win32</code> ：输入匹配 *MIGW* 或 *MSYS* ，用于标识 Windows （桌面）系统</li>
<li><code>Linux</code> ：输入匹配 *Linux* ，用于标识 Linux 系统。</li>
<li><code>unknown</code> ： 不支持的系统。</li>
</ul>
<p>　　变量 <code>SHBuild_Env_Arch</code> 的值通过分类输入的处理器体系结构的值（一般即 <code>SHBuild_Env_uname_m</code> 的值）标识体系结构：</p>
<ul>
<li><code>x86_64</code> ：输入匹配 x86_64 或 i*86-64 。</li>
<li><code>i*86</code> ：输入匹配 i*86 ，使用原值。</li>
<li><code>aarch64</code> ：输入是 aarch64 。</li>
<li><code>unknown</code> ：不支持的体系结构。</li>
</ul>
<p>　　若同时指定环境变量 <code>SHBuild_Env_Arch</code> 和 <code>SHBuild_Env_OS</code> ，不进行<a href="Tools/Prerequisitions.zh-CN.html">自动环境检测</a>，不依赖 <code>uname</code> 。</p>
<h3 id="函数-shbuild_gettempdir"><a class="header" href="#函数-shbuild_gettempdir">函数 SHBuild_GetTempDir</a></h3>
<p>　　取临时目录的路径。</p>
<p>　　依次检查以下环境变量的值，若非空则作为结果：</p>
<ul>
<li><code>TMPDIR</code></li>
<li><code>TEMP</code></li>
<li><code>TMP</code></li>
</ul>
<p>　　若这些环境变量都没有非空值，则使用经过 <code>SHBuild_2m</code> 转换的 <code>/tmp</code>（被 <a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap10.html#tag_10_01">POSIX.1 要求支持</a>）作为结果。</p>
<p><strong>注意</strong> 以上过程在所有平台上都一致。这是自适应环境的基本接口，因此不对环境变量的值的合法性进行判断。若结果不表示一个可访问的目录，在访问以此构造的文件路径时可能引发错误。应用程序一般需自行检查或保证使用的环境中这些路径可访问。</p>
<p><strong>说明</strong> 以上检查中，支持的环境变量符合<a href="https://en.wikipedia.org/wiki/TMPDIR">惯例(en-US)</a> 。检查环境变量的顺序（偶然地）和一些类似功能的实现（如 <a href="https://dev.mysql.com/doc/refman/8.0/en/temporary-files.html">MySQL 在 Windows 上</a>）一致，和其它一些特定平台的 API（如 <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-gettemppathw">Win32 API</a> ）及另一些不作为公开行为的实现（如 <a href="https://gcc.gnu.org/onlinedocs/gcc-4.8.5/libiberty/Functions.html#index-choose_005ftmpdir-66">libiberty 的 <code>choose_tmpdir</code></a> ）可能不一致。被支持的环境变量可用性举例：</p>
<ul>
<li><code>TMPDIR</code> ：<a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/V1_chap08.html">POSIX.1 要求的环境变量</a> 。</li>
<li><code>TEMP</code> ：被 <a href="https://docs.microsoft.com/en-us/windows/win32/api/fileapi/nf-fileapi-gettemppathw">Win32 文件 API</a> 等使用。</li>
<li><code>TMP</code> ：被 Win32 文件 API 和 <a href="https://docs.microsoft.com/en-us/cpp/c-runtime-library/reference/tempnam-wtempnam-tmpnam-wtmpnam?view=msvc-160">Microsoft C 运行时 API</a> 等使用。</li>
<li>另见<a href="https://devblogs.microsoft.com/oldnewthing/20150417-00/?p=44213">对 MS-DOS 和 Microsoft Windows 使用的临时目录环境变量解释</a>。</li>
</ul>
<p><strong>已知限制</strong> 不检查路径是否表示实际可写的目录。另见文件访问约定。</p>
<p>　　当前脚本实现假定临时目录可写，不满足条件时，文件操作可能失败。脚本使用的临时文件前也不保证检查文件可写。若此文件不可写（例如，在之前被 <code>root</code> 等高权限用户创建），则依赖文件可写的操作可能失败。对构建脚本，这可能导致依赖临时文件进行检查判断失效，而使错误的选项被使用。</p>
<p>　　一般地，脚本可使用特定的例程（如 Shell 脚本可选地使用<a href="https://stackoverflow.com/questions/2792675">在许多环境中可用的 <code>mktemp</code> 命令</a>）随机化文件名减少冲突。若需要更可靠地避免上述问题，可在运行脚本前清理临时目录，或预先设置 <code>SHBuild_GetTempDir</code> 访问的环境变量指定确保可写的空目录，同时避免并发调用脚本导致不安全并发访问此目录中的临时文件。脚本不使用其它方法确定直接使用的临时目录，但脚本间接调用的外部工具仍可能导致不安全的访问，而无法保证可靠。</p>
<h3 id="函数-shbuild_platform_detect"><a class="header" href="#函数-shbuild_platform_detect">函数 SHBuild_Platform_Detect</a></h3>
<p>　　通过参数指定的操作系统和体系结构名，并结合环境变量，确定平台名称，检查非空并返回。</p>
<p>　　当前支持的结果包括：</p>
<ul>
<li>MinGW64</li>
<li>MinGW32</li>
<li>第一个参数指定的操作系统名</li>
</ul>
<p>　　当前 <code>Win32</code> 系统外的结果和 <code>SHBuild_CheckUName</code> 初始化 <code>SHBuild_Env_OS</code> 的结果一致。否则，处理如下：</p>
<ul>
<li>若环境变量 <code>MSYSTEM</code> 设置为 <code>MINGW64</code> 或 <code>MINGW32</code> ，结果对应为 <code>MinGW64</code> 或 <code>MinGW32</code> 。</li>
<li>否则，若操作系统名为 <code>Win32</code> ：
<ul>
<li>若体系结构为 <code>x86_64</code> ，则结果为 <code>MinGW64</code> 。</li>
<li>否则，结果为 <code>MinGW32</code> 。</li>
</ul>
</li>
<li>否则，结果为操作系统名。</li>
</ul>
<h3 id="函数-shbuild_preparebuild"><a class="header" href="#函数-shbuild_preparebuild">函数 SHBuild_PrepareBuild</a></h3>
<p>　　准备构建环境。初始化以下变量使之具有非空值：</p>
<ul>
<li><code>SHBuild_Env_TempDir</code></li>
<li><code>SHBuild_Env_Arch</code></li>
<li><code>SHBuild_Env_OS</code></li>
<li><code>SHBuild_Host_Arch</code></li>
<li><code>SHBuild_Host_OS</code></li>
</ul>
<h3 id="函数-shbuild_getbuildname"><a class="header" href="#函数-shbuild_getbuildname">函数 SHBuild_GetBuildName</a></h3>
<p>　　取用于进一步初始化构建路径的构建名称。</p>
<p>　　首先断言变量 <code>SHBuild_Env_Arch</code> 和 <code>SHBuild_Env_OS</code> 非空。结果为以变量 <code>SHBuild_Env_OS</code> 和 <code>SHBuild_Env_Arch</code> 的值作为参数调用函数 <code>SHBuild_Platform_Detect</code> 的结果。</p>
<h3 id="函数-shbuild_buildgch"><a class="header" href="#函数-shbuild_buildgch">函数 SHBuild_BuildGCH</a></h3>
<p>　　接受第一个参数指定的路径的头文件安装到第二个参数指定的路径下并使用第三个参数指定的命令行构建 GNU 预编译头。</p>
<h3 id="函数-shbuild_checkpch"><a class="header" href="#函数-shbuild_checkpch">函数 SHBuild_CheckPCH</a></h3>
<p>　　检查是否设置了非空的 <code>SHBuild_NoPCH</code> ，否则调用 <code>SHBuild_BuildGCH</code> 并生成 GNU 风格预编译头文件并设置内部变量 <code>SHBuild_IncPCH</code> 为合适的命令行选项用于包含生成的预编译头文件。</p>
<p>　　支持两个参数，同 <code>SHBuild_BuildGCH</code> 的前两个参数。</p>
<h3 id="函数-shbuild_2w"><a class="header" href="#函数-shbuild_2w">函数 SHBuild_2w</a></h3>
<p>　　接受 1 个表示路径的参数，调用 <code>cygpath</code> 转换 UNIX 路径到 Windows 路径。</p>
<p>　　当 <code>cygpath</code> 不存在时返回原路径。</p>
<h3 id="函数-shbuild_install"><a class="header" href="#函数-shbuild_install">函数 SHBuild_Install</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的文件到后者。</p>
<p>　　首先调用 <code>rsync</code> ，若失败调用 <code>cp</code> 。</p>
<p><strong>注意</strong> 防火墙可能导致 <code>rsync</code> 超时失败。</p>
<h3 id="函数-shbuild_installdir"><a class="header" href="#函数-shbuild_installdir">函数 SHBuild_InstallDir</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的目录到后者。</p>
<p>　　首先调用 <code>rsync</code> ，若失败调用 <code>cp</code> 。</p>
<p><strong>注意</strong> 防火墙可能导致 <code>rsync</code> 超时失败。</p>
<h3 id="函数-shbuild_install_exe"><a class="header" href="#函数-shbuild_install_exe">函数 SHBuild_Install_Exe</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的可执行文件到后者。</p>
<p>　　首先调用 <code>SHBuild_Install</code> ，然后在目标上设置可执行权限。</p>
<h3 id="函数-shbuild_install_hardlink"><a class="header" href="#函数-shbuild_install_hardlink">函数 SHBuild_Install_HardLink</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的文件到后者为硬链接。</p>
<p>　　首先删除目标，其次调用 Windows 命令解释器的 <code>mklink</code> ，若失败调用 <code>ln</code> 。</p>
<h3 id="函数-shbuild_install_hardlink_exe"><a class="header" href="#函数-shbuild_install_hardlink_exe">函数 SHBuild_Install_HardLink_Exe</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的可执行文件到后者为硬链接。</p>
<p>　　首先调用 <code>SHBuild_Install_HardLink</code> ，然后在目标上设置可执行权限。</p>
<p><strong>注意</strong> <code>mklink</code> 需要 Windows Vista 后的命令解释器(<code>cmd</code>) 的支持。硬链接需要文件系统（如 NTFS ）支持。</p>
<h3 id="函数-shbuild_install_link"><a class="header" href="#函数-shbuild_install_link">函数 SHBuild_Install_Link</a></h3>
<p>　　接受 2 个表示路径的参数，安装前者指定的可执行文件到后者为符号链接。</p>
<p>　　首先删除目标，其次调用 Windows 命令解释器的 <code>mklink</code> ，若失败调用 <code>ln</code> 。</p>
<p><strong>注意</strong> <code>mklink</code> 需要 Windows Vista 后的命令解释器(<code>cmd</code>) 的支持。符号链接需要文件系统（如 NTFS ）支持。权限不足可能导致 <code>mklink</code> 创建符号链接失败，可在组策略改变相关默认行为。在一些版本的系统上，可能需要<a href="https://support.microsoft.com/en-us/kb/2856739/en-us">进一步的配置</a>以通过链接执行文件。</p>
<h3 id="函数-shbuild_getsystemprefix"><a class="header" href="#函数-shbuild_getsystemprefix">函数 SHBuild_GetSystemPrefix</a></h3>
<p>　　按参数指定的平台名称字符串返回系统前缀字符串。</p>
<p>　　系统前缀用于在文件系统中安装部署。</p>
<p>　　通常系统前缀因为之前仍有非空的其它前缀（如 <code>SHBuild_SysRoot</code> 指定的值）而不是绝对路径的前缀。因此，系统前缀以 <code>/</code> 起始而不需要考虑所在的环境是否符合 FHS 的问题。</p>
<p>　　当前支持的结果包括：</p>
<ul>
<li>参数为 <code>MinGW64</code> 时，结果为 <code>/mingw64</code> ；</li>
<li>参数为 <code>MinGW32</code> 时，结果为 <code>/mingw32</code> ；</li>
<li>否则，结果为 <code>/usr</code> 。</li>
</ul>
<p>　　本函数的结果符合 <a href="Tools/../Sysroot.zh-CN.html">Sysroot</a> 中关于 Sysroot 的目录布局的约定。</p>
<h3 id="函数-shbuild_s2_prepare"><a class="header" href="#函数-shbuild_s2_prepare">函数 SHBuild_S2_Prepare</a></h3>
<p>　　初始化 <a href="Tools/../sysroot.zh-CN.html">stage 2 Sysroot</a> 环境。</p>
<p>　　函数可使用一个参数作为变量 <code>SHBuild_SysRoot</code> 的默认值。</p>
<p>　　初始化这个变量后，断言其值非空，以其值作为创建目录，若指定的目录已存在则忽略。然后，初始化变量 <code>SHBuild_SystemPrefix</code>（参见 <code>Tools/Scripts/SHBuild-YSLib-build.txt</code> 的说明）。之后，初始化变量 <code>SR_Prefix</code> 的值为 <code>&quot;$SHBuild_SysRoot$SHBuild_SystemPrefix&quot;</code> 。</p>
<h3 id="函数-shbuild_s2_prepare_build"><a class="header" href="#函数-shbuild_s2_prepare_build">函数 SHBuild_S2_Prepare_Build</a></h3>
<p>　　初始化 stage 2 Sysroot 构建环境。</p>
<p>　　函数可使用一个参数。以这个参数调用 <code>SHBuild_S2_Prepare</code> ，然后导出变量 <code>SHBuild</code> 的值为 <code>&quot;$SR_Prefix/bin/SHBuild&quot;</code> 。</p>
<h2 id="toolsscriptsshbuild-common-optionssh"><a class="header" href="#toolsscriptsshbuild-common-optionssh">Tools/Scripts/SHBuild-common-options.sh</a></h2>
<p>　　被应用程序构建脚本包含的基础功能，提供默认的编译器和链接器命令行选项。</p>
<p>　　若某个变量提供默认值且执行脚本时没有非空值，则设置为脚本提供的默认值。</p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>bin</code> 目录下。</p>
<p>　　包含 <code>Tools/Scripts/SHBuild-common-toolchain.sh</code> 确定工具链。</p>
<p><strong>注意</strong> G++ 和 Clang++ 不完全兼容。以下部分变量通过 <code>Tools/Scripts/SHBuild-common-toolchain.sh</code> 中的例程判断 G++ 和 Clang ，并自动使用不同的选项默认值。因此直接通过名称和符号链接等方式伪装会失效而可能导致错误。</p>
<p>　　以下所有变量仅在空（包括未设置）时提供默认值，按顺序被指定。可在外部设置为非空值以避免被本脚本中的值覆盖。以下仅列出部分相对不容易变动的默认值，其它默认值参见脚本源代码。若不需要默认值，可以提前设置非空值或在 <code>.</code> 指令后直接设置其它（可能为空的）值。</p>
<h3 id="变量-shbuild_debug"><a class="header" href="#变量-shbuild_debug">变量 SHBuild_Debug</a></h3>
<p>　　默认为空。</p>
<p>　　非空时，指定变量的值：</p>
<pre><code>CXXFLAGS_OPT_DBG='-O0 -g -D_GLIBCXX_DEBUG_PEDANTIC'
LDFLAGS_OPT_DBG=' '
</code></pre>
<h3 id="变量-c_cxxflags_gc"><a class="header" href="#变量-c_cxxflags_gc">变量 C_CXXFLAGS_GC</a></h3>
<p>　　C/C++ 编译器生成二进制节 GC 选项，默认值为 <code>-fdata-sections -ffunction-sections</code> 。</p>
<p>　　设置后会被检查是否支持，参见下文。</p>
<h3 id="变量-ldflags_gc"><a class="header" href="#变量-ldflags_gc">变量 LDFLAGS_GC</a></h3>
<p>　　链接器生成二进制节 GC 选项，默认值为 <code>-Wl,--gc-sections</code> 。</p>
<p>　　设置后会和 <code>C_CXXFLAGS_GC</code> 通过 <code>$CXX</code> 作为编译器编译链接简单程序测试是否支持。若不支持，此变量和 <code>C_CXXFLAGS_GC</code> 都会被置空。</p>
<p><strong>已知限制</strong> <a href="http://sourceforge.net/p/msys2/discussion/general/thread/2d6adff2/?limit=25">Windows 上的工具链可能缺乏 <code>/dev/null</code> 的必要支持</a>，因此此项检查使用的输出路径指定为 <code>/tmp/null</code> 。</p>
<h3 id="变量-ldflags_strip"><a class="header" href="#变量-ldflags_strip">变量 LDFLAGS_STRIP</a></h3>
<p>　　链接器剥离符号选项，默认值为 <code>-s</code> 。</p>
<h3 id="变量-c_cxxflags_arch"><a class="header" href="#变量-c_cxxflags_arch">变量 C_CXXFLAGS_ARCH</a></h3>
<p>　　C 和 C++ 编译器共用的体系结构相关选项，默认值为空。</p>
<p>　　不限制具体形式，使用 G++ 时可以是 <code>-march=native</code> 。</p>
<h3 id="变量-c_cxxflags_pic"><a class="header" href="#变量-c_cxxflags_pic">变量 C_CXXFLAGS_PIC</a></h3>
<p>　　C 和 C++ 编译器共用的 PIC （ Position Independent Code ，位置无关代码）生成选项，默认值在 Win32 上为空，其它平台上为 <code>-fPIC</code> 。</p>
<p>　　用于保证生成的对象文件可被用于生成动态库。</p>
<h3 id="变量-c_cxxflags_common"><a class="header" href="#变量-c_cxxflags_common">变量 C_CXXFLAGS_COMMON</a></h3>
<p>　　C 和 C++ 编译器共用的公共选项，默认值为 <code>-pipe $C_CXXFLAGS_GC $C_CXXFLAGS_ARCH -pedantic-errors</code> 。</p>
<h3 id="变量-c_cxxflags_opt_lv"><a class="header" href="#变量-c_cxxflags_opt_lv">变量 C_CXXFLAGS_OPT_LV</a></h3>
<p>　　C 和 C++ 编译器优化等级选项，默认值为 <code>-O3</code> 。</p>
<h3 id="变量-c_cxxflags_warning"><a class="header" href="#变量-c_cxxflags_warning">变量 C_CXXFLAGS_WARNING</a></h3>
<p>　　C 和 C++ 编译器共用的警告命令行选项，默认值包括以下列表中的内容：</p>
<ul>
<li><code>-Wall</code></li>
<li><code>-Wcast-align</code></li>
<li><code>-Wdeprecated</code></li>
<li><code>-Wdeprecated-declarations</code></li>
<li><code>-Wextra</code></li>
<li><code>-Wfloat-equal</code></li>
<li><code>-Wformat=2</code></li>
<li><code>-Winvalid-pch</code></li>
<li><code>-Wmissing-declarations</code></li>
<li><code>-Wmissing-include-dirs</code></li>
<li><code>-Wmultichar</code></li>
<li><code>-Wno-format-nonliteral</code></li>
<li><code>-Wredundant-decls</code></li>
<li><code>-Wshadow</code></li>
<li><code>-Wsign-conversion</code></li>
</ul>
<p>　　使用符合项目要求支持的 Clang++ 和 G++ 应支持这些选项。</p>
<h3 id="变量-c_cxxflags_impl_warning"><a class="header" href="#变量-c_cxxflags_impl_warning">变量 C_CXXFLAGS_IMPL_WARNING</a></h3>
<p>　　和特定实现相关的 C 和 C++ 编译器共用的警告命令行选项，默认值包括若干特定实现的选项。</p>
<h3 id="变量-cxxflags_impl_warning"><a class="header" href="#变量-cxxflags_impl_warning">变量 CXXFLAGS_IMPL_WARNING</a></h3>
<p>　　和特定实现相关的 C++ 编译器警告命令行选项，默认值包括若干特定实现的选项。</p>
<h3 id="变量-cxxflags_impl_common"><a class="header" href="#变量-cxxflags_impl_common">变量 CXXFLAGS_IMPL_COMMON</a></h3>
<p>　　和特定实现相关的 C++ 编译器一般命令行选项，默认值包括若干特定实现的选项。</p>
<p>　　默认值按以下方式检查和指定线程参数：</p>
<ul>
<li>通过 <code>-dumpspecs</code> 的内容检查是否匹配 <code>mthreads:</code> 。若成功，编译器和链接器选项添加 <code>-mthreads</code> 。</li>
<li>否则，检查带有 <code>-mthread</code> 选项的构建。若（直接调用编译器驱动）构建通过，则链接器选项添加 <code>-mthreads</code> ，并检查编译。
<ul>
<li>若编译不通过，则编译器选项添加 <code>-D_MT</code> ，否则添加 <code>-mthreads</code> 。</li>
</ul>
</li>
<li>否则，若通过 <code>-dumpspecs</code> 的内容检查匹配 <code>no-pthread:</code> 且带有 <code>-pthread</code> 时无法构建，则保持编译器和链接器选项不变。</li>
<li>否则，编译器和链接器选项添加 <code>-pthread</code> 。 </li>
</ul>
<p><strong>注意</strong> 当前不检查失败原因。参见函数 <code>SHBuild_GetTempDir</code> 的已知限制。</p>
<p>　　当前暂不支持判断其它环境。</p>
<h3 id="变量-cxxflags_impl_opt"><a class="header" href="#变量-cxxflags_impl_opt">变量 CXXFLAGS_IMPL_OPT</a></h3>
<p>　　和特定工具相关的 C++ 编译器优化命令行选项，默认值包括若干特定实现的选项。</p>
<h3 id="变量-cflags_std"><a class="header" href="#变量-cflags_std">变量 CFLAGS_STD</a></h3>
<p>　　指定 C 标准的编译器命令行选项，默认值为 <code>-std=c11</code> 。</p>
<h3 id="变量-cflags_warning"><a class="header" href="#变量-cflags_warning">变量 CFLAGS_WARNING</a></h3>
<p>　　C 编译器警告命令行选项，默认值为 <code>$C_CXXFLAGS_WARNING $C_CXXFLAGS_IMPL_WARNING</code> 。</p>
<h3 id="变量-cxxflags_std"><a class="header" href="#变量-cxxflags_std">变量 CXXFLAGS_STD</a></h3>
<p>　　指定 C++ 标准的编译器命令行选项，默认值为 <code>-std=c++11</code> 。</p>
<h3 id="变量-cflags_warning-1"><a class="header" href="#变量-cflags_warning-1">变量 CFLAGS_WARNING</a></h3>
<p>　　C 编译器警告命令行选项，默认值包含以下列表中的内容：</p>
<ul>
<li>变量 <code>CFLAGS_WARNING</code> 的内容</li>
<li><code>-Wctor-dtor-privacy</code></li>
<li><code>-Wnon-virtual-dtor</code></li>
<li><code>-Woverloaded-virtual</code></li>
<li><code>-Wsign-promo</code></li>
<li>变量 <code>CXXFLAGS_IMPL_WARNING</code> 的内容</li>
</ul>
<h3 id="变量-cxxflags_opt_dbg"><a class="header" href="#变量-cxxflags_opt_dbg">变量 CXXFLAGS_OPT_DBG</a></h3>
<p>　　C++ 编译器优化和调试相关的命令行选项。在未设置非空的 <code>SHbuild_Debug</code> 时，默认值包含以下列表中的内容：</p>
<ul>
<li>变量 <code>C_CXXFLAGS_OPT_LV</code> 的内容</li>
<li>变量 <code>CXXFLAGS_OPT_UseAssert</code> 没有被设置非空值时包含 <code>-NDEBUG</code></li>
<li>变量 <code>CXXFLAGS_IMPL_OPT</code> 的内容</li>
<li><code>-fomit-frame-pointer</code></li>
</ul>
<h3 id="变量-cflags"><a class="header" href="#变量-cflags">变量 CFLAGS</a></h3>
<p>　　C 编译器使用的命令行选项，默认值为 <code>$CFLAGS_STD $C_CXXFLAGS_PIC $C_CXXFLAGS_COMMON $CFLAGS_WARNING $C_CXXFLAGS_COMMON_IMPL_ $CXXFLAGS_OPT_DBG</code> 。其中，<code>C_CXXFLAGS_COMMON_IMPL_</code> 是根据支持的编译器在内部定义的非公开变量。</p>
<p><strong>注意</strong> 当前和 C++ 编译器选项共用 <code>CXXFLAGS_OPT_DBG</code> 。</p>
<h3 id="变量-cxxflags"><a class="header" href="#变量-cxxflags">变量 CXXFLAGS</a></h3>
<p>　　C++ 编译器使用的命令行选项，默认值为 <code>$CXXFLAGS_STD $C_CXXFLAGS_PIC $C_CXXFLAGS_COMMON $CXXFLAGS_WARNING $CXXFLAGS_IMPL_COMMON $C_CXXFLAGS_COMMON_IMPL_ $CXXFLAGS_OPT_DBG</code> 。其中，<code>C_CXXFLAGS_COMMON_IMPL_</code> 是根据支持的编译器在内部定义的非公开变量。</p>
<h3 id="变量-ldflags_opt_dbg"><a class="header" href="#变量-ldflags_opt_dbg">变量 LDFLAGS_OPT_DBG</a></h3>
<p>　　链接器优化和调试相关的命令行选项。在未设置非空的 <code>SHbuild_Debug</code> 时，默认值为 <code>$LDFLAGS_STRIP $LDFLAGS_IMPL_OPT $LDFLAGS_GC</code> 。</p>
<h3 id="变量-ldflags"><a class="header" href="#变量-ldflags">变量 LDFLAGS</a></h3>
<p>　　链接器使用的命令行选项，默认值依次包含以下内容：</p>
<ul>
<li>变量 <code>C_CXXFLAGS_PIC</code> 的内容。</li>
<li>和变量 <code>CXXFLAGS_IMPL_COMMON</code> 中等价的线程命令行选项。</li>
<li>变量 <code>LDFLAGS_OPT_DBG</code> 的内容。</li>
<li>生成可执行程序时且要求按需调整链接器参数时，附加的值：
<ul>
<li>当需要生成 Win32 子系统程序时，附加 <code>-mwindows</code> 。</li>
</ul>
</li>
<li>动态可执行程序时，变量 <code>LIBS_RPATH</code> 的内容。</li>
<li>动态链接库时，变量 <code>LDFLAGS_DYN</code> 的内容。</li>
</ul>
<p>　　默认使用 <code>-Wl,</code> 传递链接器特定的命令行。</p>
<h2 id="toolsscriptsshbuild-common-toolchainsh"><a class="header" href="#toolsscriptsshbuild-common-toolchainsh">Tools/Scripts/SHBuild-common-toolchain.sh</a></h2>
<p>　　被应用程序构建脚本包含的基础功能，提供默认的编译器和链接器等工具的名称。</p>
<p>　　支持 GCC/G++ 和 Clang/Clang++ 。</p>
<p>　　支持 <code>ar</code> 及与其兼容的工具 <code>gcc-ar</code>/<code>llvm-ar</code> 的自动检测。对 Clang++ 和 G++ ，分别使用 <code>llvm-ar</code> 和 <code>gcc-ar</code> 。</p>
<p>　　以下可在环境外部配置，在值确定后被导出：</p>
<ul>
<li><code>CC</code>
<ul>
<li>默认值为 <code>gcc</code> 。</li>
</ul>
</li>
<li><code>CXX</code>
<ul>
<li>默认值为 <code>g++</code> 。</li>
</ul>
</li>
<li><code>AR</code>
<ul>
<li>默认值为变量 <code>CXX</code> 指定的 C++ 编译器确定的自动检测结果；若非 Clang++ 和 G++ ，则使用 <code>ar</code> 。</li>
</ul>
</li>
<li><code>ARFLAGS</code>
<ul>
<li>默认值为 <code>rcs</code> 。</li>
</ul>
</li>
<li><code>LD</code>
<ul>
<li>默认值为变量 <code>CXX</code> 的值。</li>
</ul>
</li>
</ul>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>bin</code> 目录下。</p>
<h3 id="函数-shbuild_checkcompiler"><a class="header" href="#函数-shbuild_checkcompiler">函数 SHBuild_CheckCompiler</a></h3>
<p>　　尝试调用以参数指定的编译器，并按检查结果选择和输出参数的值。</p>
<p>　　检查编译器时，首先排除参数指定的编译器不可执行的情形，然后通过尝试编译以参数指定的源程序进行。前四参数分别指定编译器的路径、尝试编译的源程序、检查成功时输出的结果和检查失败时输出的结果，之后的参数指定编译选项。</p>
<p>　　检查前断言前两个参数非空。指定编译选项的参数为空时，第三和第四参数可能不提供或为空。</p>
<p>　　结果是以下之一：</p>
<ul>
<li>空值（第一参数指定不可执行的路径）</li>
<li>第三参数（检查成功时的结果）</li>
<li>第四参数（检查失败时的结果）</li>
</ul>
<h3 id="函数-shbuild_checkcc"><a class="header" href="#函数-shbuild_checkcc">函数 SHBuild_CheckCC</a></h3>
<p>　　尝试调用参数指定的编译器以检查 C 编译器风格。结果是以下之一：</p>
<ul>
<li>空值（不支持的编译器）</li>
<li><code>Clang</code></li>
<li><code>GCC</code></li>
</ul>
<h3 id="函数-shbuild_checkcxx"><a class="header" href="#函数-shbuild_checkcxx">函数 SHBuild_CheckCXX</a></h3>
<p>　　尝试调用参数指定的编译器以检查 C++ 编译器风格。结果是以下之一：</p>
<ul>
<li>空值（不支持的编译器）</li>
<li><code>Clang++</code></li>
<li><code>G++</code></li>
</ul>
<h2 id="toolsscriptsshbuild-self-hostsh"><a class="header" href="#toolsscriptsshbuild-self-hostsh">Tools/Scripts/SHBuild-self-host.sh</a></h2>
<p>　　<a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 自举测试用脚本。</p>
<p>　　使用 SHBuild 编译并静态链接构建 SHBuild 。和 stage 1 SHBuild 类似，直接使用 YSLib 源文件。</p>
<h2 id="toolsscriptsshbuild-self-host-dllsh"><a class="header" href="#toolsscriptsshbuild-self-host-dllsh">Tools/Scripts/SHBuild-self-host-DLL.sh</a></h2>
<p>　　<a href="Tools/SHBuild.zh-CN.html">SHBuild</a> 自举测试用脚本。</p>
<p>　　使用 SHBuild 编译并动态链接构建 SHBuild 。依赖 <code>/usr/lib</code> 中存在的 YFramework.dll 和 YBase.dll 。</p>
<h2 id="toolsscriptsshbuild-yslibsh"><a class="header" href="#toolsscriptsshbuild-yslibsh">Tools/Scripts/SHBuild-YSLib.sh</a></h2>
<p>　　作为 stage 1 SHBuild 公共配置脚本被不同的 stage 1 构建脚本包含。</p>
<p>　　包含脚本依次执行：</p>
<ul>
<li>初始化变量 <a href="Tools/../Development.zh-CN.html"><code>SHBuild_ToolDir</code></a> 。 </li>
<li>初始化变量 <a href="Tools/../Development.zh-CN.html"><code>YSLib_BaseDir</code></a> 。</li>
<li>初始化变量 <code>SHBuild_PCH_stdinc_h</code> 。</li>
<li>包含脚本 Tools/Scripts/SHBuild-common-options.sh 。</li>
<li>赋值变量 <code>INCLUDE_PCH</code> 为版本库的 YBase/include/stdinc.h 。</li>
<li>赋值变量 <code>INCLUDES</code> 为版本库目录下的适合作为编译器选项使用的头文件目录列表。</li>
<li>定义函数。</li>
</ul>
<p><strong>注意</strong> 这个脚本包含 <code>INC_SHBuild_YSLib</code> 守卫变量检查，默认重复包含只被执行一次。</p>
<h3 id="变量-shbuild_pch_stdinc_h"><a class="header" href="#变量-shbuild_pch_stdinc_h">变量 SHBuild_PCH_stdinc_h</a></h3>
<p>　　预编译头文件名称，默认为 &quot;<code>stdinc.h</code>&quot; 。</p>
<h3 id="函数-shbuild_s1_initializepch"><a class="header" href="#函数-shbuild_s1_initializepch">函数 SHBuild_S1_InitializePCH</a></h3>
<p>　　初始化 stage 1 使用的预编译头文件。</p>
<pre><code>SHBuild_CheckPCH &quot;$INCLUDE_PCH&quot; &quot;$SHBuild_PCH_stdinc_h&quot;
</code></pre>
<h2 id="toolsscriptsshbuild-yslibtxt"><a class="header" href="#toolsscriptsshbuild-yslibtxt">Tools/Scripts/SHBuild-YSLib*.txt</a></h2>
<p>　　构建 YSLib 用的 NPLA1 脚本，包含以下文件：</p>
<ul>
<li>Tools/Scripts/SHBuild-YSLib-common.txt ：被 <code>Tools/Scripts/SHBuild-YSLib-build.txt</code> 加载的 NPLA1 脚本。</li>
<li>Tools/Scripts/SHBuild-YSLib-build.txt ：使用 SHBuild 构建 debug 或 release 配置的 YBase 和 YFramework 库的 NPLA1 脚本，被 <code>Tools/install-sysroot.sh</code> 调用，其中 SHBuild 默认为 stage 1 SHBuild 。</li>
</ul>
<p>　　调用方式详见 <a href="Tools/SHBuild.zh-CN.html">stage 1 SHBuild 中关于 NPL 支持的说明</a>。</p>
<p>　　可通过外部环境变量配置脚本行为。</p>
<h3 id="toolsscriptsshbuild-yslib-commontxt"><a class="header" href="#toolsscriptsshbuild-yslib-commontxt">Tools/Scripts/SHBuild-YSLib-common.txt</a></h3>
<p>　　<code>Tools/Scripts/SHBuild-YSLib-common.txt</code> 包含一些公共的库，包括支持类似 <code>Tools/Scripts/SHBuild-common-options.sh</code> 和 <code>Tools/Scripts/SHBuild-common-toolchain.sh</code> 的选项以环境变量的方式配置，但 C 编译器相关的选项除外（不使用而被忽略）。</p>
<p>　　除<a href="Tools/../Development.zh-CN.html">关于 shell 和 NPLA1 脚本之间的一般差异</a>外，和 <code>Tools/Scripts/SHBuild-common-options.sh</code> 和 <code>Tools/Scripts/SHBuild-common-toolchain.sh</code> 的不同为：</p>
<ul>
<li>通过调用函数进入<strong>构建环境变量检测</strong>并在之后进入回调函数中构建。
<ul>
<li>按需初始化变量。构建环境变量检测可能延迟访问以避免不必要初始化的值。配置时为确定变量的默认值的检查的调用顺序可能不同。</li>
<li>使用 debug 模式时，<code>CXXFLAGS_OPT_DBG</code> 设置为 <code>-O0 -g -D_GLIBCXX_DEBUG_PEDANTIC</code> ，不再被环境变量覆盖。</li>
<li>生成变量默认值的选项之间的空白符可能不同（通常可确保为一个空格）。</li>
<li>附加支持构建应用的配置，在导出的 <code>LDFLAGS</code> 的值中添加 <code>LIBS_RPATH</code>（参见以下相关说明）的值。</li>
<li>附加检查 <a href="https://github.com/google/sanitizers/wiki">sanitizer</a> （参见以下相关章节的说明）。</li>
</ul>
</li>
<li>支持更多变量和默认值。除非另行指定，这些变量在构建环境变量检测中使用。参见以下各节。</li>
<li>提供部分和 shell 脚本不同的函数，详见版本库中的 <code>doc/NPL.txt</code> 。</li>
</ul>
<p>　　这个脚本被 <code>Tools/Scripts/SHBuild-YSLib-build.txt</code> 加载，并被 <code>Tools/install-sysroot.sh</code> 间接调用。</p>
<p>　　脚本支持外部调用这个脚本的命令行设置变量的默认值，以覆盖直接指定构建环境变量检测确定的选项，如：</p>
<pre><code>CXX=clang++ CXXFLAGS='-std=c++11 -O2' Tools/install-sysroot.sh
</code></pre>
<p>　　<strong>使用预编译头选项和缺陷同 <code>Tools/Scripts/SHBuild-build.sh</code> 。其中的特性未指定使用 shell 实现，和后者可能存在 shell 环境中可见的差异。</strong></p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>var/NPLA1</code> 目录下。</p>
<h3 id="变量-ldflags_dyn_base"><a class="header" href="#变量-ldflags_dyn_base">变量 LDFLAGS_DYN_BASE</a></h3>
<p>　　指定动态库基础链接选项，默认值和平台相关：若为 Win32 环境则使用 <code>-shared -Wl,--dll</code> 否则为 <code>-shared</code> 。</p>
<h3 id="变量-ldflags_dyn_extra"><a class="header" href="#变量-ldflags_dyn_extra">变量 LDFLAGS_DYN_EXTRA</a></h3>
<p>　　指定动态库附加链接选项，默认值等价于 <code>-Wl,--no-undefined,--dynamic-list-data,--dynamic-list-cpp-new,--dynamic-list-cpp-typeinfo</code> 。</p>
<h3 id="变量-ldflags_dyn"><a class="header" href="#变量-ldflags_dyn">变量 LDFLAGS_DYN</a></h3>
<p>　　指定动态库链接选项，默认值为 <code>$LDFLAGS_DYN_EXTRA $LDFLAGS_DYN</code> 。</p>
<h3 id="变量-libs_rpath"><a class="header" href="#变量-libs_rpath">变量 LIBS_RPATH</a></h3>
<p>　　用于指定在运行时 ELF 映像需要的动态库的路径的链接器选项。在 Win32 默认不设置，其它平台默认值为 <code>-Wl,-rpath,'\$ORIGIN:\$ORIGIN/../lib'</code> 。</p>
<h3 id="变量-libpfx"><a class="header" href="#变量-libpfx">变量 LIBPFX</a></h3>
<p>　　库前缀。在 Win32 默认不设置，其它平台默认值为 <code>lib</code> 。</p>
<h3 id="变量-dsosfx"><a class="header" href="#变量-dsosfx">变量 DSOSFX</a></h3>
<p>　　动态库文件名后缀。在 Win32 默认为 <code>.dll</code> ，其它平台默认值为 <code>.so</code> 。</p>
<h3 id="变量-exesfx"><a class="header" href="#变量-exesfx">变量 EXESFX</a></h3>
<p>　　可执行文件名后缀。在 Win32 默认为 <code>.exe</code> ，其它平台默认不设置。</p>
<h3 id="sanitizer-检查支持"><a class="header" href="#sanitizer-检查支持">Sanitizer 检查支持</a></h3>
<p>　　构建环境变量检测支持 sanitizer ：若在变量 <code>CFLAGS</code>、<code>CXXFLAGS</code>、<code>LDFLAGS</code> 或 <code>SHBuild_CXXFLAGS</code> 中包含启用被支持的 sanitizer 的选项 （以 <code>-fsanitizer=address</code> 起始），配置最终在 <code>CFLAGS</code>、<code>CXXFLAGS</code> 和 <code>LDFLAGS</code> 最后添加自动调整的选项。</p>
<p>　　构建配置支持 ASan、 TSan、 MSan、 UBSan 和 LSan 。Sanitizer 自身支持的系统和编译器详见 sanitizer 的文档。</p>
<p>　　ASan 使用的选项要求和建议参见 <a href="https://github.com/google/sanitizers/wiki/AddressSanitizer#faq">FAQ</a> 。</p>
<p><strong>注意</strong> <a href="https://gcc.gnu.org/legacy-ml/gcc/2014-10/msg00006.html">GCC 不支持 MSan</a> 。 MSan 要求标准库<a href="https://github.com/google/sanitizers/wiki/MemorySanitizerLibcxxHowTo">使用带 MSan 的选项构建</a>，否则<a href="https://github.com/google/sanitizers/issues/542">会有假阳性结果</a>。</p>
<p><strong>注意</strong> 具体调整的选项参见脚本具体实现，不保持构建版本之间稳定。* <strong>注意</strong> 构建脚本不保证构建的二进制程序的具体可用性。构建的程序可能因为程序及 sanitizer 实现的缺陷运行时出错，可能另需具体排查原因修复。</p>
<h3 id="shbuild-附加构建选项环境变量"><a class="header" href="#shbuild-附加构建选项环境变量">SHBuild 附加构建选项环境变量</a></h3>
<p>　　若回调函数中调用 SHBuild 构建，可在此之前设置<strong>扩展环境变量</strong>并调用函数 <code>SHBuild_Extend_CallVariables</code> 以更新被 SHBuild 使用的环境变量 <code>LDFLAGS</code> 和 <code>LIBS</code> 的值。这些影响 SHBuild 工具调用构建工具的命令行的 <strong>SHBuild 附加构建选项环境变量</strong>，包括：</p>
<ul>
<li><code>SHBuild_CFLAGS</code></li>
<li><code>SHBuild_CXXFLAGS</code></li>
<li><code>SHBuild_LDFLAGS</code></li>
<li><code>SHBuild_LIBS</code></li>
</ul>
<p>　　除非另行指定，SHBuild 附加构建选项环境变量的默认值为空，不被脚本设置。</p>
<h3 id="其它函数和可在外部设置的其它变量"><a class="header" href="#其它函数和可在外部设置的其它变量">其它函数和可在外部设置的其它变量</a></h3>
<p>　　详见版本库中的 <code>doc/NPL.txt</code> 。</p>
<p>　　其它变量不被构建环境变量检测访问，而通过函数调用生效，如 <code>SHBuild_Extend_CallVariables</code> 。</p>
<h2 id="toolsscriptsshbuild-yslib-buildtxt"><a class="header" href="#toolsscriptsshbuild-yslib-buildtxt">Tools/Scripts/SHBuild-YSLib-build.txt</a></h2>
<p>　　这个脚本当前包括和安装相关的流程，实现 <code>Tools/install-sysroot.sh</code> 在 stage 1 SHBuild 构建后的主要逻辑。</p>
<p>　　脚本使用 <code>Tools/Scripts/SHBuild-YSLib-common.txt</code> 中提供的一些函数。</p>
<p>　　脚本支持 <code>SHBuild_</code> 为前缀的环境变量指定构建和部署目标：</p>
<ul>
<li><code>SHBuild_UseDebug</code> 非空时启用构建和安装 debug 配置的库。</li>
<li><code>SHBuild_UseRelease</code> 非空时启用构建和安装 release 配置的库。</li>
<li><code>SHBuild_NoStatic</code> 非空时跳过静态库构建。</li>
<li><code>SHBuild_NoDynamic</code> 非空时跳过动态库构建。</li>
<li><code>SHBuild_No3rd</code> 非空时跳过第三方库安装。
<ul>
<li>对<a href="Tools/../Development.zh-CN.html">外部依赖项</a>中的库，只安装启用的配置决定的必要的外部依赖。启用的配置由 <code>SHBuild_UseDebug</code> 和 <code>SHBuild_UseRelease</code> 指定。</li>
</ul>
</li>
<li><code>SHBuild_NoDev</code> 非空时跳过可选的开发工具构建和安装。</li>
<li><code>SHBuild_Rebuild_S1</code> 非空时跳过文件存在性检查，总是重新构建 stage 1 SHBuild 。</li>
<li><code>SHBuild_NoDev</code> 非空时跳过 stage 2 SHBuild 后的开发工具构建和安装。</li>
</ul>
<p>　　以下配置行为的环境变量（其中 <code>SS</code> 表示 SHBuild Settings ）被支持：</p>
<ul>
<li><code>SS_DebugEnv</code> 值非空时启用脚本执行时系统环境相关的调试输出，当前包括：
<ul>
<li>对环境变量修改时输出修改的变量名和对应的值。</li>
</ul>
</li>
<li><code>SS_Verbose</code> 值非空时启用详细消息输出，当前包括：
<ul>
<li>在 <code>LDFLAGS</code> 变量中附加 <code>-mwindows</code> 时提示。</li>
</ul>
</li>
</ul>
<p>　　以下构建时的中间变量可被外部配置，当外部没有配置或为空值时使用默认值：</p>
<ul>
<li><code>SHBuild_SystemPrefix</code> ：系统前缀，在 Sysroot 根路径下决定安装路径。
<ul>
<li>默认值由脚本 <code>Tools/Scripts/SHBuild-YSLib-common.txt</code> 中的函数的调用确定：同 <code>SHBuild_GetSystemPrefix (SHBuild_Platform_Detect SHBuild_Host_OS SHBuild_Host_Arch)</code> 的结果。</li>
<li>脚本 <code>Tools/Scripts/SHBuild-common.sh</code> 中提供 shell 脚本的等价调用：<code>$(SHBuild_GetSystemPrefix (SHBuild_Platform_Detect &quot;$SHBuild_Host_OS&quot; &quot;$SHBuild_Host_Arch&quot;))</code> 。</li>
</ul>
</li>
<li><code>SHBuild_YF_Libs_freetype</code> ：freetype 库链接参数。
<ul>
<li>默认值为 <code>-lfreetype</code> 或 <code>pkg-config --libs freetype2</code> 的输出结果。
<ul>
<li>其中存在 Sysroot <code>libfreetype.a</code> 时默认值为前者。</li>
</ul>
</li>
</ul>
</li>
<li><code>SHBuild_YF_Libs_FreeImage</code> ：FreeImage 库链接参数。
<ul>
<li>默认值为 <code>-lFreeImaged</code> 或 <code>-lFreeImage</code> ，对应 debug 和非 debug 配置。</li>
</ul>
</li>
</ul>
<p>　　<code>Tools/Scripts/SHBuild-YSLib-build.txt</code> 也可能使用其它变量用于传递参数给被调用的命令，包括一些 <code>SHBuild</code> 预期的变量；后者作为公开接口，但<strong>其具体含义和使用不保证在不同版本间稳定</strong>。</p>
<p>　　在 stage 1 构建时，接受以下环境变量：</p>
<ul>
<li><code>INCLUDES_freetype</code> 指定覆盖包含路径的编译器命令行选项，默认值以 <code>-I</code> 起始，使用版本库目录下的 <code>3rdparty/freetype/include</code> 目录带有适当引号的完整路径。</li>
</ul>
<p>　　在 stage 2 构建时接受以下外部环境变量（部分被 SHBuild 直接以环境变量的方式接受）：</p>
<ul>
<li><code>INCLUDES</code> ：包含路径，和非 SHBuild 中的 <code>Makefile</code> 惯用法含义类似。</li>
<li><code>LDFLAGS</code> ：链接命令行选项。</li>
<li><code>LIBS</code> ：作为命令行选项的链接时使用的库路径。</li>
<li><code>LIBS_RPATH</code> ：非 Windows 平台使用的 <code>rpath</code> 路径。</li>
<li>SHBuild 附加构建选项环境变量：参见 Tools/Scripts/SHBuild-YSLib-common.txt 。其中变量 <code>SHBuild_CXXFLAGS</code> 同时作用在预编译头构建。</li>
</ul>
<h2 id="toolsscriptsshbuild-buildapptxt"><a class="header" href="#toolsscriptsshbuild-buildapptxt">Tools/Scripts/SHBuild-BuildApp.txt</a></h2>
<p>　　NPLA1 应用程序构建脚本。可利用此工具脚本调用 SHBuild 构建特定<em>配置(configuration)</em> 下使用 YSLib 库和基础环境开发的应用程序。</p>
<p>　　<strong>这个脚本是公开的工具</strong>，被 <code>Tools/install-sysroot.sh</code> 部署到安装路径下的 <code>var/NPLA1</code> 目录下。</p>
<h3 id="基本原理"><a class="header" href="#基本原理">基本原理</a></h3>
<p>　　<strong>配置</strong>是特定用途的一组程序输出的集合。常见软件配置可以区分目标平台，是否为调试配置等。</p>
<p>　　脚本通过设置特定的环境变量并调用 SHBuild 递归扫描指定目录完成构建。其中调用命令由环境变量 <code>SHBuild</code> 指定。若变量 <code>SHBuild</code> 为空，则假定使用脚本程序在 Sysroot 中，由 Sysroot 的布局确定的 SHBuild 的位置作为变量 <code>SHBuild</code> 的默认值。</p>
<p>　　脚本支持区分 debug 和非 debug 配置以及静态和 DLL 配置。详见以下说明。</p>
<p>　　debug 配置总称 debug 模式。非 debug 配置总称 release 模式。</p>
<h3 id="调用方式"><a class="header" href="#调用方式">调用方式</a></h3>
<p>　　无参数调用时，显示帮助文本。以第一参数指定<strong>配置名称</strong>，执行脚本直接一次性配置后构建。之后可选的其它参数被脚本传递给 SHBuild ，详见以下的操作说明。</p>
<h3 id="使用须知"><a class="header" href="#使用须知">使用须知</a></h3>
<p>　　脚本依赖 Sysroot 。</p>
<p>　　这个脚本被 <code>Tools/Scripts/SHBuild-BuildPkg.sh</code> 调用。</p>
<p>　　当前只支持构建，不支持部署。</p>
<p>　　构建时调用的工具链命令行及配置详见 <code>Tools/Scripts/SHBuild-YSLib-common.txt</code> 的说明。</p>
<p>　　需要先确保源代码可访问。<strong>注意</strong>源代码目录会被递归扫描，建议在目录中只包含所有需要构建的源文件或被包含的文件。</p>
<h3 id="操作说明"><a class="header" href="#操作说明">操作说明</a></h3>
<p>　　一般步骤：</p>
<ul>
<li>新建一个 GNU bash 脚本（以下称为<em>用户构建脚本</em> ），调用此脚本（若无法在 <code>PATH</code> 找到，需要使用完整路径）。</li>
<li>以源代码所在目录的路径作为参数，执行通过此脚本包含的 <code>SHBuild_BuildApp</code> 函数，等待构建完成。</li>
<li>直接包含后的脚本仍可使用无参数调用用户构建脚本查看选项和说明。</li>
</ul>
<p>　　简化操作：也可以不创建用户构建脚本，直接在命令行中执行，例子见<a href="Tools/../GettingStarted.zh-CN.html">入门</a>。</p>
<p>　　若有必要，在调用本脚本之前设置 <code>SHBuild_BuildDir</code> 变量为指定输出文件所在的目录的完整路径，如：</p>
<pre><code>export SHBuild_BuildDir=$(dirname &quot;$0&quot;`/../build)
</code></pre>
<p>　　上述命令行指定相对于用户构建脚本上一层目录的 <code>build</code> 子目录下作为基准输出路径。若不显式设置此变量，工具脚本会指定其默认值为用户构建脚本所在的目录。</p>
<p>　　调用本脚本。脚本会自动加入必要的参数调用 SHBuild ，传递的参数依次具体如下：</p>
<ul>
<li>中间变量 <code>SHBOPT</code> 的值，包括根据配置决定的目录设置选项、 <code>-xid,include -xmode,2</code> 以及用户在脚本命令行指定的剩余选项 <code>SHBOPT_BASE</code> 。</li>
<li>传递给本脚本的配置名称以外的可选参数。</li>
<li><code>SHBuild_BuildApp</code> 的值，用于编译器的库配置（包含路径以及使用 DLL 需要的宏定义 <code>-DYF_DLL -DYB_DLL</code> ），由脚本根据静态或动态库配置自动确定，无需重复输入类似选项。</li>
</ul>
<p><strong>特别注意</strong> 脚本执行<strong>以输出基准路径作为当前工作目录</strong>，需要以此为基准指定源文件路径（ <code>SHBuild</code> 使用的 <code>SRCPATH</code> 参数）。</p>
<p>　　通过脚本命令行间接传递给 <code>SHBuild</code> 的参数 <code>SHBOPT_BASE</code> 以及函数 <code>SHBuild_BuildApp</code> 的参数都可以进一步对构建过程进行调整，如 <code>-xj,2</code> 指定 2 个并行线程构建。</p>
<p><strong>注意</strong> 以 SHBuild 作为 NPLA1 脚本解释器时，传递的参数可能会被 SHBuild 截获，而不被继续传递给 脚本中调用的 SHBuild 。为避免这种情形，在 <code>-xcmd,RunNPLFile</code> 和本的脚本文件名选项后，可加上 <code>--</code> 分隔其余命令行参数。</p>
<h3 id="配置设置"><a class="header" href="#配置设置">配置设置</a></h3>
<p>　　传递给 SHBuild 指定使用 <code>.配置名称</code> 相对路径（无需另外指定 <code>-xd,</code> 参数）。如 <code>-cdebug</code> 指定输出路径为 <code>.debug</code> 。省略此项默认配置名为 <code>shbuild</code> 。</p>
<p>　　脚本根据以下规则自动检测配置：</p>
<ul>
<li>若配置名称以 <code>debug</code> 起始，或环境变量的 <code>SHBuild_Debug</code> 值非空，则视为使用 debug 配置。</li>
<li>若配置名称以 <code>static</code> 结束，活环境变量 <code>SHBuild_Static</code> 的值非空，则视为使用 static 配置。</li>
</ul>
<h3 id="环境变量-2"><a class="header" href="#环境变量-2">环境变量</a></h3>
<p>　　环境变量 <code>SHBuild_Debug</code> 和 <code>SHBuild_Static</code> 可按上述自动检测配置过程指定配置类型。</p>
<p>　　默认情况下， release 配置会在链接器命令行加入 <code>-mwindows</code> ，<a href="Tools/../Prerequisitions.zh-CN.html">和 debug 配置编译的程序行为不保证相同</a>。设置非空变量 <code>SHBuild_NoAdjustSubsystem</code> 禁用此行为。</p>
<p>　　脚本使用包含 YSLib 库的编译器命令行。脚本已经导出了用于链接器的包含使用 YSLib 库命令行参数的变量 <code>LDFLAGS</code> 和 <code>LIBS</code> 。若有必要，可设置 SHBuild 附加构建选项环境变量（参见 Tools/Scripts/SHBuild-YSLib-common.txt ）。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="准备-6"><a class="header" href="#准备-6">准备</a></h1>
<p>　　在开始教程前，掌握以下知识：</p>
<ul>
<li><a href="GettingStarted.zh-CN.html">入门</a></li>
</ul>
<p>　　并对以下内容有基本了解：</p>
<ul>
<li><a href="Development.zh-CN.html">开发说明</a></li>
</ul>
<h1 id="内容目录"><a class="header" href="#内容目录">内容目录</a></h1>
<ul>
<li><a href="Tutorial/Overview.zh-CN.html">综述</a></li>
<li><a href="Tutorial/GUI.zh-CN.html">GUI 应用开发</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="基础约定"><a class="header" href="#基础约定">基础约定</a></h1>
<h2 id="关于头文件的补充说明"><a class="header" href="#关于头文件的补充说明">关于头文件的补充说明</a></h2>
<p>　　在<a href="Tutorial/GettingStarted.zh-CN.html">入门</a>中已经解释了头文件宏的使用。</p>
<p>　　公开的头文件宏的命名是模块路径的直接应用：替换 <code>::</code> 为 <code>_</code> ，加上前缀 <code>YFM_</code> 或 <code>YFM_平台名</code> 。</p>
<p>　　这些宏名直接定义在各个 <code>include</code> 目录的 <code>YModules.h</code> 中。而头文件 <code>&lt;YSBuild.h&gt;</code> 则包含了一系列的 <code>YModules.h</code> 和其它模块的头文件，因此可以直接包含它来简化使用。</p>
<h2 id="命名空间"><a class="header" href="#命名空间">命名空间</a></h2>
<p>　　YSLib 中不同的次级子项目引入不同的命名空间。</p>
<p>　　关于每个顶级子项目下不同的命名空间参见 <code>doc/YBase.txt</code> 和 <code>doc/YFramework.txt</code> 以及 Doxygen 生成的文档。 </p>
<p>　　<strong>在以下讨论中，若没有特别说明，所有非宏名的标识符都在 <code>namespace YSLib</code> 中。</strong></p>
<p>　　注意避免命名空间使用冲突。除非是在一个很有限的块作用域内，一般而言， <code>using namespace std;</code> 总是不被推荐的，但 <code>using namespace YSLib;</code> 在<strong>非头文件</strong>中则是被允许的。</p>
<p>　　在 YSLib 的头文件中，无论是 <code>using</code> 声明还是 <code>using</code> 指令或是命名空间别名，都是经过<strong>慎重考虑</strong>的，特别是为了实现平台中立的兼容。</p>
<ul>
<li>如 YCLib::Mutex 模块支持标准库的对应接口，即使语言的实现如 libstdc++ 在单线程平台上不提供支持，也通过回退到 YBase::PseudoMutex 而允许不改动用户代码并直接保证空行为。允许不改动用户代码的性质可通过 <code>using namespace platform::Concurrency</code> 实现。</li>
</ul>
<p>　　所有其它不经意的在头文件中使用都应被避免。</p>
<h2 id="标识符命名"><a class="header" href="#标识符命名">标识符命名</a></h2>
<p>因为无法完全避免使用不同风格命名的外部依赖， YSLib 强调区分命名的来源而不是使用单一命名风格。</p>
<p>YBase 使用和 ISO C++ 标准库相容的风格。 YFramework 则约定使用框架名称，其中可能包含一些前缀，如 <code>I</code> 表示只有抽象方法的类（接口类）， <code>G</code> 表示用于泛型（与元编程目的相区别）的类模板的名称等。</p>
<p>详细的命名规约参见 <code>doc/CommonRules.txt</code> 和 <code>doc/YFramework.txt</code> 。</p>
<h1 id="yslib-应用程序基本模型"><a class="header" href="#yslib-应用程序基本模型">YSLib 应用程序基本模型</a></h1>
<h2 id="程序的启动运行和终止"><a class="header" href="#程序的启动运行和终止">程序的启动、运行和终止</a></h2>
<p>　　启动一个应用一般可以分为两个部分：创建内容；让内容被显示。 YSLib 对此提供了整体性的便利解决方案。以下说明以典型的 GUI 程序为例（非 GUI 程序实际上不必要使用特别的支持）。</p>
<p>　　Helper::GUIApplication 模块提供的 <code>GUIApplication</code> 类的单例对象初始化中集成了 GUI 程序必要的初始化。之后，可以部署必要的操作，例如决定哪些内容被初始地呈现。程序通过 Helper::GUIApplication 提供的函数 <code>Execute</code> 调用被封装的<strong>消息循环(message loop)</strong> ，接受用户输入并按需响应。最后，当特定条件被满足时，退出 <code>Execute</code> 函数，程序结束。</p>
<h2 id="消息循环消息和消息队列"><a class="header" href="#消息循环消息和消息队列">消息循环、消息和消息队列</a></h2>
<p>　　消息循环，或称<strong>事件循环(event loop)</strong> ，是交互式应用的典型实现方式。程序通过处理(handling) 不同的<strong>消息(message)</strong> 完成期望的行为。除了少数特殊消息（例如表示“退出”以结束程序的消息），消息循环自身通常不能决定如何处理一个消息，因此需要<strong>分发(dispatching)</strong> 到用户提供程序中。</p>
<p>　　基本的消息循环的是一个<strong>轮询(polling)</strong> 操作，一次循环尝试确定一个需要被处理的消息。所有被处理的消息储存于<strong>消息队列(message queue)</strong> 内。当消息循环从消息队列取得消息时，通常即在队列中删除此消息。适当的操作产生消息发送至消息队列内以待处理。这种机制能让消息之间具有一定的顺序保证。但要注意，为了满足调度的需要，此处的队列并不一定需要是严格先进先出的。 YSLib 使用模块 YSLib::Core::YMessage 提供的 <code>Messaging::Message</code> 类表示消息， <code>Messaging::MessageQueue</code> 类表示支持优先级的消息队列。</p>
<p>　　当没有消息需要被处理时即进入<strong>空闲(idle)</strong> 状态，库需要保证消息循环不被立刻终止，可以采取如下操作：</p>
<ul>
<li>发送特定的空闲消息并立即处理。</li>
<li>当可能有其它机制发送消息至消息队列时，放弃处理器资源以便节约能源或（在多任务环境中）使其它程序被调度，预定等待一定时间后再次轮询。</li>
<li>结合以上操作。</li>
</ul>
<p>　　交互式程序中，用户动作和其它外部输入可以被抽象为一个消息。输入消息包含必要的状态数据。用户程序指定此处的响应逻辑，更新特定应用的状态，绘制屏幕图形等。由于一个 GUI 程序在此需要完成的任务具有典型性，可以在更高层次上加以抽象，不一定需要直接控制消息循环。但了解消息循环仍然是必要的。</p>
<h2 id="shell"><a class="header" href="#shell">Shell</a></h2>
<p>　　YSLib 提供称为 Shell 的抽象使交互式程序易于被分隔为不同的实现。每个 Shell 类可以通过覆盖的虚函数 OnGotMessage 提供响应不同的消息一整套逻辑。</p>
<h1 id="进一步阅读-2"><a class="header" href="#进一步阅读-2">进一步阅读</a></h1>
<ul>
<li><a href="Tutorial/GUI.zh-CN.html">GUI 应用开发</a></li>
<li><a href="Tutorial/Configuration.zh-CN.html">程序配置</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="图形支持"><a class="header" href="#图形支持">图形支持</a></h1>
<p>　　YSLib 现阶段不强调图形学功能。作为 GUI 的基础， YSLib 主要在命名空间 <code>Drawing</code> 内提供以下两类图形接口：</p>
<ul>
<li>在 YSLib::Core::YGDIBase 描述图形的位置、大小等几何属性的对象 <code>Point</code> 、 <code>Size</code> 和 <code>Rect</code> 。</li>
<li>在 YSLib::Service 中提供简单图形和字形的光栅化、像素操作和块传输等绘制功能。</li>
</ul>
<p>　　在了解 YSLib 开发时会少量涉及上述的第一类接口，需要了解其意义和简单的用法。进一步描述详见接口文档。</p>
<h2 id="标量类型"><a class="header" href="#标量类型">标量类型</a></h2>
<p>　　YSLib 默认使用整数坐标。表示屏幕坐标位置的有符号数类型 <code>SPos</code> 和大小的无符号数类型 <code>SDst</code> 的范围和平台相关，由 YCLib 提供，一般保证至少 16 位，但应避免依赖其具体范围。</p>
<h2 id="类模板和类类型"><a class="header" href="#类模板和类类型">类模板和类类型</a></h2>
<p>　　类模板 <code>GBinaryGroup</code> 表示两个标量的有序对，被用于表示屏幕坐标。以 <code>SPos</code> 作为模板参数的实例 <code>Point</code> 和 <code>Vec</code> 表示点的位置和二维向量，当前是一致的。</p>
<p>　　类 <code>Size</code> 包括两个 <code>SDst</code> 分量，用于表示大小。</p>
<p>　　类 <code>Rect</code> 约定了一个边和屏幕坐标系总是共线的矩形：保存一个左上角位置的 <code>Point</code> 和表示宽度和高度的 <code>Size</code> 对象。</p>
<p>　　一个 Rect 对象可以直接通过位置和大小构造：</p>
<pre><code>Rect r1(Point(10, 20), Size(40, 50));
Rect r2({10, 20}, {40, 50}); // 同上。
Rect r3(10, 20, 40, 50); // 同上。
Rect r4{10, 20, 40, 50}; // 同上。
</code></pre>
<p>　　类模板 <code>GGraphics</code> 表示<em>二维图形接口上下文</em> ，是一个表示缓冲区的指针（不保证具有所有权）和大小组成的数据结构。一般使用的是其实例 <code>Graphics</code> 和 <code>ConstGraphics</code> 。</p>
<p>　　类 <code>PaintContext</code> 包含了 GUI 绘制中的一些必要信息，其中由 <code>Graphics</code> 对象表示目标， <code>Point</code> 对象表示参考位置， <code>Rect</code> 对象表示需要保证绘制的边界范围。</p>
<h1 id="gui-应用接口概述"><a class="header" href="#gui-应用接口概述">GUI 应用接口概述</a></h1>
<h2 id="shell-和-guistate"><a class="header" href="#shell-和-guistate">Shell 和 GUIState</a></h2>
<p>　　Helper::GUIShell 模块提供的类 <code>Shells::GUIShell</code> 是专用于不同平台 GUI 程序处理的 shell ，它隐藏了控制和响应 GUI 需要处理的具体消息，使用户输入被分发到更高级的 <code>UI::GUIState</code> 类的对象中。</p>
<p>　　GUIState 是模块 YSLib::UI::YGUI 提供的平台中立的 GUI 公共逻辑处理的实现。默认 GUIState 对象预先构造的<strong>单态(monostate)</strong> 对象，即被全局共享，可以储存和 GUI 相关的公共状态。</p>
<p>　　通过 YSLib::UI::YGUI 提供的函数 <code>UI::FetchGUIState</code> 取得取默认图形用户界面公共状态：</p>
<pre><code>using namespace UI;
auto&amp; state(FetchGUIState());
</code></pre>
<h2 id="事件event"><a class="header" href="#事件event">事件(event)</a></h2>
<p>　　<code>UI::GUIState</code> 的成员函数被 <code>Shells::GUIShell</code> 直接或间接调用以按需构造不同的<strong>事件</strong> 。</p>
<p>　　一般意义的事件本质上是可以容纳回调(callback) 的对象，是发布-订阅模式的实现。用户通过事件提供的接口注册回调，在事件被触发调用时订阅者可以调用这些被预先发布的回调。</p>
<p>　　YSLib 事件由模块 YSLib::Core::YEvent 提供的 <code>GEvent</code> 类模板提供，包含多播支持，即 <code>GEvent</code> 中可以有多个回调函数，在触发事件时依优先级和插入顺序调用这些回调函数。 <code>GEvent</code> 支持的回调通过<strong>事件处理器(event handler)</strong> <code>GHEvent</code> 类模板提供，除限定返回类型 <code>void</code> 外，使用方式基本兼容于 <code>std::function</code> （提供 ISO C++ 定义的<strong>可调用对象(callable object)</strong> 作为回调），此外提供两个方面的增强：</p>
<ul>
<li>可比较相等。这意味着 <code>GEvent</code> 不需要保存特定的引用即可支持查询或移除特定回调（若可调用对象自身支持 <code>==</code> 则通过 <code>==</code> 操作定义结果，否则总是认为同类型可调用对象都相等）。</li>
<li>通过 YBase 库模块 YStandardEx::Functional 的 <code>ystdex::make_expanded</code> 模板提供允许比事件处理器提供模板更少参数的可调用对象的支持，允许省略在右边的若干参数。缺乏此支持时，一个可调用对象的函数形参即使未被使用，仍然需要出现在声明的参数列表中，带来一些不便。</li>
</ul>
<p>　　另外， GEvent 的 <code>operator()</code> 会忽略回调抛出的 <code>std::bad_function_call</code> 异常。</p>
<p>　　和消息不同， YSLib 的事件默认总是被同步处理的。不同的事件使用不同的枚举标识，携带特定类型的<strong>事件参数(event argument)</strong> 对象。</p>
<p>　　用户通过给事件提供不同的可调用对象作为回调，在其中可以实现应用程序特定的逻辑。</p>
<h2 id="部件widget"><a class="header" href="#部件widget">部件(widget)</a></h2>
<p>　　部件是 GUI 的可见元素抽象。体现 GUI 逻辑的事件最终被分发到具体的<strong>部件</strong>上，在部件持有的事件上进行响应。</p>
<p>　　部件具有一系列基本的可视化属性，例如位置和大小。其它一些状态决定它如何被绘制以及和其它部件的关系或者具有用户程序关心的数据。 YSLib 中的部件实现模块 YSLib::UI::YWidget 提供的 <code>UI::IWidget</code> 接口以及作为基类的 <code>UI::Widget</code> ，通过处理 <code>UI::Paint</code> 事件使其被绘制。</p>
<p>　　基本的部件只能处理 <code>UI::Paint</code> 标识的绘制事件，可以处理其它事件（例如直接响应表示用户输入的事件）的部件称为<strong>控件(control)</strong> 。模块 YSLib::UI::YControl 提供了控件的基类 <code>UI::Control</code> 。其它大部分部件派生于这个类以提供不同的功能。</p>
<p>　　调整部件的特定属性即可以基本完成一个 GUI 应用。</p>
<p>　　模块 YSLib::UI::YWidgetEvent 提供了 UI::VisualEvent 枚举标识默认支持的 GUI 事件，其中不同的枚举项表示不同的 GUI 事件，可能对应不同的事件参数类型。默认支持的事件参数类型都是类类型的右值引用类型，但和标准库的右值引用参数类型不同，约定被转移后状态可预测。</p>
<p>　　从一个控件取得一个指定事件标识的的事件左值，可以使用 YSLib::UI::YControl 提供的函数模板 <code>UI::FetchEvent</code> 。可以直接在取得的事件上进行操作，所以不必要直接声明一个变量。</p>
<pre><code>using namespace Drawing; // 使用 Drawing::Size 等。模块 YSLib::UI::YControl 已在命名空间 YSLib 中有此声明，若包含了对应的头文件，可以省略。
using namespace UI;
Control ctl(Size(80, 20)); // 创建一个 Control 类型的控件 ctl ，初始大小为 (80, 20) 。
auto&amp; paint_event(FetchEvent&lt;Paint&gt;(ctl)); // 取 ctl 的 UI::Paint 事件，通常是不必要的。

// 使用 lambda 表达式添加回调是简便的做法：
FetchEvent&lt;Click&gt;(ctl) += [](CursorEventArgs&amp;&amp;){
	std::cout &lt;&lt; &quot;Control clicked!&quot; &lt;&lt; std::endl; 
};
FetchEvent&lt;Click&gt;(ctl) += []{ // 得力于 GHEvent 允许省略参数的特性，这里可以省略没有用到的形式参数。
	std::cout &lt;&lt; &quot;Control clicked again!&quot; &lt;&lt; std::endl; 
};
</code></pre>
<p>　　当 ctl 被点击时，上面 <code>UI::Click</code> 事件上添加的两个回调会被依次执行，在标准输出上输出两行字符串。</p>
<h2 id="指定部件的视图属性"><a class="header" href="#指定部件的视图属性">指定部件的视图属性</a></h2>
<p>　　部件的视图属性包括<strong>位置</strong>和<strong>大小</strong>等。</p>
<p>　　上例中通过指定 <code>Size</code> 对象表示部件初始化时的大小。这个类型和下面涉及的位置以及边界类型都由模块 YSLib::Core::YGDIBase 提供，头文件默认已经被包含在 GUI 中所以不需要显式包含。</p>
<p>　　位置由二维的点 <code>Point</code> 类型表示。此处并没有明确位置是相对于哪个坐标系的。创建部件以后，并没有直接指定部件应在哪被显示，所以这里的位置本身只具有相对意义。</p>
<p>　　也可以通过直接指定 <code>Rect</code> 类型的矩形的<strong>边界</strong>：</p>
<pre><code>Control ctl2(Rect(10, 20, 40, 20)); // 位置为 (10, 20) ，大小为 (40, 20) 。
Control ctl3({10, 20, 40, 20}); // 同上。
</code></pre>
<p>　　出于动态加载部件的需要， YSLib 提供的部件总是可以通过一个 Rect 值构造以及默认构造（相当于 Rect 为空），因此不限于 <code>UI::Control</code> 使用。</p>
<p>　　在创建部件之后，使用函数 <code>GetLocationOf</code> 、 <code>GetSizeOf</code> 和 <code>GetBoundsOf</code> 等查询这些属性；相对地，使用函数 <code>SetLocationOf</code> 、 <code>SetSizeOf</code> 和 <code>SetBoundsOf</code> 等设置这些属性。通过这些函数设置位置和大小会分别触发 <code>Move</code> 和 <code>Resize</code> 事件。 </p>
<h2 id="视图树和容器"><a class="header" href="#视图树和容器">视图树和容器</a></h2>
<p>　　YSLib 提供了单一的<strong>视图树</strong>结构作为显示视图的抽象。通过指定部件所在的<strong>容器</strong>限定显示的范围。容器自身是一个部件，可以嵌套在另外的部件中。容器中的部件（<strong>子部件</strong>）的位置使用容器部件的边界的左上角作为原点，即位置表示子部件的边界的左上角相对于容器的边界的左上角。这样的结构典型地构成一颗树，只有作为树根的<strong>顶层部件</strong>没有容器。</p>
<p>　　容器通过 <code>UI::IWdiget</code> 提供一般的迭代遍历支持。不是所有容器都支持动态添加子部件。模块 YSLib::UI::YPanel 提供一般的面板容器 <code>UI::Panel</code> 支持这个特性：</p>
<pre><code>using namespace Drawing;
using namespace UI;
Panel pnl(Size(200, 100));
Control ctl({10, 20, 100, 40});

pnl += ctl; // ctl 作为 pnl 的子部件，在 pnl 左上角的位置 (10, 20) 显示。
yassume(&amp;pnl == FetchContainerPtrOf(ctl)); // 宏 yassume 由 YBase 提供，默认和标准库的宏 assert 行为一致，表示断言； 函数 FetchContainerPtr 取得指向容器的指针。
</code></pre>
<h3 id="顶层窗口top-level-window"><a class="header" href="#顶层窗口top-level-window">顶层窗口(top level window)</a></h3>
<p>　　部件最终需要通过顶层部件的 <code>UI::Paint</code> 事件被显示。在独立实现中，顶层部件一般是模块 YSLib::UI::YDesktop 提供的 <code>UI::Desktop</code> 。在宿主实现中，由于需要和宿主环境的 GUI 集成，使用不同的接口。在一个有桌面环境的宿主平台中，这样的顶层部件一般称为<strong>顶层窗口</strong>。</p>
<p>　　Helper 模块对顶层窗口提供了和平台相关的实现。通过模块 Helper::HostedUI 提供的函数 Host::ShowTopLevel 使一个部件成为一个顶层窗口。</p>
<pre><code>using namespace UI;
Control ctl(Size(200, 100));

Host::ShowTopLevel(ctl);
</code></pre>
<p>　　对 Windows ， <code>Host::ShowTopLevel</code> 支持更多的样式和扩展样式参数调整宿主窗口。具体使用详见 <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms632680(v=vs.85).aspx">MSDN</a> 。当调用 <code>Host::ShowTopLevel</code> 时，会自动创建具有独立线程和（ Win32 意义上的）消息循环 Windows 窗口，这个过程可能发生阻塞。</p>
<h2 id="常用部件"><a class="header" href="#常用部件">常用部件</a></h2>
<p>　　<code>UI</code> 命名空间下除了 <code>Widget</code> 、 <code>Control</code> 、 <code>Panel</code> 和 <code>YDesktop</code> 几类直接作为框架必要类型的部件外，还有更多提供不同实用功能的部件。</p>
<p>　　注意，非控件的部件不能取 <code>UI::Paint</code> 外的事件，否则会抛出异常。</p>
<h3 id="uilabel"><a class="header" href="#uilabel">UI::Label</a></h3>
<p>　　这是显示文本标签的部件。</p>
<p>　　简单的用法是创建部件后，修改 <code>Text</code> 属性。它接受的是模块 YSLib::Core::YString 提供的 <code>String</code> 类型的 UCS-2 字符串，可以直接通过 <code>std::u16string</code> 或 <code>const char16_t*</code> 等构造。因此内建的 <code>u</code> 前缀的字面量可以直接用于赋值 <code>Text</code> 。 YSLib 中 GUI 的其它部分也使用这样的字符串。</p>
<h3 id="uibutton"><a class="header" href="#uibutton">UI::Button</a></h3>
<p>　　按钮控件。</p>
<p>　　类似 <code>UI::Label</code> 可以显示文本，但它是一个控件，可以点击并添加 <code>UI::Click</code> 事件回调。</p>
<h2 id="动态加载"><a class="header" href="#动态加载">动态加载</a></h2>
<p>　　模块 YSLib::UI::Loader 提供了在运行时读取 <a href="Tutorial/../Features/NPL.zh-CN.html">NPLA1</a> 配置加载部件视图树的 API 。</p>
<p>　　这些 API 当前相对不稳定，可能较容易改变，因此不作详细介绍。具体用法可参照<a href="Tutorial/../Features.zh-CN.html">示例程序 YReader</a> 的源代码。</p>
<h1 id="小结"><a class="header" href="#小结">小结</a></h1>
<p>　　通过以上讨论，读者可以回顾<a href="Tutorial/../GettingStarted.zh-CN.html">入门</a>中的示例，分析其中的各个部分的具体意义。</p>
<p>　　在这个基础上，参阅 Doxygen 文档查找 <code>UI</code> 命名空间下的其它 API 以开发自己的 GUI 应用。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="程序配置概述"><a class="header" href="#程序配置概述">程序配置概述</a></h1>
<p>　　因为可移植性需求，YSLib 不直接使用特定平台提供的机制（如 <a href="https://en.wikipedia.org/wiki/Windows_Registry">Windows 注册表</a>）。考虑表达能力和实现冗余， YSLib 不使用 <a href="https://en.wikipedia.org/wiki/INI_file">INI</a> 等简单的配置格式。考虑实现复杂性和用户输入配置的简便性， YSLib 避免使用 <a href="https://en.wikipedia.org/wiki/Standard_Generalized_Markup_Language">SGML</a> 及其派生的标记语言，特别地， <a href="https://en.wikipedia.org/wiki/XML">XML</a> 及其派生语言实现作为配置格式。</p>
<p>　　YSLib 提供相关解决方案为基于 <a href="Tutorial/../Features/NPL.zh-CN.html">NPL 派生实现 NPLA1</a> 的配置，在 YFramework 模块 NPL::Configuration 中提供相关 API 。</p>
<h1 id="规则和意义"><a class="header" href="#规则和意义">规则和意义</a></h1>
<p>　　除了整个文件构成的 NPL 表达式外，每一个 NPL 表达式的第一个项应为标识符，表示配置项的名称。其后的项可以是字符串或列表，表示配置项的内容。</p>
<h1 id="用例"><a class="header" href="#用例">用例</a></h1>
<p>　　YFramework 的一部分使用配置决定程序运行时需要的信息，如字体文件的位置。参照<a href="Tutorial/../Run.zh-CN.html">程序运行</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><div style="break-before: page; page-break-before: always;"></div><h1 id="术语概要"><a class="header" href="#术语概要">术语概要</a></h1>
<p>　　本文档概述及约定 YSLib 基本的概念含义，主要用于<a href="Development.zh-CN.html">开发</a>。</p>
<p>　　一些术语概念适用各种不同的上下文，主要用于开发过程中的设计和规则说明。</p>
<p>　　术语以列表形式的条目列出。通过使用元语言语法 <em>&lt;相关范畴/上下文&gt;</em> 标记指示被修饰或被限定的概念的适用范围。不需要消歧义时，省略标记。</p>
<h1 id="通用领域"><a class="header" href="#通用领域">通用领域</a></h1>
<p>　　除非另行指定，适用于任意<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">上下文</a>；但存在更具体的上下文的特定概念定义时，优先适用后者。</p>
<h2 id="经验语义"><a class="header" href="#经验语义">经验语义</a></h2>
<p>　　经验语义解释的术语的含义总是假定可被实证，不需要进一步解释。</p>
<p>　　元语言中的标记使用经验语义。标记可被本文档中已归类的章节提供。</p>
<p>　　本文档中非形式地使用在特定理论中严格定义的、和<a href="Terminology.zh-CN.html#%E9%80%9A%E7%94%A8%E7%BA%A6%E5%AE%9A">本章</a>的条目具有逻辑上相容的含义的概念时，不进一步解释。</p>
<h2 id="自指"><a class="header" href="#自指">自指</a></h2>
<p>　　<a href="https://zh.wikipedia.org/wiki/%E8%87%AA%E6%8C%87"><strong>自指</strong></a>是概念定义形式上的自我指涉。</p>
<p><strong>举例</strong> “<a href="Terminology.zh-CN.html#%E9%80%9A%E7%94%A8%E9%A2%86%E5%9F%9F">本章</a>”是关于位置的自指。</p>
<p>　　有必要通过自指定义的概念，隐含引入定义内容的过程的<a href="https://zh.wikipedia.org/zh-cn/%E5%BE%AA%E7%92%B0%E8%AB%96%E8%AD%89">循环论证</a>。这些概念的精确内涵和外延依赖<a href="Terminology.zh-CN.html#%E7%BB%8F%E9%AA%8C%E8%AF%AD%E4%B9%89">经验语义</a>的实证，否则在自然语言语言中可能需要循环论证而失去定义的意义。此处的条目内容（包括链接的外部定义）仅仅供参考，而不是精确的内涵和外延。为简化复杂度，限制自指定义的概念都是名词。</p>
<p><strong>举例</strong> 上述注释中，<strong>内涵</strong>和<strong>外延</strong>约定为以下<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">非自指</a>的概念，因此可依据本文档给出明确的定义来源。</p>
<p><strong>举例</strong> 在程序语言理论中，上下文(context) 指形式上可继续补充内容的构造；文档可能非形式地使用和这个含义相容的概念。</p>
<ul>
<li>实体(entity) ：任意被自然语言表达的目标；不需要通过自然语言先验定义；参见经验语义。</li>
<li>语义(semantics) ：参见经验语义。</li>
<li>经验(experience) ：参见哲学或一般等价的经验语义。</li>
<li>范畴(category) ：参见<a href="https://zh.wikipedia.org/zh-cn/%E8%8C%83%E7%95%B4%E8%AE%BA">范畴论</a>。</li>
<li>态射(morphism) ：参见范畴论。</li>
<li>归纳(induction) ：一种态射，可操作性参见经验语义。</li>
<li>方法学(methodology) ：一个归纳经验得到的范畴；参见哲学或一般等价的经验语义。</li>
<li>方法(method) ：方法学的一个子范畴；可操作性参见经验语义。</li>
<li>概念(concept) ：参见逻辑学。</li>
<li>上下文(context) ：一种概念范畴适用的态射；参见经验语义。</li>
</ul>
<h2 id="非自指"><a class="header" href="#非自指">非自指</a></h2>
<p>　　包含多个一般领域的概念。</p>
<ul>
<li><em>&lt;名词&gt;</em> 形式(form) ：参见经验语义和数学。</li>
<li><em>&lt;概念&gt;</em> 内涵：参见逻辑学。</li>
<li><em>&lt;概念&gt;</em> 外延：参见逻辑学。</li>
<li><em>&lt;概念&gt;</em> 定义(definition) ：确定概念内涵和外延的方法；参见任意一种形式逻辑学。</li>
<li><em>&lt;动词&gt;</em> 抽象(abstracting) ：通过经验语义定义概念范畴或集合的方法。</li>
<li><em>&lt;名词&gt;</em> 抽象(abstraction) ：<em>&lt;动词&gt;</em> 抽象的结果。</li>
<li><em>&lt;动词&gt;</em> 封装(encapsulating) ：从某一个范畴中抽象一个子范畴的方法。</li>
<li><em>&lt;名词&gt;</em> 封装(encapsulation) ：<em>&lt;动词&gt;</em> 封装的结果。</li>
<li>规范(specialization) ：一种提供在特定上下文中可定义的描述的封装，参见工程学（特别是软件工程学，下同）。</li>
<li>接口(interface) ：一种封装，参见工程学。</li>
<li>实现(implementation) ：一种封装，参见工程学。</li>
<li>重用(reusing) ：参见经验语义和工程学。</li>
<li>不变性(invariance) ：满足某种<a href="https://zh.wikipedia.org/zh-cn/%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB">等价关系</a>（自反、传递、对称的<a href="https://zh.wikipedia.org/zh-cn/%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB">二元关系</a>）。</li>
<li>不变量(invariant) ：具有不变性的实体。参见数学和契约式程序设计。</li>
<li>状态(state) ：可以和其它实体关联的、可在某个上下文中保持变化或不变的实体。同一状态总是保持变化或保持不变。状态变化的含义参见经验语义、数学或另行指定。
<ul>
<li>可变状态(mutable state) ：在某个上下文中可能映射到若干其它状态的状态。</li>
<li>不可变状态(immutable state) ：不是可变状态的状态。</li>
</ul>
</li>
<li><em>&lt;动词&gt;</em> 派生(deriving) ：基于重用的操作。</li>
<li><em>&lt;名词&gt;</em> 派生(derivation) ：<em>&lt;动词&gt;</em> 派生的结果。</li>
</ul>
<h1 id="计算机科学"><a class="header" href="#计算机科学">计算机科学</a></h1>
<p>　　包含多个关于数学、逻辑学和计算机领域的概念。</p>
<ul>
<li><em>&lt;动词&gt;</em> 形式化(formalize) ：建立数学意义上的严格<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">形式</a>。</li>
<li><em>&lt;名词&gt;</em> 形式化(formalization) ：建立形式的过程。</li>
<li>形式方法(formal method) ：包含形式化的<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">方法</a>。</li>
<li><em>&lt;动词&gt;</em> 建模(model) ：建立形式化输出的形式。</li>
<li><em>&lt;名词&gt;</em> 模型(model) ：建模的结果。</li>
<li>可计算性(computability) ：参见数学。
<ul>
<li>通常由 <a href="https://zh.wikipedia.org/zh-cn/%E9%82%B1%E5%A5%87%EF%BC%8D%E5%9B%BE%E7%81%B5%E8%AE%BA%E9%A2%98">Church-Turing 论题</a>定义。</li>
</ul>
</li>
<li>计算(computation) ：由可计算性定义的操作的等价类。</li>
<li>计算模型(computation model) ：描述计算的模型，是对计算建模的结果。 </li>
<li>集合(set) ：一种数学模型，参见 <a href="https://zh.wikipedia.org/zh-cn/%E5%86%AF%E8%AF%BA%E4%BC%8A%E6%9B%BC-%E5%8D%9A%E5%86%85%E6%96%AF-%E5%93%A5%E5%BE%B7%E5%B0%94%E9%9B%86%E5%90%88%E8%AE%BA">NBG 集合论</a>。</li>
<li><a href="https://zh.wikipedia.org/zh-cn/%E7%B1%BB_%28%E6%95%B0%E5%AD%A6%29">类</a>(class) ：参见 NBG 集合论和范畴论。</li>
<li>真类(proper class) ：参见 NBG 集合论和范畴论。</li>
<li><a href="https://zh.wikipedia.org/zh-cn/%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB">二元关系</a>(binary relationship) ：一种基于集合上定义的数学实体。</li>
<li><a href="https://zh.wikipedia.org/zh-cn/%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB">等价关系</a>(equivalence relationship) ：自反的(reflexive) 、对称的(symentric) 和传递的(transitive) 的二元关系。</li>
<li><a href="https://zh.wikipedia.org/zh-cn/%E7%AD%89%E4%BB%B7%E7%B1%BB">等价类</a>(equivalence class) ：等价关系划分集合得到的类。</li>
<li>序列(sequence) ：有序集合。</li>
<li>形式语义(formal semantics) ：使用形式化的方式表达的语义。</li>
<li>形式语言(formal language) : 特定语言规则确定的串的全集，是语言规则对应的语法的外延（也可能作为其它语言规则对应的某种形式语义）。</li>
<li>计算复杂度(computational complexity) ：某个形式化计算模型中以有限的正整数作为模型决定的规模(metric) 作为参数的渐进(asymptotic) 性质确定的度量。
<ul>
<li>时间复杂度(time complexity) ：描述步骤规模的计算复杂度。</li>
<li>空间复杂度(space comlexity) ：描述存储规模的计算复杂度。</li>
</ul>
</li>
</ul>
<h1 id="规范"><a class="header" href="#规范">规范</a></h1>
<p>　　包含提供<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">规范</a>的<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">实体</a>定义。</p>
<ul>
<li>符合性(conformance) ：满足规范的实现性质。</li>
<li>要求(requirement) ：规范对实现的作为判断符合性的条件。</li>
<li>约束(constraint) ：可被<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">形式</a>表达，用于限制和明确行为的规则。不一定使用形式表达。</li>
<li>违反(violation) ：对约束指定的条件的不满足。</li>
<li>过时的(obsolesent) ：已确认因为存在更合适的选项而建议不继续使用的（接口/特性）。</li>
<li>废弃的(deprecated) ：过时的但因为兼容性等原因，暂时保留的、一般可提供替代的接口或特性。</li>
<li>语言：<a href="Terminology.zh-CN.html#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">模型</a>或者非形式地其它方式定义的一种<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">接口</a>。</li>
<li><em>&lt;语言&gt;</em> 接口(<em>&lt;language&gt;</em> interface) ：和表达<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">语义</a>有关的语言的可见的特征。</li>
</ul>
<p>　　包含关于语言的规范的定义。</p>
<ul>
<li><em>&lt;语言&gt;</em> 实现(<em>&lt;language&gt;</em> implementation)：对语言规则中的要求的<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87"><em>&lt;非自指&gt;</em> 实现</a>。</li>
<li><em>&lt;语言&gt;</em> 人类接口(human interface) ：语义仅对人类有意义（内容改变时可以导致语义的差异性），不提供为涉及作为计算模型实现的语言接口。</li>
<li><em>&lt;语言&gt;</em> 机器接口(machine interface) ：对机器（或特定语言实现的特定部分）有意义的语言接口。注意不同语言实现组成部分可以不同。
<ul>
<li><strong>举例</strong> 对 <a href="https://zh.wikipedia.org/zh-cn/C%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8">C 语言的预处理器</a>，C 源代码中的空白符是机器接口，而对翻译器来说则不是。就源代码而言，机器接口总是人类接口的子集。</li>
</ul>
</li>
<li><em>&lt;语言&gt;</em> 特性(*&lt;language&gt; feature) ：作为功能提供的人类接口。</li>
<li>语言规则(language rule) ：约定可实现及应被实现的语言接口的描述，可包含语言特性的表达。</li>
<li>语言规范(language specialization) ：包含正式的(normative) 的语言规则的集合的<a href="Terminology.zh-CN.html#%E8%87%AA%E6%8C%87">规范</a>；或称语言规格说明。</li>
<li>语言实现(language implementation) ：语言提供的接口的实现，是语言的表现形式，可以是具体语言实现或抽象语言实现之一。
<ul>
<li>具体语言实现(concreate language implementation) ：能最终完全表达为可预测的物理现象一一对应的表达<a href="Terminology.zh-CN.html#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">可计算性</a>的实现（如机器指令），一般应为程序。</li>
<li>抽象语言实现(abstract language implementation) ：非具体语言实现的语言实现。形式意义的标准定义的语言属于此类。</li>
</ul>
</li>
<li>派生语言实现(derived language implementation) ：派生已有实现的部分或全部得到的语言实现。以下简作“派生实现”。</li>
<li><em>&lt;语言&gt;</em> 实现环境(environment of implementation) ：对应特定语言实现的特定不变状态（对机器来说可以是配置项，对人来说不确定，所以一般忽略）的集合。</li>
<li><em>&lt;语言&gt;</em> 互操作(interoperation) ：不同的语言实现环境中发生的交互。</li>
</ul>
<h1 id="程序设计语言"><a class="header" href="#程序设计语言">程序设计语言</a></h1>
<p>　　提供上下文 <em>&lt;程序设计语言&gt;</em> ，特别是语言规范的定义。</p>
<p>　　主要用例参见版本库中的项目文档 <code>doc/NPL.txt</code> 。</p>
<ul>
<li>广义实体：<em>&lt;通用领域&gt;</em> 实体。语言抽象的目标，不另行定义（意义最终取决于自然语言）。</li>
<li>名称(name) ：一种特殊的广义实体，专用于指称另一个广义实体。</li>
<li>实体(entity) ：非名称的广义实体。</li>
<li>表示(representation) ：以一个符合某种形式的约束的实体指称另一个实体。</li>
<li>符号(symbol) ：语言规则允许的不使用其它对象表示的对象。符号可实现名称。</li>
<li>字母表(alphabet) ：符号在语言中的全集。</li>
<li>串(string) ：可能重复出现的符号的有限序列。</li>
<li>文法(grammar) ：描述任意的可形式化的语言规则。</li>
<li>语法(syntax) ：以语言中的串作为基本元素，描述语言的字面(literal) 结构模式(pattern) 的语言规则，通常是文法的一部分。</li>
<li>语义(semantics) ：非语法的考虑逻辑上的释义(interpretation) 或含义(meaning) 的规则、原理和过程，通常可被语法以外的文法描述并可约束含义的表达。</li>
<li>实例(instance) ：具有代表性含义的集合的元素。</li>
<li>代码(code)：任意有限的语言的实例片段组成的语法范畴。</li>
<li>伪代码(pseudo code)：抽象语言实现的语言的代码。
<ul>
<li><strong>注释</strong> 习惯上和具体语言实现代码完全一致的代码可以不作为伪代码考虑。</li>
</ul>
</li>
<li>程序(program) ：具体语言实现接受的以代码表示的输入，或被变换后对应的输出。</li>
<li>行为(behavior) ：语言实现或在满足符合性的具体语言实现中的程序的外部表现。基于可操作性考虑，一般仅约束实现的机器<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">接口</a>。</li>
<li>计算作用(computational effect) ：可被某个形式化计算模型描述的行为。</li>
<li>作用(effect) ：语言支持的一定上下文内的表达式规约的结果的计算作用，包括计算得到的值、产生的副作用以及其它可由区域和变化的状态二元组描述的实体。</li>
<li>翻译(translation) ：不同语言的程序之间的变换，可作为语言实现的形式。
<ul>
<li><strong>注释</strong> 输入和输出具有相同表示的恒等变换不被视为翻译。</li>
</ul>
</li>
<li>运行(run) ：实现程序或组成程序的实体的行为的动作。</li>
<li>加载(load) ：运行程序或组成程序的实体时从实现环境取得相关实体的动作，可蕴含创建这些实体的副本或翻译其中的代码到特定形式。</li>
<li>执行(execute) ：处理程序或组成程序的实体，使这些实体或实体的副本作为资源被消费而蕴含这些实体被运行，同时可能蕴含消费实现环境的其它资源。
<ul>
<li><strong>注释</strong> 执行强调资源的消费，是运行的子集。资源被消费后不再可用。因此，除非同时蕴含资源的<em>再生(reclaim)</em> ，被执行的同一实体不预期被再次执行。再生资源包括实体加载时翻译或取得副本，及实现环境中补充的替代资源。</li>
</ul>
</li>
<li>解释(interpretation) ：通过不依赖显式指定的附加的程序翻译而直接运行表现行为的具体语言实现的形式。</li>
<li>源语言(source language) ：翻译的输入的语言。</li>
<li>目标语言(destination language) ：翻译的输入的语言。</li>
<li>源代码(source code) ：源语言编码的代码。</li>
<li>源程序(source program) ：形式为作为翻译的输入的源代码程序。</li>
<li>复杂度(complexity) ：以程序的规模作为参数的关于程序的直接执行的<a href="Terminology.zh-CN.html#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6">计算复杂度</a>。</li>
<li>元语言(metalanguage) ：描述其它语言的语言。</li>
<li>对象语言(object language)：被元语言操作或实现的语言。</li>
<li>元编程(metaprograming) ：使用元语言编程。</li>
<li>反射(reflection) ：元语言和对象语言相同的元编程。</li>
<li>具现(reification) ：在对象语言中以数据模型作为关联实体以表示程序的语义。</li>
<li>诊断(diagnostics) ：明确的对特定预期或非预期执行的行为的响应的总和。</li>
<li>诊断消息(diagnostic message) ：用于和用户交互的表现诊断的告知及提示。</li>
<li>未定义的(undefined) ：可能导致违反语言规范的约束但语言规范同时没有要求提供任何可能影响<a href="Terminology.zh-CN.html#%E9%9D%9E%E8%87%AA%E6%8C%87">符合性</a>的保证（如具有诊断消息）的。表示置于语言规则下的行为等不可预测。</li>
<li>未指定的(unspecified) ：在各个实现中可能存在的，通常允许多种不同的实现选项。不应假定不同实现在明确未指定的规则上表现一致。</li>
<li>由实现定义的(implementation-defined) ：取决于各个具体语言实现的，要求有文档说明。</li>
<li>由派生实现定义的(derived-implementation-defined) ：取决于各个具体派生实现的，要求除存在默认定义或被派生实现的部分有明确的文档说明。</li>
<li>未定义行为(undefined behavior) ：未定义的行为。</li>
<li>未指定行为(unspecified behavior) ：未指定的行为，由实现选取规格中可能允许的指定行为的不确定选项，后者可能由显式或隐式的语言规则确定。</li>
<li>语言特性(language feature) ：语言提供的功能接口，可以是具体语言特性或抽象语言特性之一。</li>
<li>具体语言特性(concrete language feature) ：完全没有派生语言实现定义的语言特性。</li>
<li>抽象语言特性(abstract language feature) ：非具体语言特性的语言特性。</li>
<li>外部环境(external environment) ：和程序及被翻译的程序没有交集的和实现环境无关的状态。</li>
<li>外部表示(external representation) ：具有特定形式的用于和外部环境交互的表示。</li>
<li>内部表示(internal representation) ：非外部表示的表示。</li>
</ul>
<h1 id="项目管理"><a class="header" href="#项目管理">项目管理</a></h1>
<h2 id="依赖dependency-管理"><a class="header" href="#依赖dependency-管理">依赖(dependency) 管理</a></h2>
<p>　　项目管理的客体被分解为特定关联的<strong>依赖项</strong>。任意两个依赖项之间存在<a href="https://zh.wikipedia.org/zh-cn/%E5%8F%8D%E5%AF%B9%E7%A7%B0%E5%85%B3%E7%B3%BB">反对称</a>和<a href="https://zh.wikipedia.org/zh-cn/%E4%BC%A0%E9%80%92%E5%85%B3%E7%B3%BB">传递</a>的<a href="https://zh.wikipedia.org/zh-cn/%E4%BA%8C%E5%85%83%E5%85%B3%E7%B3%BB">二元关系</a>称为<strong>依赖关系</strong>。<strong>严格依赖关系</strong>是反自反的依赖关系。</p>
<p>　　依赖项和依赖项之间的严格依赖关系统称为<strong>依赖</strong>。</p>
<h3 id="依赖引用"><a class="header" href="#依赖引用">依赖引用</a></h3>
<p>　　因为依赖关系的传递性，多个依赖关系可能存在无法满足严格依赖关系的情形，即<strong>循环依赖</strong>。这导致以确定的顺序解析依赖不可行，增加维护成本。</p>
<p>　　为了避免一定层次上的循环依赖，以该层次内组件为顶点的依赖关系的关系图应明确组织为有向无环图。
在最简单情况下依赖关系可退化为线性顺序依赖。</p>
<h3 id="内部依赖和外部依赖"><a class="header" href="#内部依赖和外部依赖">内部依赖和外部依赖</a></h3>
<p>　　项目中的组成部分之间的依赖称为<strong>内部依赖</strong>，其它依赖为<strong>外部依赖</strong>。</p>
<h2 id="a-hrefterminologyzh-cnhtmle7a88be5ba8fe8aebee8aea1e8afade8a880源代码a"><a class="header" href="#a-hrefterminologyzh-cnhtmle7a88be5ba8fe8aebee8aea1e8afade8a880源代码a"><a href="Terminology.zh-CN.html#%E7%A8%8B%E5%BA%8F%E8%AE%BE%E8%AE%A1%E8%AF%AD%E8%A8%80">源代码</a></a></h2>
<p>　　源代码用于生成指定目标代码(target code) 。</p>
<p>　　通常源代码以文件形式保存，即源代码文件(source code file) ，简称源文件(source file) 。</p>
<h2 id="版本库repository"><a class="header" href="#版本库repository">版本库(repository)</a></h2>
<p>　　本项目使用的版本控制(version controll) 的存储实体。</p>
<p>　　当前使用的主要版本控制系统为 <a href="https://www.mercurial-scm.org/">Mercurial</a> 。因为是分布式版本控制，也用于直接分发源代码。</p>
<p>　　每个文件系统上存储的版本库实例中， <code>.hg</code> 目录存储版本库元数据。</p>
<h1 id="设计和模型"><a class="header" href="#设计和模型">设计和模型</a></h1>
<h2 id="环境environment"><a class="header" href="#环境environment">环境(environment)</a></h2>
<p>　　程序中的某一部分的外界称为<strong>环境</strong>。根据限定程序的范围，可以有更确切的定义，如<a href="Terminology.zh-CN.html#%E8%A7%84%E8%8C%83">实现环境</a>（对一类语言实现而言）、运行时环境（对共享实现环境的一类程序而言）。</p>
<p>　　一般地，实现环境可以分为<strong>独立环境(freestanding environment)</strong> 和<strong>宿主环境(hosted environment)</strong> ，区分依据为是否依赖宿主（对部署在单一计算机上的实现，一般指操作系统）的支持。因此，环境有时指操作系统及其提供的外部服务的集合。</p>
<p>　　一些语言，如 ISO C 和 ISO C++ ，可以同时支持宿主环境和独立环境的实现，对应<strong>独立实现(freestanding impementation)</strong> 和<strong>宿主实现(hosted impementation)</strong> 。</p>
<h2 id="平台platform-环境"><a class="header" href="#平台platform-环境">平台(platform) 环境</a></h2>
<p>　　环境中决定程序适用环境的被依赖的特定资源集合称为<strong>平台环境</strong>，简称<strong>平台</strong>。平台的典型例子有：</p>
<ul>
<li>运行时支持的<a href="https://zh.wikipedia.org/zh-cn/%E6%8C%87%E4%BB%A4%E9%9B%86%E6%9E%B6%E6%A7%8B">硬件的体系结构</a> ；</li>
<li>操作系统和 <a href="https://zh.wikipedia.org/zh-cn/%E5%BA%94%E7%94%A8%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%8E%A5%E5%8F%A3">ABI</a> 。</li>
</ul>
<p>　　平台的内涵是资源的集合，其构成并非任意。构成平台的特定准则应使之保持相对的稳定和可预期，即可配置；即平台是名义的(nominal) 可配置的资源集合。</p>
<p>　　若平台包含的资源是已知的，则不需要平台的观念，分析其资源子集（即便不构成平台）即可解决几乎平台抽象涉及的所有技术问题（同时这也是<em>定义</em>一个具体平台的基础）。但在简化资源集合的全局性质分析（如比较资源配置方案）和名义抽象以隐藏实现（如为开发者提供预设环境集合）的应用角度上，平台仍有被单独讨论的意义。</p>
<h3 id="兼容性compatibility-和可移植性portability"><a class="header" href="#兼容性compatibility-和可移植性portability">兼容性(compatibility) 和可移植性(portability)</a></h3>
<p>　　若一个依赖项对应的平台可以替换，则此依赖项和此平台<strong>兼容(compatible)</strong> 。兼容性不是一种<a href="https://zh.wikipedia.org/zh-cn/%E7%AD%89%E4%BB%B7%E5%85%B3%E7%B3%BB">等价关系</a>，因为不保证传递。</p>
<p>　　替换平台的过程称为<strong>移植(porting)</strong> 。移植的可行性称为<strong>可移植性</strong>。</p>
<p>　　兼容任意平台的依赖项被称为是<strong>平台中立(platform-neutral)</strong> 的。</p>
<p>　　当平台中立的依赖项的依赖能被自动满足而不需要考虑时，是<strong>平台无关(platform-independent)</strong> 的。平台中立<a href="https://zh.wikipedia.org/zh-cn/%E5%AE%9E%E8%B4%A8%E6%9D%A1%E4%BB%B6">实质蕴含</a>平台无关。</p>
<h3 id="依赖和外延"><a class="header" href="#依赖和外延">依赖和外延</a></h3>
<p>　　若平台之间不出现平台的实现（如开发语言的实现）和环境自身的相互依赖，则这些平台相互<strong>独立</strong>。总是保持相互独立的一组平台称为<strong>独立平台(independent platforms)</strong> 。每一组独立平台保证可以相对于其它独立平台分离开发和测试。</p>
<p>　　注意以上术语和 ISO C 和 ISO C++ 定义的<strong>宿主实现(hosted implementation)</strong> 和<strong>独立实现(freestanding implementation)</strong> 的关联和区别。</p>
<p>　　典型的应用场景约定以下类型的平台：</p>
<ul>
<li><strong>构建平台(build platform)</strong> 运行开发环境的平台。</li>
<li><strong>宿主平台(host platform)</strong> 运行构建平台输出代码的平台。</li>
<li><strong>目标平台(target platform)</strong> 运行最终目标代码的平台。</li>
</ul>
<p>　　若宿主平台和构建平台一致，称为<strong>本机构建(native build)</strong>；否则，称为<strong>交叉构建(corss build)</strong>。</p>
<p>　　通常构建工具在本机构建时提供对构建平台的检查以确定自身是否能够运行；交叉构建环境需要显式指定。</p>
<p>　　目标平台通常和宿主平台一致。指定目标平台的理由是，存在最终不一定在宿主平台上运行的程序，其运行的环境可能需要宿主平台不保证支持的特性，这典型地包括：</p>
<ul>
<li>构建的程序自身是生成其它程序的程序，如编译器和链接器。这些程序生成的平台是目标平台，不需要和它们的宿主平台相同。</li>
<li>构建的程序可以在宿主平台上运行，但在其它平台上具有更完全的特性集。后者被作为目标平台。</li>
</ul>
<p><strong>注意</strong> 此处的宿主平台具有相对意义，不一定脱离被运行的目标平台。一个宿主平台通常自身是宿主实现平台，但这点不被保证。</p>
<h3 id="模拟emulation-和仿真simulation"><a class="header" href="#模拟emulation-和仿真simulation">模拟(emulation) 和仿真(simulation)</a></h3>
<p>　　模拟指适配和运行为不同平台设计的程序，广义上包括以下两类：</p>
<ul>
<li>环境模拟(environment emulation) ：使用模拟器(emulator) 或虚拟机(virtual machine) 等作为宿主平台的程序，模拟运行环境的通用解决方案；</li>
<li>程序模拟(program emulation) ：直接以运行时环境适配层嵌入宿主平台运行时，在具体程序中提供类似被模拟的目标平台的具体特性和接口。</li>
</ul>
<p>　　运行模拟程序的环境和被模拟环境分别是宿主平台和目标平台。</p>
<p>　　注意虚拟机在这个意义下是广义的模拟器，但一般仍然分别对待。</p>
<p>　　环境模拟和程序模拟的主要差异为是否独立的、专用的宿主平台程序作为中介以维护目标平台和宿主平台的隔离。</p>
<p>　　在一般意义上，仿真指对需要分析的问题建立的模型(model) 的过程、方法和机制，在软件工程以外也被称为模拟，如计算机模拟(computer simulation) 。对于以计算机系统为目标的仿真，建立的模型可以是具体的实物（包括硬件和软件），称为仿真器(simulator) 。以软件接口为主要操作方式实现的仿真器同时实现了环境模拟，但侧重不同：精确重现需要分析行为，而非实用的功能等价性和体系中的可替换性。</p>
<h3 id="平台配置"><a class="header" href="#平台配置">平台配置</a></h3>
<p>　　实际的平台实现可能复用部分实现，配置之间可存在某种构成依赖关系的<a href="https://zh.wikipedia.org/zh-cn/%E5%81%8F%E5%BA%8F%E5%85%B3%E7%B3%BB">偏序关系</a>（如继承关系）。这些在项目中所有被配置的平台称为<strong>公共平台(common platform)</strong> ，其中能对应生成输出的称为<strong>具体平台(concrete platform)</strong> ，否则为<strong>抽象平台(abstract platform)</strong> 。</p>
<h3 id="标识"><a class="header" href="#标识">标识</a></h3>
<p>　　不同平台可以标识符加以区分。由于平台受到不同环境因素决定的正交性，通常此类标识符可以分解为表示这些正交环境的标识符的元组形式，用 <code>-</code> 等字符分隔。</p>
<p>　　一种常用的方式是 GNU 构建系统的<a href="https://www.gnu.org/savannah-checkouts/gnu/autoconf/manual/autoconf-2.69/html_node/System-Type.html#System-Type">系统类型(en-US)</a>，经典表示方式为三元组(triplet) ，或其省略形式：</p>
<ul>
<li>一般包括体系结构、系统厂商和系统软件环境</li>
<li>第一项不可省略，之后的项可省略</li>
<li>体系结构一般指定 CPU 要求的最小指令集架构</li>
<li>系统厂商指集成平台的环境厂商</li>
<li>系统软件环境保证满足 ABI 要求，可以包含操作系统及本机语言运行时实现的名称</li>
</ul>
<p>　　确定为宿主环境时，系统软件同时指定操作系统和运行时环境而拆分为两项，三元组扩充为四元组，如 <a href="https://wiki.gentoo.org/wiki/CHOST">Gentoo 使用的 CHOST (en-US)</a>。</p>
<p>　　在不够充分体现平台的必要差异（尤其是体系结构相关的配置）时也可通过自行定义标识符并指定与三元组的对应关系，如 <a href="%5Bhttps://wiki.debian.org/Multiarch/Tuples%5D">Debian multiarch (en-US)</a> 。</p>
<p>　　除非必要时另行指定， YSLib 使用三元组作为指定平台标识的基本形式。</p>
<h3 id="多平台构建"><a class="header" href="#多平台构建">多平台构建</a></h3>
<p>　　构建系统中可能涉及多个平台。</p>
<p>　　运行构建系统的环境和被构建的程序的环境不需要相同，对应的平台分别称为宿主平台(host platform) 和目标平台(target platform) 。宿主平台和目标平台相同时称为本机(native) 构建；不同时称为交叉(build) 构建。</p>
<p>　　多个构建过程可能串联组成更大的构建过程。不同构建过程存在输出和输入之间的依赖。此时，前一过程输出的目标平台需要兼容于后一过程作为输入的宿主平台，否则无法直接运行。典型情况下这些平台是相同的，但也可以存在平台之间自身保证二进制<a href="Terminology.zh-CN.html#%E8%A7%84%E8%8C%83">互操作</a>兼容性（如支持 x86_64 的体系结构上混用 i686 和 x86_64 ）的情况。</p>
<p>　　一些构建系统如 <a href="https://gcc.gnu.org/onlinedocs/gccint/Configure-Terms.html">GNU 工具链(en-US) 使用更复杂的术语</a>，单独引入构建(build) 平台。为确保一般性并简化模型， YSLib <strong>不使用</strong>这个概念，而把构建平台作为第一级构建过程（即 GNU autoconf 的“配置”）的宿主平台。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>This page specifies the language features from the standard shall be used in this project, by introducing several rules and then clearifying which features are <em>applied</em> to the project from specific project build revision and time.</p>
<p>This page also includes some related information of external projects about various language implementations.</p>
<p>The interface documentation for this project may be specified in the <code>doc</code> directory of the repository,  in the pages of wiki, or in the Doxygen comments around the declarations in the header files in the source code. All of them are in zh-CN by default.</p>
<p>Unless otherwise specified, notations of date and time are in UTC+8.</p>
<h1 id="notation"><a class="header" href="#notation">Notation</a></h1>
<p>&quot;<strong>NOTE</strong>&quot; indicates note for maintainers and it is not directly from the source of the concerned contents.</p>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<p>Some external materials are referenced here by links in several categories. Entries in same category are listed ordinally specified by document numbers (if any).</p>
<p>Since only adopted revisions are applied, most superseded reversions are placed together. A paper of a collection of issues can have multiple revisions and it can be adopted more than once (e.g. <a href="http://wg21.link/p0165">P0165</a>); these revisions does not superseds each other.</p>
<h2 id="revision-and-timestamp"><a class="header" href="#revision-and-timestamp">Revision and timestamp</a></h2>
<p>Revisions are designated in forms of b<em>revision-number</em>[<em>time</em>], where <em>revision-number</em> is the number of revision and <em>time</em> is the timestamp issued for that revision in any of ISO 8601:2004 calendar time formats. The timestamp is usually a date conventionally with <em>YYYY</em>-<em>MM</em>-<em>DD</em>.</p>
<h2 id="list-of-items"><a class="header" href="#list-of-items">List of items</a></h2>
<p>Items of features are categorized in different lists with various status. The indentation of a list indicates the context: items with less indentation level cover the topic covering items with more indentation level.</p>
<h2 id="items-and-tags"><a class="header" href="#items-and-tags">Items and tags</a></h2>
<p>Each item in a list is normally specified by (committee) document or CWG/LWG/EWG/LEWG issue/DR(defect report) number with a link and a title. Paper as editor's report or issue/DR list  (but <em>not</em> list about contents out of these contents, e.g. specifically drafted resolution paper of one ore more DRs) should be collectively listed in a few list (so issues can be top-level items otherwise). Each item may be noted with following tags:</p>
<ul>
<li>&quot;adopted&quot; indicating the feature has been incorperated into <strong>the working paper</strong> (but <strong>not</strong> in this document) since the followed time which is usually the content of &quot;Disposition&quot; column from the <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers">official document list</a></li>
<li>&quot;based on&quot; indicating one of the base specifications</li>
<li>&quot;dropped&quot; indicating abandoned in development</li>
<li>&quot;overriden by&quot; indicating new item taking effect instead of the current one</li>
<li>&quot;part of&quot; or &quot;parts of&quot; indicating not all contents of the specification</li>
<li>&quot;revised&quot; indicating one of the revised specifications
<ul>
<li>is often unique</li>
<li>should be significant, e.g. adopted previously; otherwise it can already be indexed by other lists of items, and if there are no other list is appropriate, it shall be in the &quot;outdated&quot; list</li>
</ul>
</li>
<li>&quot;see&quot; pointing to revised revisions</li>
<li>&quot;see also&quot; for related materials</li>
<li>&quot;see other derivation&quot; pointing to siblings</li>
<li>&quot;see subsequent&quot; pointing to subsequent new series</li>
<li>&quot;since&quot; with initial project build revision and time of applying (which is only applicable for features adopted or tentatively adopted in this document)</li>
<li>&quot;split from&quot; for the original item containing the material</li>
<li>&quot;subsumed by&quot; for the target of migration (e.g. for duplicated issues)</li>
<li>&quot;with&quot; indicating additional specifications not covered by specified one in the context</li>
</ul>
<h1 id="basic-rules"><a class="header" href="#basic-rules">Basic rules</a></h1>
<p><strong>The Forwarding Compatibility Rule:</strong> All language features incompatible with published/normative future versions of the language specification shall not be mandated or depend on.</p>
<p><strong>The Baseline Implementation Rule:</strong> Each feature being used shall have been implemented in general available version of at least 2 <a href="https://en.wikipedia.org/wiki/Free_and_open-source_software">FOSS</a> implementations.</p>
<h1 id="general-status"><a class="header" href="#general-status">General status</a></h1>
<p>The default configuration, <em>baseline</em>, is specified here. The features explicitly introduced to clearify dependences on the language implementations are also listed in this and following sections.</p>
<h2 id="conformance"><a class="header" href="#conformance">Conformance</a></h2>
<p>The conformance of languages and environments used in this project is specified using published versions of standards and technicle specifications, as well as drafts and proposals. For purpose of specification in this project, all of them are designated as specifications.</p>
<p>Several C++0x features are used since b206[2011-05-03]. These features are also in ISO C++11(ISO/IEC 14882:2011). Previously C++03 with TR1(ISO/IEC TR 19768:2007) was used. New version of ISO C++ and technicle specifications are also considered:</p>
<ul>
<li>ISO C++14(ISO/IEC 14882:2014)</li>
<li>ISO C++17(ISO/IEC 14882:2017)</li>
</ul>
<h3 id="baseline"><a class="header" href="#baseline">Baseline</a></h3>
<p>C++11 is now default to conform.</p>
<p>As per the forwarding compatibility rules, all C++03 features conflicted with future versions of C++ (e.g. <code>export</code>) and all features already removed from C++17 (e.g. <code>std::auto_ptr</code>) are disallowed to rely on.</p>
<p>TR1 features are avoided and have been substituted by their C++11 counterparts.</p>
<p><a href="http://eel.is/c++draft">Draft standard</a> is considered in sake of avoiding conflicts with future versions of the standard.</p>
<h3 id="additional-specifications"><a class="header" href="#additional-specifications">Additional specifications</a></h3>
<p>The considered and (possibly incompletely) reviewed technical specifications beyond C++11 are:</p>
<ul>
<li>ISO/IEC TS 19568:2015 Programming Languages — C++ Extensions for Library Fundamentals
<ul>
<li><a href="http://www.iso.org/iso/home/store/catalogue_tc/catalogue_detail.htm?csnumber=64031">Published</a> 2015-09-30 (ISO Store)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4480.html">Final draft (N4480)</a> (2015-04-07)</li>
</ul>
</li>
</ul>
<p>(See <a href="http://wongmichael.com/2016/02/28/c17-content-predictionpre-jacksonville-and-post-kona-report/">here</a> for information about adoption in C++17.)</p>
<h2 id="replacements"><a class="header" href="#replacements">Replacements</a></h2>
<p>Several features in specifications beyond C++11 is not directly relied on, but this project provides some replacements (possibly with some custom extensions) as features to ease the work about compatibility.</p>
<p>Replacements are provided in a &quot;(mostly) drop-in&quot; manner, i.e. the base name of API are same, but with allowence of difference on qualified prefix and/or prefixe (of namespaces, mostly, to <code>std</code>; or of headers to be included). This allows user code replacing interface with a few alias declarations without changing of the program well-formedness and behavior. It is easy to change the underlying set of API as well as to pick a subset of them on purpose.</p>
<p>The replacements provided most compatibility are bidirectionally drop-in replaceable, which can be used interchangably with the features they replace, except the compatibility exceptions specified below. However, such replacements are not guaranteed to be mixed arbitrary with the feature being replacements. The granularity of mixture with guaranteed usablity   is a type or a template with any related operations relying on the type signature derived from that entity, unless otherwise specificed in documentation.</p>
<p>Some of other replacements are ony-way drop-in replacements, i.e., guaranteed being able to replace the correspoinding features in specifications without changing of meaning but not the other way.</p>
<h3 id="compatibility-exceptions"><a class="header" href="#compatibility-exceptions">Compatibility exceptions</a></h3>
<p>Several features cannot be implemented portably due to ISO C++ core language features are not available in virous target environments (e.g. in the baseline).</p>
<p>Emulation of (esp. core language) features involved such cases is limited, and it would be implemented in replacements with <em>best effort</em>. Corollary: such features are available <strong>conditionally</strong> depending on which language dialect is being used.</p>
<p>For cases where the replaced features cannot be implemented portably in the baseline, the limitations shall be documented on related interface with <code>\warning</code> command to inform users the existence of portability risks and the condition of availablity (i.e. which dialects it is guaranteed to work). To avoid frequent need, features totally unusable (e.g. features relying on variable templates) are not provided at all, thus only a few cases should be concerned.</p>
<p>Currently, compatibility limitations include:</p>
<ul>
<li>To determine whether a class is declared with <code>final</code>.
<ul>
<li>It is not implementable without some implementation support before C++14 introduces <code>std::is_final</code>.</li>
<li>Note that <code>std::is_empty</code> are not implementable without such support. However, <code>std::is_empty</code> is provided by C++11 (in the baseline), so there shall be <em>no</em> limitation on determine whether a class is empty.</li>
</ul>
</li>
<li>To get pointer value to an object of arbitrary type in a <code>constant-expression</code>.
<ul>
<li>Even the type is complete, there is no guarantee to rule out user-defined overloaded <code>operator&amp;</code> on the object.</li>
<li>In cases where <code>operator&amp;</code> is used, C++11 provides <code>std::addressof</code> to get the correct result. However, it is not designated with <code>constexpr</code>, which is available portably only since C++17.</li>
</ul>
</li>
</ul>
<p>For better compatibility to evolution, additional exceptions are granted here:</p>
<ul>
<li>Type equivalence between provided and replaced types is not guaranteed even if they coexist in a same configuration of C++ implementation.
<ul>
<li>This allows mixture of different components served as different parts of the replaced interface at same time, as well as complement of interface already (insufficiently) implemented by the current C++ implementation.</li>
<li>Types may provided based on old revision of specification (e.g. by inheritance of classes).</li>
</ul>
</li>
<li>The <code>constexpr</code> specifier may be effectively omitteed in interface or implementation of the library when the environment is limited in a configuration with insufficient core language support.
<ul>
<li>The <code>constexpr</code> guaranteed by C++14 is not guaranteed available in a  configuartion ealier than C++14, since it may be missing of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3652.html">relaxing constraints</a> support in the core langauge implementation.</li>
<li>Any <code>constexpr</code> on <code>lambda-expression</code>s is not guaranteed available in a configuration eariler than C++17 even after adoption of <a href="P0170R1"><code>constexpr</code> lambda</a>, since it may be missing in the core langauge implementation.</li>
</ul>
</li>
<li>Operators may be introduced in declarations different to current version of specifications.
<ul>
<li>This is like [objects.within.classes] for private class members.</li>
<li>Comparison operators are no longer guaranteed accessible as independent entities (e.g. as operand of <code>&amp;</code> or accessing using <code>qualified-id</code>).
<ul>
<li>This is same to the direction of future standardization proposed in <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0790r0.html">P0790R0</a>.</li>
<li>This dependes on C++20 <code>&lt;=&gt;</code> operator, but it is not the only way.</li>
</ul>
</li>
<li>Other operators can be similar to get potentional great simplication of implementation.
<ul>
<li>Notably, with <a href="https://en.wikipedia.org/wiki/Barton%E2%80%93Nackman_trick">Barton–Nackman trick</a>, simplification can be achived partially as <code>&lt;=&gt;</code> on most overloadable operators (not only comparison).</li>
<li>Currently, most operators in this project is simplified by using of <code>YBase.YStandard.Operatos</code> API.</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="subproject-structure"><a class="header" href="#subproject-structure">Subproject structure</a></h3>
<p>All of the replacements live in the top-level subproject YBase. The overall structure concerned here is:</p>
<ul>
<li>YBase
<ul>
<li>YDefinition (header file <code>ydef.h</code>)</li>
<li>LibDefect</li>
<li>YStandardEx</li>
<li><em>others</em></li>
</ul>
</li>
<li><em>other YSLib or YSLib-like top-level subprojects</em></li>
</ul>
<p>For YBase, all interface of C++ code is in the namespaces specified here. This includes replacements.</p>
<p>There is no well-defined behavior guaranteed if library-wise rules are violated. The rules are:</p>
<ul>
<li>No namespaces name can be introduced as top-level (directly enclosed in <a href="http://eel.is/c++draft/basic.scope.namespace#3">the global namespace</a>) namespace names except the namespaces specified here:
<ul>
<li>Namespaces <a href="http://eel.is/c++draft/namespace.constraints">specified by the standard</a> are used according to these rules.</li>
<li>The namespace <code>ystdex</code> provides most code not from YBase.LibDefect.</li>
<li>Namespace name (glob) pattern 'ystdex_*' are reserved.
<ul>
<li>Some of them may be used as top-level namespaces providing code additional to namespace <code>ystdex</code> without clash in <code>ystdex</code>, e.g. when ADL(argument dependent lookup) is unavoidable.</li>
</ul>
</li>
<li>Reserved namespace with public interface as well as namespace <code>ystdex</code> are collectively specified as <em>public top-level namespaces</em>.
<ul>
<li>Currently public top-level namespaces are:
<ul>
<li>namespace <code>ystdex</code></li>
<li>namespace <code>ystdex_swap</code> </li>
</ul>
</li>
</ul>
</li>
<li>To simplify the code, any top-level names without explicit qualified preifx <code>::</code> shall be used as-if they are prefixed with with <code>::</code>.</li>
</ul>
</li>
<li>Only YBase.LibDefect can inject names into namespace <code>std</code> and other namespaces specified by the standard (as parts of implementation) when necessary in provide being <a href="http://eel.is/c++draft/conforming">conforming</a>. Otherwise, they shall be conform to <a href="http://eel.is/c++draft/constraints">the rules of the library user code</a>.</li>
<li>Documented reserved marco names besides <a href="http://eel.is/c++draft/reserved.names">the standard rules</a> shall be also avoided by the library user code.</li>
<li>All other cases are conform to <a href="http://eel.is/c++draft/requirements">the standard rules</a> except that the namespaces provided by the standard are replaced by the top-level namespaces specified above.</li>
</ul>
<p>Except for the file specified as &quot;drop-in replacement&quot;, a header specified by a rule of published standard or specification may or may not be directly aligned to the actual one in YBase, but there are clear many-interface-to-one-header relationship across the interface and headers by splitting the standard header to plural correspoinding header files. The purpose is to break down dependencies and to reduce the overhead of inclusion performed in preprocessing phase.</p>
<p>For other top-level subprojects, no replacements need to be considered. Unless otherwise specified, the baseline applies directly. If there needs replacements, use interface proveded by YBase for preference (but usually <em>not</em> YBase.LibDefect).</p>
<h3 id="components"><a class="header" href="#components">Components</a></h3>
<p>Replacements in YBase consist of following components with caveats:</p>
<ul>
<li><strong>YDefinition</strong>, i.e. <code>ydef.h</code>, provides various vendor-neutral compatible interface of language implementation by conditioanlly-defined preprocessing macros.
<ul>
<li>A few replacemnets are same to YStandardEx direct replacements below, except provided in the top-level namespace directly.</li>
</ul>
</li>
<li><strong>LibDefect</strong> implementation provide some interface conform directly to the standard, as complement of the language implementations provided by system and toolchain vendors.
<ul>
<li>The public headers shall be capable for direct use with any implementation meeting the requirements specified by the YSLib documentation (including following sections) as in-drop replacements for corresponding standard library headers.</li>
</ul>
</li>
<li><strong>YStandardEx replacements</strong> provide remain interface meet the functionality needs.
<ul>
<li><strong>YStandardEx direct replacements</strong> provide adaptive interface compatible and (almost) conforming to multile version of specifications.
<ul>
<li>To support adaptive use, the direct part of replacements may conditionally include different source, whose interface is specified as &quot;<strong>conditionally</strong>&quot; in this document.</li>
<li>The comformance requirements shall be clear to each interface.</li>
<li>Nonconforming interface may only occur with exactly same or one-to-one mapping of interface between namespace <code>std</code> and <code>ystdex</code> in the user code.</li>
<li>Nonconforming interface shall not introduce differences on requirements on the program using that interface.</li>
<li>Nonconforming interface shall be still compatible to other rules. That is, use of the interface shall not alter well-formness and the well-defined behavior of the program, except cases restricted by compatibility limitations.</li>
</ul>
</li>
<li><strong>YStandardEx dedicated replacements</strong> provide interface compatible to specifications as well as their drafts by less conformance requirements compared to direct replacements.
<ul>
<li>Nonconformance may occur in a form same to that in the case of YStandardEx direct replacements. </li>
<li>Nonconformance shall occur in a form that loosing the requirements of rules in the published standard or specification, or in a form with explicitly supported extensions which are not compatible to these rules; otherwise, the interface should be designed as direct replacements or non replacements.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>See following paragraphs for precise definition of components and more detailed descriptions on policies of their use.</p>
<h2 id="evolution"><a class="header" href="#evolution">Evolution</a></h2>
<p>For compatibility, the project may use different sets of rules in each parts. YBase is more stable and conservative to utilize new C++ features.</p>
<h3 id="longterm-policy"><a class="header" href="#longterm-policy">Longterm policy</a></h3>
<p>The longterm policy holds as:</p>
<ul>
<li><code>ydef.h</code>: For compatibility reasons, only a subset of C++11 would be mandated. The precise subset is unspecified and can vary between revisions.</li>
<li>YBase except LibDefect discussed above: Library features beyond C++11 would be used only available.</li>
<li>Other parts of the project: C++ features would be used aggressively (but still restrictd by the rules here, esp. the basic rules). Currently it is still in the baseline.</li>
</ul>
<h3 id="core-language-compatibility-features"><a class="header" href="#core-language-compatibility-features">Core language compatibility features</a></h3>
<p>Some core language feature have fallback in C++03 (e.g. <code>constexpr</code>) or library (e.g. <code>alignof</code>), mostly workaround in <code>ydef.h</code>, as well as some optional extensions (e.g. <code>__has_feature</code> and <code>__builtin_expect</code>) wrapped as implementation details. They are provided by YDefnition.</p>
<p>Some core language features not in the standard but provided by various adapted language implementations have been wrapped in a platform-neutral interface provided by YDefinition.</p>
<h3 id="library-implementation-patches"><a class="header" href="#library-implementation-patches">Library implementation patches</a></h3>
<p>Due to limitations of specific environments, some standard library features might be not usable without alternative implementations. They may be enabled by using additional headers in the module YBase.LibDefect instead of the corresponding standard headers.</p>
<p>As patches, namely parts of language implementations, the code in YBase.LibDefect can be highly implementation-specific. It has significant differences (which may cause undefined behavior without further guarantees) to the usual library and user code:</p>
<ul>
<li>It can be directly intrusive to the global namespace, <code>namespace std</code> and other implementation-specific namespaces, which may be reserved by the standard.</li>
<li>As part of the standard library implementation, it may use names reserved by the standard.</li>
<li>It may have implementation-specific contents intended only for internal use and guarded by conditional inclusion, because they are direct replacements for the standard library.</li>
</ul>
<p>The code has been carefully tuned to be compatible to supported environments, to keep out undefined behavior merely caused by this implementation.</p>
<h3 id="library-compatibility-features"><a class="header" href="#library-compatibility-features">Library compatibility features</a></h3>
<p>To reduce impact on user code to adopt new versions of specifications, several post-C++03 library features are provided in the top-level namespace <code>ystdex</code> (with inlined namespace if the features have been in published standards) in module YBase.YStandardEx, either by <code>using</code> declarations from namespace <code>std</code> iff. provided by the standard library, or being implemented from scratch when the features are not available from the standard library (not the library implementation, i.e. implementation-specific interface are still forbidden).</p>
<p>They are designed to be (bidirectionally) drop-in replacements (with necessary filename change in <code>#include</code> directives) of corresponding specific version of <code>std</code> or <code>std::experimental</code> interface, with a few exceptions:</p>
<ul>
<li>Except for some specialization of standard library templates, the enclosing namespace is not <code>std</code> so name lookup may behave differently to the standard library interface.
<ul>
<li>Use additional 'using ystdex::<em>NAME</em>;' to enable ADL(argument dependent lookup) for <em>NAME</em>.</li>
<li>Note <a href="http://www.eel.is/c++draft/global.functions#4">[global.functions]/4</a> is still conforming similarly. Any ADL beyond <code>namespace ystdex</code> shall be specified by the interface documentation.</li>
</ul>
</li>
<li>The overloaded operators may be implemented by ADL-only manner, i.e. declared as friend functions, rather than namespace scope entities.
<ul>
<li>Currently no entities are declared in this manner except for interface are ready for post-C++14 standard library features.</li>
</ul>
</li>
<li>It is unspecified that whether the concerned types of replacement API is identical to the types in the standard.
<ul>
<li>It is important to know this to avoid type introspection based on wrong type identical assumptions, including:
<ul>
<li>Using <code>static_assert</code> or some other meta operations based on static type equivalence.</li>
<li>RTTI or exception handling based on dynamic type identity.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>They are collectively called as <strong>YStandardEx direct replacements</strong> for the corresponding features being replaced.</p>
<p>YBase user code may use interface in public top-level namespaces instead of the counterparts in the namespaces mentioned above to simplify the migration. For components of direct replacements interface beyond ISO C++11, they are in correspoinding enclosed <strong>standard replacement namespaces</strong> which are inline namespaces enclosed unambiguously in public namespaces with a common namespace prefix pattern with same nested namespaces to the standard interface. For example:</p>
<ul>
<li>Interface first occurred or last updated in ISO C++14 in namespace <code>std</code> is in inline namespace <code>ystdex::cpp2014</code>.</li>
<li><code>std::pmr</code> interface introduced since ISO C++17 is in inline namespace <code>ystdex::pmr::cpp2017</code>.</li>
</ul>
<p>Note that a similar approach is also proposed for <code>std</code> separatedly as <em>shadow namespace</em> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1473r0.pdf">P1473R0</a> for some slightly different purposes.</p>
<p>If there are multiple published versions of standard having modification on some entities denoted by a same name, there shall be one candidate or at least one extra alias declaration to reference it in the public top-level namespaces unambiguously, allowing omission of the inline namespace name normally but distinguishing on need. Deprecated features is not guaranteed provided unless explicitly specified to reduce confusion and restriction as per the future direction of feature using implied in this document. To avoid misconceptions, other replacements shall neither be provided in standard replacement namespaces or their enclosing namespaces thereof.</p>
<p>Ambiguity across different namespaces with mixture use of them shall also be avoided.</p>
<p>Components for the upcoming standard (in the working draft or Technicle Specifications, but not the published Internaltional Standard) are deliberately experimental as library compatibility features, so they are directly declared in public top-level namespaces.</p>
<p>As per the compatibility limitations of replacements, exceptional rules of compatibility to <code>std</code> interface are granted hereby:</p>
<ul>
<li>For entities used specifically in tag dispatching, only such use is required to be compatible as drop-in replacement. The differences shall be defined in documents about the replacement.</li>
</ul>
<p>Revised components of library compatibility features shall not be deprecated in the current (newest formal) standard.</p>
<h3 id="extended-library-compatibility-features"><a class="header" href="#extended-library-compatibility-features">Extended library compatibility features</a></h3>
<p>Some other interfaces in YBase.YStandardEx are designed as replacements for corresponding specific versions of <code>std</code> or <code>std::experimental</code> interface, as the compatibility features above, but with extra extensions, and with no restriction about the solution of <a href="http://wg21.cmeerw.net/lwg/issue2013%5D">LWG 2013</a> (that is, they may be with extra <code>constexpr</code>). They can be used as ony-way drop-in replacements.</p>
<p>Entities with extended library compatibility features to the replaced entites are collectively called as <strong>YStandardEx dedicated replacements</strong> of the corresponding features being replaced, where each of them meets following requirements:</p>
<ul>
<li>Except extensions, it shall be able to one-to-one mapped to the entity being replaced with exact functionality (albeit the name can be different in several cases, see below).</li>
<li>If it is neither a type nor a template of type (class template or alias template), or it is provided as some part of other compatibility features, its base name (<em>unqualified-id</em>) shall be same to the name of entity being replaced.</li>
<li>Its name shall be declared in public top-level namespaces or enclosed namespaces thereof, except the namespaces excluded by the rules specified previously.</li>
</ul>
<p>Components of extended library compatibility features not being dedicated replacements shall be declared in public top-level namespaces and may be declared in the same header of the compatibility features above.</p>
<h3 id="potential-library-compatibility-features"><a class="header" href="#potential-library-compatibility-features">Potential library compatibility features</a></h3>
<p>Some other interfaces in YBase.YStandardEx are designed close to correspongding specific versions of <code>std</code> or <code>std::experimental</code> interface, to be an implemantation base of above compatibility library features or extended library compatibility features. They are <strong>not</strong> replacements as they are not designed to be conforming to any version of the standard or technical specifications, nor always provided in a drop-in manner. Nevertheless, they may have features which can be directly mapped to the said specifications, with or without some resolutions of LWG issues applied.</p>
<p>Although as implementation of above features, they are totally in details, they can also be used as public interfaces as other parts of YSLib.</p>
<h2 id="reviewed"><a class="header" href="#reviewed">Reviewed</a></h2>
<p>The following editor's report has been fully reviewed (b593[2015-04-23]), which means all the resolutions in the paper are categorized in the following clauses:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">N2370</a></li>
</ul>
<p><strong>NOTE</strong> There might exist minor differences between editor's report and the paper in the list, e.g. <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3059.pdf">N3059</a> (rev 5.2) in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3091.html">N3091</a> is (rev 5.1). For these cases, only the later revisions at the point of time are reviewed and probably would not be updated unless necessary.</p>
<h2 id="to-be-done"><a class="header" href="#to-be-done">To be done</a></h2>
<p>Reviewing of following defect reports and resolutions are work in progress.</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue215">CWG 215</a>: Template parameters are not allowed in <code>nested-name-specifier</code>s</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue218">CWG 218</a>: Specification of Koenig lookup (see also <a href="http://wg21.cmeerw.net/cwg/issue113">CWG 113</a> and <a href="http://wg21.cmeerw.net/cwg/issue143">CWG 143</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue397">CWG 397</a>: Same address for string literals from default arguments in inline functions?</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue667">CWG 667</a>: Trivial special member functions that cannot be implicitly defined</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1135">CWG 1135</a>: Explicitly-defaulted non-public special member functions
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1136">CWG 1136</a>: Explicitly-defaulted explicit constructors</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1140">CWG 1140</a>: Incorrect redefinition of POD class</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1145">CWG 1145</a>: Defaulting and triviality</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1149">CWG 1149</a>: Trivial non-public copy operators in subobjects</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1208">CWG 1208</a>: Explicit <code>noexcept</code> in defaulted definition</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4320.html">N4320</a>: Make exception specifications be part of the type system
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue92">CWG 92</a>: Should exception-specifications be part of the type system?</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1946">CWG 1946</a>: <code>exception-specification</code>s vs pointer dereference (see also <a href="https://wg21.cmeerw.net/cwg/issue92">CWG 92</a> and <a href="https://wg21.cmeerw.net/ewg/issue169">EWG 169</a>)</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2010">CWG 2010</a>: exception-specifications and conversion operators (see also <a href="https://wg21.cmeerw.net/cwg/issue92">CWG 92</a>, <a href="https://wg21.cmeerw.net/cwg/issue1798">CWG 1798</a>, <a href="https://wg21.cmeerw.net/cwg/issue1946">CWG 1946</a>, <a href="https://wg21.cmeerw.net/cwg/issue1975">CWG 1975</a>, <a href="https://wg21.cmeerw.net/cwg/issue1995">CWG 1995</a> and <a href="https://wg21.cmeerw.net/ewg/issue169">EWG 169</a>)</li>
<li><a href="https://wg21.cmeerw.net/ewg/issue169">EWG 169</a>: Make exception specifications be part of the type system</li>
</ul>
</li>
</ul>
<p>Reviewing of following editor's reports is work in progress.</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2008.html">N2008</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">N2283</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2589.html">N2589</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2799.html">N2799</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n3001.html">N3001</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3091.html">N3091</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3938.html">N3938</a>
<ul>
<li>LWG motion 3: <a href="https://wg21.cmeerw.net/lwg/issue2188">LWG 2188</a> &quot;Reverse iterator does not fully support targets that overload <code>operator&amp;</code>&quot; with editorial fix</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4583.html">N4583</a>
<ul>
<li>LWG motion 6: <a href="http://wg21.link/p0220r1">P0220R1</a> &quot;Adopt library fundamentals v1 TS components for C++17&quot;) (incompletely applied)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4603.html">N4603</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4619.html">N4619</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4661.html">N4661</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4714.html">N4714</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4740.html">N4740</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4764.html">N4764</a>
<ul>
<li>CWG motion 15: <a href="http://wg21.link/p0941r2">P0941R2 &quot;Feature-test macros&quot;</a></li>
<li>LWG motion 21: <a href="http://wg21.link/p0879r0">P0879R0 &quot;<code>constexpr</code> for <code>swap</code> and <code>swap</code>-related functions&quot;</a> applied, resolving 1 issue:
<ul>
<li><a href="http://wg21.link/lwg2800">LWG 2800</a>: <code>constexpr</code> <code>swap</code>
The following issues are being waiting to be resolved (and then be reviewed here) formally in public standards.</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4792.html">N4792</a>
<ul>
<li>LWG motion 13: <a href="http://wg21.link/p0318r1">P0318R1 &quot;<code>unwrap_ref_decay</code> and <code>unwrap_reference</code>&quot;</a> </li>
<li>LWG motion 21: <a href="http://wg21.link/p0591r4">P0591R4 &quot;Utility functions to implement uses-allocator construction&quot;</a></li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue943">CWG 943</a>: Is <code>T()</code> a temporary?
<ul>
<li><strong>NOTE</strong> see also <a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2015/p0135r0.html">P0135R0</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2014/n3918.html">N3918</a> Core Issue 1299: Temporary objects vs temporary expressions
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1299">CWG 1299</a>: “Temporary objects” vs “temporary expressions”
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1651">CWG 1651</a>: Lifetime extension of temporary via reference to subobject</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1893">CWG 1893</a>: Function-style cast with braced-init-lists and empty pack expansions</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1300">CWG 1300</a>
<ul>
<li>see also <a href="http://wg21.cmeerw.net/cwg/issue914">CWG 914</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1661">CWG 1661</a>: Preservation of infinite loops</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1722">CWG 1722</a>: Should lambda to function pointer conversion function be <code>noexcept</code>?</li>
</ul>
<h1 id="no-actions"><a class="header" href="#no-actions">No actions</a></h1>
<p>There are nothing to do of coding and further documentations for some resolutions.</p>
<p>Note in WG21 terms, NAD means &quot;not a defect&quot;, and TC1 means &quot;Technical Corrigendum 1&quot;.</p>
<h2 id="in-the-baseline"><a class="header" href="#in-the-baseline">In the baseline</a></h2>
<p>These issues are resolved as NAD and thus have been rejected by WG21 in the baseline, and there are no further changes to reopen:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue37">CWG 37</a>: When is <code>uncaught_exception()</code> <code>true</code>?</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue61">CWG 61</a>: Address of static member function &quot;<code>&amp;p-&gt;f</code>&quot;</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue109">CWG 109</a>: Allowing <code>::template</code> in <em>using-declaration</em>​s</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue130">CWG 130</a>: Sequence points and <em>new-expression</em>​s</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue84">LWG 84</a>: Ambiguity with <code>string::insert()</code></li>
<li><a href="http://wg21.cmeerw.net/ewg/issue91">EWG 91</a>: [tiny] <a href="http://wg21.cmeerw.net/cwg/issue622">Core issue 622</a>, Relational comparisons of arbitrary pointers
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue622">CWG 622</a>: Relational comparisons of arbitrary pointers (see <a href="http://wg21.cmeerw.net/ewg/issue91">EWG 91</a>)</li>
</ul>
</li>
<li>parts of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2173.html">N2173</a>: Core Extensions for Evolution
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue13">CWG 13</a>: <code>extern &quot;C&quot;</code> for Parameters of Function Templates</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue107">CWG 107</a>: linkage of operator functions</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue168">CWG 168</a>: C linkage of static members</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue229">CWG 229</a>: Partial specialization of function templates</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue294">CWG 294</a>: can <code>static_cast</code> drop exception specs (see also <a href="https://wg21.cmeerw.net/cwg/issue87">CWG 87</a>)</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue359">CWG 359</a>: Type definition inside anonymous union</li>
</ul>
</li>
</ul>
<p>These issues were once confirmed but are in NAD status now due to newer feature changes which have been adopted by the standard and by this project, so there are nothing further to do:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue395">CWG 395</a>: Conversion operator template syntax</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2386">LWG 2386</a>: <code>function::operator=</code> handles allocators incorrectly (see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0302r1.html">P0302R1</a>)</li>
</ul>
<p>These resolutions are already adopted as TC1, i.e. in C++03, and still effective (probably revised) in later versions of the standard:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue25">CWG 25</a>: Exception specifications and pointers to members</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue30">CWG 30</a>: Valid uses of &quot;<code>::template</code>&quot;</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue84">CWG 84</a>: Overloading and conversion loophole used by <code>auto_ptr</code></li>
<li><a href="http://wg21.cmeerw.net/cwg/issue137">CWG 137</a>: <code>static_cast</code> of <em>cv</em> <code>void*</code></li>
<li><a href="http://wg21.cmeerw.net/cwg/issue178">CWG 178</a>: More on value-initialization (see also <a href="http://wg21.cmeerw.net/cwg/issue543">CWG 543</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue304">CWG 304</a>: Value-initialization of a reference</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue61">LWG 61</a>: Exception-handling policy for unformatted output</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue129">LWG 129</a>: Need error indication from <code>seekp()</code> and <code>seekg()</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue136">LWG 136</a>: <code>seekp</code>, <code>seekg</code> setting wrong streams?</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue209">LWG 209</a>: <code>basic_string</code> declarations inconsistent</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue227">LWG 227</a>: <code>std::swap()</code> should require <code>CopyConstructible</code> or <code>DefaultConstructible</code> arguments</li>
<li><a href="www.open-std.org/jtc1/sc22/wg21/docs/papers/2000/n1219.htm">N1219</a>: PROPOSED RESOLUTION TO LIBRARY ISSUE 60
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue60">LWG 60</a>: What is a formatted input function?</li>
</ul>
</li>
</ul>
<h2 id="not-related-to-user-code"><a class="header" href="#not-related-to-user-code">Not related to user code</a></h2>
<p>These issues are resolved as NAD or NAD editorial and thus nothing to do for user code:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1384">CWG 1384</a>: <code>reinterpret_cast</code> in constant expressions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue435">CWG 1415</a>: Change &quot;declararation or definition&quot; to &quot;declaration&quot;</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1520">CWG 1520</a>: Alias template specialization vs pack expansion (see also <a href="http://wg21.cmeerw.net/cwg/issue1558">CWG 1558</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue299">LWG 299</a>: Incorrect return types for iterator dereference
<ul>
<li>resolved by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3066.html">N3066</a></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue392">LWG 392</a>: 'equivalence' for input iterators</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue526">LWG 526</a>: Is it undefined if a function in the standard changes in parameters?</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue529">LWG 529</a>: The standard encourages redundant and confusing preconditions</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue580">LWG 580</a>: unused allocator members</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2006">LWG 2006</a>: <code>emplace</code> broken for associative containers
<ul>
<li>proposed by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3178.htm">N3178</a>: <code>emplace</code> broken for associative containers</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2204">LWG 2204</a>: <code>reverse_iterator</code> should not require a second copy of the base iterator</li>
</ul>
<p>These post-C++03 draft resolutions are non-normative, purely editorial or conceptional, so no actions could be taken (revised b843[2018-11-10]):</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue113">CWG 113</a>: Visibility of called function</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue119">CWG 119</a>: Object lifetime and aggregate initialization</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue357">CWG 357</a>: Definition of signature should include name</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue404">CWG 404</a>: Unclear reference to construction with non-trivial constructor (<strong>NOTE</strong> partially superseded by new wording in [basic.life] proposed by <a href="https://wg21.cmeerw.net/cwg/issue1751">CWG 1751</a> and <a href="https://wg21.cmeerw.net/cwg/issue2256">CWG 2256</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue413">CWG 413</a>: Definition of &quot;empty class&quot;</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue452">CWG 452</a>: Wording nit on description of <code>this</code>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">partially adopted</a></li>
<li><a href="http://wg21.cmeerw.net/cwg/issue538">CWG 538</a>: Definition and usage of structure, POD-struct, POD-union, and POD class
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue327">CWG 327</a>: Use of &quot;structure&quot; without definition</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue582">CWG 582</a>: Template conversion functions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue594">CWG 594</a>: Coordinating issues 119 and 404 with delegating constructors (see <a href="http://wg21.cmeerw.net/cwg/issue119">CWG 119</a> and <a href="http://wg21.cmeerw.net/cwg/issue404">CWG 404</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue618">CWG 618</a>: Casts in preprocessor conditional expressions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue627">CWG 627</a>: Values behaving as types</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue999">CWG 999</a>: “Implicit” or “implied” object argument/parameter?</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue542">LWG 542</a>: <code>shared_ptr</code> observers</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue610">LWG 610</a>: Suggested non-normative note for C++0x (i.e. small function object optimization)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue616">LWG 616</a>: missing '<code>typename</code>' in <code>ctype_byname</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue628">LWG 628</a>: Inconsistent definition of <code>basic_regex</code> constructor</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue640">LWG 640</a>: 27.6.2.5.2 does not handle (<code>unsigned</code>) <code>long long</code> (i.e. for <code>ostream::operator&lt;&lt;</code>), <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">outdated</a></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue972">LWG 972</a>: The term &quot;Assignable&quot; undefined but still in use</li>
<li>LWG 2135
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue2240">LWG 2240</a>: Probable misuse of term &quot;function scope&quot; in [thread.condition]</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2310">LWG 2310</a>: Public exposition only member in <code>std::array</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2434">LWG 2434</a>: <code>shared_ptr::use_count()</code> is efficient</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2755">LWG 2755</a>: §[string.view.io] uses non-existent <code>basic_string_view::to_string</code> function</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2775.htm">N2775</a>: Small library thread-safety revisions</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3066.html">N3066</a>: Iterators in C++0x</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3966.html">N3966</a>: Fixes for <code>optional</code> objects (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4078.html">N4078</a>)</li>
<li>editorial change in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4714.html">N4714</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0134r0.html">P0134R0</a>: Introducing a name for <em>brace-or-equal-initializer</em>​s for non-static data members</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0583r0.pdf">P0583R0</a>: <code>std::byte</code> is the correct name</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1076r1.html">P1076R1</a>: Editorial clause reorganization <a href="https://github.com/cplusplus/draft/blob/master/papers/n4764.md">with modification</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0509r1">P0509R1</a>: Updating &quot;Restrictions on exception handling&quot; (adopted: accepted by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4664.pdf">N4664</a>)
<ul>
<li>see national body comments GB 41 and GB42 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4664.pdf">N4664</a>: ISO/IEC CD 14882, C++ 2017, National Body Comments</li>
</ul>
</li>
</ul>
<p>These post-C++03 draft resolutions would <strong>never</strong> be depended on because they are only intended useful for language implementations and there shall be no compatibility problems for conforming code (revised b593[2015-04-23]):</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2194.pdf">N2194</a>: <code>decltype</code> for the C++0x Standard Library</li>
</ul>
<h2 id="outdated"><a class="header" href="#outdated">Outdated</a></h2>
<p>These resolutions are only about TR1 or features have been formally deprecated/removed from current ISO C++, so shall never be depended on:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue527">LWG 527</a>: <code>tr1::bind</code> has lost its Throws clause</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue588">LWG 588</a>: requirements on zero sized <code>tr1::array</code>s and other details (for <code>std::array</code>, resolved by <a href="http://wg21.cmeerw.net/lwg/issue776">LWG 776</a>)</li>
</ul>
<p>These issues are duplicate (in &quot;dup&quot; status):</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue133">CWG 133</a>: Exception specifications and checking (subsumed by <a href="http://wg21.cmeerw.net/cwg/issue87">CWG 87</a> and <a href="http://wg21.cmeerw.net/cwg/issue92">CWG 92</a>)</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue595">CWG 595</a>: Exception specifications in templates instantiated from class bodies (subsumed by <a href="http://wg21.cmeerw.net/cwg/issue1330">CWG 1330</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1300">CWG 1300</a>: <code>T()</code> for array types (duplicate of <a href="http://wg21.cmeerw.net/cwg/issue914">CWG 914</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1568">CWG 1568</a>: Temporary lifetime extension with intervening cast (duplicate of <a href="http://wg21.cmeerw.net/cwg/issue1376">CWG 1376</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue479">LWG 479</a>: Container requirements and placement new (duplicate of <a href="http://wg21.cmeerw.net/lwg/issue580">LWG 580</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue486">LWG 486</a>: <code>min</code>/<code>max</code> CopyConstructible requirement is too strict (duplicate of <a href="http://wg21.cmeerw.net/lwg/issue281">LWG 281</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2775">LWG 2775</a>: <code>reverse_iterator</code> is does not compile for fancy pointers (duplicate of <a href="https://wg21.cmeerw.net/lwg/issue1052">LWG 1052</a>)</li>
</ul>
<p>These resolutions are superseded by later modification on the working paper:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue759">LWG 759</a>: A reference is not an object (see <a href="http://wg21.cmeerw.net/lwg/issue1204">LWG 1204</a>)</li>
</ul>
<p>These resolutions are overriden by later issues after publication:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue2022">CWG 2022</a>: Copy elision in constant expressions (overriden by <a href="https://wg21.cmeerw.net/cwg/issue2278">CWG 2278</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue235">LWG 235</a>: No specification of default ctor for <code>reverse_iterator</code> (overriden by <a href="https://wg21.cmeerw.net/lwg/issue1012">LWG 1012</a>)</li>
</ul>
<p>These resolutions are superseded and resolved by later issues before the publication:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue35">CWG 35</a>: Definition of default-initialization (see <a href="http://wg21.cmeerw.net/cwg/issue178">CWG 178</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2451">LWG 2451</a>: [fund.ts.v2] <code>optional&lt;T&gt;</code> should 'forward' <code>T</code>'s implicit conversions (see <a href="https://wg21.cmeerw.net/lwg/issue2756">LWG 2756</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2745">LWG 2745</a>: [fund.ts.v2] Implementability of <a href="https://wg21.cmeerw.net/lwg/issue2451">LWG 2451</a> (see <a href="https://wg21.cmeerw.net/lwg/issue2756">LWG 2756</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2753">LWG 2753</a>: Optional's constructors and assignments need constraints (see <a href="https://wg21.cmeerw.net/lwg/issue2756">LWG 2756</a>)</li>
<li><a href="https://issues.isocpp.org/show_bug.cgi?id=72">LEWG 72</a>: <code>bad_optional_access</code> should derive from <code>std::exception</code>, not <code>std::logic_error</code> (see <a href="https://wg21.cmeerw.net/lwg/issue2842">LWG 2806</a>)</li>
</ul>
<p>These papers are superseded and newer revisions have been reviewed, so no further actions would be taken:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1599.html">N1599</a>: <a href="https://wg21.cmeerw.net/lwg/issue431">Issue 431</a>: Swapping containers with unequal allocators (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2525.pdf">N2525</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1890.pdf">N1890</a>: Initialization and initializers (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1919.pdf">N1919</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1919.pdf">N1919</a>: Initializer lists (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2100.pdf">N2100</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1932.pdf">N1932</a>: Random Number Generation in C++0X: A Comprehensive Proposal (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2032.pdf">N2032</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1961.html">N1961</a>: Wording for range-based for-loop (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2196.html">N2196</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1968.pdf">N1968</a>: Lambda expressions and closures for C++ (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2329.pdf">N2329</a>: Lambda expressions and closures for C++ (Revision 1))</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2032.pdf">N2032</a>: Random Number Generation in C++0X: A Comprehensive Proposal, version 2 (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2079.pdf">N2079</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2062.html">N2062</a>: POD's Revisited (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2102.html">N2102</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2079.pdf">N2079</a>: Random Number Generation in C++0X: A Comprehensive Proposal, version 3 (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2111.pdf">N2111</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2100.pdf">N2100</a>: Initializer lists (Rev 2.) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2215.pdf">N2215</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2102.html">N2102</a>: POD's Revisited; Resolving Core Issue 568 (Revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2172.html">N2172</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2151.pdf">N2151</a>: Variadic Templates for the C++0x Standard Library (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2192.pdf">N2192</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2172.html">N2172</a>: POD's Revisited; Resolving Core Issue 568 (Revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2230.html">N2230</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2192.pdf">N2192</a>: Variadic Templates for the C++0x Standard Library (Revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2242.pdf">N2242</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2196.html">N2196</a>: Wording for range-based <code>for</code>-loop (revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2243.html">N2243</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2210.html">N2210</a>: Defaulted and Deleted Functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2326.html">N2326</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2202.html">N2202</a>: C99 Compatibility : <code>__func__</code> and predeclared identifiers (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2251.html">N2251</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2215.pdf">N2215</a>: Initializer lists (Rev. 3) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2385.pdf">N2385</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2217.pdf">N2217</a>: Placement Insert for Containers (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2268.pdf">N2268</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2230.html">N2230</a>: POD's Revisited; Resolving Core Issue 568 (Revision 3) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2294.html">N2294</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2236.pdf">N2236</a>: Towards support for attributes in C++ (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2379.pdf">N2379</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2243.html">N2243</a>: Wording for range-based <code>for</code>-loop (revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2394.html">N2394</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2251.html">N2251</a>: C99 Compatibility : <code>__func__</code> and predeclared identifiers (revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2340.htm">N2340</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2268.pdf">N2268</a>: Placement Insert for Containers (Revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2345.pdf">N2345</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2294.html">N2294</a>: POD's Revisited; Resolving Core Issue 568 (Revision 4) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2342.htm">N2342</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2326.html">N2326</a>: Defaulted and Deleted Functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2346.htm">N2346</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2329.pdf">N2329</a>: Lambda expressions and closures for C++ (Revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2413.pdf">N2413</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2345.pdf">N2345</a>: Placement Insert for Containers (Revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2642.pdf">N2642</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2379.pdf">N2379</a>: Towards support for attributes in C++ (Revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2418.pdf">N2418</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2385.pdf">N2385</a>: Initializer lists WP wording (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2531.pdf">N2531</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2394.html">N2394</a>: Wording for range-based <code>for</code>-loop (revision 3) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2778.htm">N2778</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2413.pdf">N2413</a>: Lambda Expressions and Closures: Wording for Monomorphic Lambdas (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2487.pdf">N2487</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2418.pdf">N2418</a>: Towards support for attributes in C++ (Revision 3) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2553.pdf">N2553</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2477.pdf">N2477</a>: Uniform initialization design choices (Revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2532.pdf">N2532</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2487.pdf">N2487</a>: Lambda Expressions and Closures: Wording for Monomorphic Lambdas (Revision 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2529.pdf">N2529</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2529.pdf">N2529</a>: Lambda Expressions and Closures: Wording for Monomorphic Lambdas (Revision 3) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2550.pdf">N2550</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2531.pdf">N2531</a>: Initializer lists WP wording (Revision 2) (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2575.pdf">N2575</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2532.pdf">N2532</a>: Uniform initialization design choices (Revision 2) (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2575.pdf">N2575</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2550.pdf">N2550</a>: Lambda Expressions and Closures: Wording for Monomorphic Lambdas (Revision 4) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2927.pdf">N2927</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2553.pdf">N2553</a>: Towards support for attributes in C++ (Revision 4) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2751.pdf">N2751</a>; the unavailable revised revision N2663 is wrong on <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/">document list</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2575.pdf">N2575</a>: Initializer Lists — Alternative Mechanism and Rationale (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2640.pdf">N2640</a>)</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2635.html">N2635</a>: Local and Unnamed Types as Template Arguments (revised as <a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2657.htm">N2657</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2640.pdf">N2640</a>: Initializer Lists — Alternative Mechanism and Rationale (v. 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2672.htm">N2672</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2642.pdf">N2642</a>: Proposed Wording for Placement Insert (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2680.pdf">N2680</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2751.pdf">N2751</a>: Towards support for attributes in C++ (Revision 5) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2761.pdf">N2761</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2778.htm">N2778</a>: Wording for range-based <code>for</code>-loop (revision 4) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2930.html">N2930</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2820.pdf">N2820</a>: Adding heterogeneous comparison lookup to associative containers (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2882.pdf">N2882</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2882.pdf">N2882</a>: Adding heterogeneous comparison lookup to associative containers for TR2 (Rev 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3465.pdf">N3465</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2904.pdf">N2904</a>: Defining default copy and move (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2953.html">N2953</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2953.html">N2953</a>: Defining Move Special Member Functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2987.html">N2987</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2987.html">N2987</a>: Defining Move Special Member Functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3044.html">N3044</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3044.html">N3044</a>: Defining Move Special Member Functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3053.html">N3053</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3149.html">N3149</a>: From <em>Throws: Nothing</em> to <code>noexcept</code> (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3195.htm">N3195</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3248.pdf">N3248</a>: <code>noexcept</code> Prevents Library Validation (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3279.pdf">N3279</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3433.html">N3433</a>: Clarifying Memory Allocation (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3537.html">N3537</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3465.pdf">N3465</a>: Adding heterogeneous comparison lookup to associative containers for TR2 (Rev 2) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3657.htm">N3657</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3537.html">N3537</a>: Clarifying Memory Allocation (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3664.html">N3664</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3597.html">N3597</a>: Relaxing constraints on <code>constexpr</code> functions (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3652.html">N3652</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3598.html">N3598</a>: <code>constexpr</code> member functions and implicit <code>const</code> (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3652.html">N3652</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3727.html">N3727</a>: A proposal to add <code>invoke</code> function template (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4169.html">N4169</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3873.html">N3873</a>: Improved insertion interface for unique-key maps (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4006.html">N4006</a> and <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4240.html">N4240</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4002.pdf">N4002</a>: Cleaning‐up <code>noexcept</code> in the Library (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4227.pdf">N4227</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4006.html">N4006</a>: An improved <code>emplace()</code> for unique-key maps (dropped; see other derivation of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3873.html">N3873</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4017.htm">N4017</a>: Non-member <code>size()</code> and more (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4155.htm">N4155</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4056.html">N4056</a>: Minimal incomplete type support for standard containers (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4371.html">N4371</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4151.html">N4151</a>: TriviallyCopyable <code>reference_wrapper</code> (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4277.html">N4277</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4155.htm">N4155</a>: Non-member <code>size()</code> and more (Revision 1) (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4280.pdf">N4280</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4227.pdf">N4227</a>: Cleaning-up noexcept in the Library (Rev 2) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4258.pdf">N4258</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4228.pdf">N4228</a>: Refining Expression Evaluation Order for Idiomatic C++ (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0145r0.pdf">P0145R0</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4240.html">N4240</a>: Improved insertion interface for unique-key maps (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4279.html">N4279</a>)</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2014/n4334.html">N4334</a>: Wording for <code>bool_constant</code> (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4389.html">N4389</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4371.html">N4371</a>: Minimal incomplete type support for standard containers, revision 2 (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4390.html">N4390</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4390.html">N4390</a>: Minimal incomplete type support for standard containers, revision 3 (revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4371.html">N4510</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4429.html">N4429</a>: Rewording inheriting constructors ((<a href="https://wg21.cmeerw.net/cwg/issue1941">core issue 1941</a> et al) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r0.html">P0136R0</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4446.html">N4446</a>: The missing <em><code>INVOKE</code></em> related trait (i.e. <code>is_callable</code>) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0077r0.html">P0077R2</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r0.html">P0136R0</a>: Rewording inheriting constructors ((<a href="https://wg21.cmeerw.net/cwg/issue1941">core issue 1941</a> et al) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r1.html">P0136R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0145r0.pdf">P0145R0</a>: Refining Expression Evaluation Order for Idiomatic C++ (Revision 1) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r1.pdf">P0145R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0068r0.pdf">P0068R0</a>: Proposal of <code>[[unused]]</code>, <code>[[nodiscard]]</code> and <code>[[fallthrough]]</code> attributes. (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0188r0.pdf">P0188R0</a> and <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0189r0.pdf">P0189R0</a> in parts, see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0212r0.pdf">P0212R0</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0077r0.html">P0077R0</a>: <code>is_callable</code>, the missing <em><code>INVOKE</code></em> related trait (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0077r1.html">P0077R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0077r1.html">P0077R1</a>: <code>is_callable</code>, the missing <em><code>INVOKE</code></em> related trait (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0077r2.html">P0077R2</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r1.pdf">P0145R1</a>: Refining Expression Evaluation Order for Idiomatic C++ (Revision 2) (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r2.pdf">P0145R2</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r2.pdf">P0145R2</a>: Refining Expression Evaluation Order for Idiomatic C++ (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r3.pdf">P0145R3</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0188r0.pdf">P0188R0</a>: Wording for <code>[[fallthrough]]</code> attribute. (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0188r1.pdf">P0188R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0189r0.pdf">P0189R0</a>: Wording for <code>[[nodiscard]]</code> attribute. (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0189r1.pdf">P0189R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0212r0.pdf">P0212R0</a>: Wording for <code>[[maybe_unused]]</code> attribute. (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0212r1.pdf">P0212R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0302r0.html">P0302R0</a>: Deprecating Allocator Support in <code>std::function</code> (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0302r1.html">P0302R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1089r2.pdf">P1089R2</a>: Sizes Should Only span Unsigned (see subseqent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1227r1.html">P1227R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p1227r0.html">P1227R0</a>: Signed <code>ssize()</code> functions, unsigned <code>size()</code> functions (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1227r1.html">P01227R1</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1227r1.html">P1227R1</a>: Signed <code>ssize()</code> functions, unsigned <code>size()</code> functions (revised by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1227r2.html">P01227R2</a>)</li>
</ul>
<p>These papers have been previously adopted but superseded by newer adopted papers, so no further actions would be taken:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2525.pdf">N2525</a>: Allocator-specific Swap and Move Behavior (adopted 2008-03, in editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2589.html">N2589</a>; revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2982.pdf">N2982</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3672.html">N3672</a>: A proposal to add a utility class to represent optional objects (Revision 4) (adopted 2013-04; revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3793.html">N3793</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0077r2.html">P0077R2</a>: <code>is_callable</code>, the missing <em><code>INVOKE</code></em> related trait (adopted 2016-02; revised as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0604r0.html">P0604R0</a>)</li>
</ul>
<p>These features were still under development but the approved versions were superseded (note that the superseded versions may still newer than currently adopted version), and not adopted in this document:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/ewg/issue22">EWG 22</a>: N4030, 3745, N3694 Feature-testing recommendations for C++, N3435 Standardized feature-test macros (for adopted version, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4200.htm">N4200</a>)
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3435.htm">N3435</a>: Standardized feature-test macros</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3694.htm">N3694</a>: Feature-testing recommendations for C++</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3745.htm">N3745</a>: Feature-testing recommendations for C++</li>
<li><a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2014/n4030.htm">N4030</a>: Feature-testing recommendations for C++</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2015/p0096r0.html">P0096R0</a>: Feature-testing recommendations for C++</li>
<li><a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2017/p0096r4.html">P0096R4</a>: Feature-testing recommendations for C++ (see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r0.html">P0941R0</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r0.html">P0941R0</a>: Integrating feature-test macros into the C++ WD</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r1.html">P0941R1</a>: Integrating feature-test macros into the C++ WD</li>
</ul>
</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2014/n3890.html">N3890</a>: <code>Container&lt;Incomplete Type&gt;</code> (partially superseded by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4056.html">N4056</a>)</li>
</ul>
<h2 id="revoked"><a class="header" href="#revoked">Revoked</a></h2>
<p>These features were once adopted by the working paper but later removed away, so no actions would be taken until introduced to the draft again:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1308">CWG 1308</a>: Completeness of class type within an exception-specification (see <a href="https://wg21.cmeerw.net/cwg/issue1330">CWG 1330</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue86">LWG 1029</a>: Specialized algorithms for memory management need to be concept-constrained templates </li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1001">LWG 1001</a>: Pointers, concepts and headers (see <a href="http://wg21.cmeerw.net/lwg/issue1178">LWG 1178</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2525.pdf">N2525</a>: Allocator-specific Swap and Move Behavior (i.e. <code>allocator_propagate_*</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2620.pdf">N2620</a>: Concepts for the C++0x Standard Library: Diagnostics library</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2736.pdf">N2736</a>: Concepts for the C++0x Standard Library: Numerics (Revision 3)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2755.htm">N2755</a>: Concepts for the C++0x Standard Library: Chapter 17 -Introduction (Revision 2)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2758.pdf">N2758</a>: Iterator Concepts for the C++0x Standard Library (Revision 5)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2759.pdf">N2759</a>: Concepts for the C++0x Standard Library: Algorithms (Revision 5)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2768.pdf">N2768</a>: Allocator Concepts, part 1 (revision 2)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2770.pdf">N2770</a>: Concepts for the C++0x Standard Library: Utilities (Revision 5)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2773.pdf">N2773</a>: Proposed Wording for Concepts (Revision 9)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2774.pdf">N2774</a>: Foundational Concepts for the C++0x Standard Library (Revision 5)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2776.pdf">N2776</a>: Concepts for the C++0x Standard Library: Containers (Revision 4)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2777.pdf">N2777</a>: Concepts for the C++0x Standard Library: Iterators (Revision 4)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2779.pdf">N2779</a>: Concepts for Clause 18: Part 2</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2780.pdf">N2780</a>: Named Requirements for C++0X Concepts, version 2</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2786.pdf">N2786</a>: Simplifying <code>unique_copy</code> (Revision 1)</li>
</ul>
<p>There are actions taken by the committee to remove away some former working draft features which are never used in this project:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2549.htm">N2549</a>: Excision of Clause 31 (i.e. <code>&lt;date_time&gt;</code>)</li>
</ul>
<h2 id="non-defects"><a class="header" href="#non-defects">Non defects</a></h2>
<p>These out-of-baseline issues are resolved as NAD:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1005">CWG 1005</a>: Qualified name resolution in member functions of class templates (see also <a href="http://wg21.cmeerw.net/cwg/issue1017">CWG 1017</a>; note <a href="http://wg21.cmeerw.net/cwg/issue515">CWG 515</a> is still effective)</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1334">CWG 1334</a>: Layout compatibility and cv-qualification</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue466">LWG 466</a>: <code>basic_string</code> ctor should prevent null pointer error</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue760">LWG 760</a>: The <code>emplace</code> issue (see <a href="http://wg21.cmeerw.net/lwg/issue2164">LWG 2164</a> which is still open)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue763">LWG 763</a>: Renaming <code>emplace()</code> overloads (<a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2680.pdf">N2680</a> renamed one of the overloads to <code>emplace_hint</code>; for related discussion see <a href="http://wg21.cmeerw.net/lwg/issue1302">LWG 1302</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1202">LWG 1202</a>: <code>integral_constant</code> needs a spring clean</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1302">LWG 1302</a>: different emplace semantics for sequence and associated containers</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2311">LWG 2311</a>: Allocator requirements should be further minimized</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2319">LWG 2319</a>: <code>basic_string</code>'s move constructor should not be <code>noexcept</code></li>
</ul>
<h2 id="not-applicable"><a class="header" href="#not-applicable">Not applicable</a></h2>
<p>Some proposals are not approved.</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3400.html">N3400</a>: A proposal for eliminating the underscore madness that library writers have to suffer</li>
</ul>
<p>Some proposals are not applicable yet and to be resolved in future. There also may be workaround provided by C++ implementation extensions or user code.</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2683.html">N2683</a>: issue 454: problems and solutions
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue454">LWG 454</a>: <code>basic_filebuf::open</code> should accept <code>wchar_t</code> names</li>
</ul>
</li>
</ul>
<h2 id="in-development"><a class="header" href="#in-development">In development</a></h2>
<p>These issues are in &quot;extension&quot; state and not ready to be adopted:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue476">CWG 476</a>: Determining the buffer size for placement new (see also <a href="https://wg21.cmeerw.net/cwg/issue256">CWG 256</a>)</li>
</ul>
<h1 id="adoption"><a class="header" href="#adoption">Adoption</a></h1>
<p>C++11 core language features and headers below now are being used.</p>
<p>Note: the &quot;adopted&quot; time notes listed in following entries are relative to working paper.</p>
<h2 id="imported-tr1-headers"><a class="header" href="#imported-tr1-headers">Imported TR1 Headers</a></h2>
<p>TR1(see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf">N1836</a>) headers imported to C++11 are used:</p>
<ul>
<li><code>&lt;array&gt;</code> (since b218[2011-06-14])</li>
<li><code>&lt;type_traits&gt;</code> (since b206[2011-05-03])</li>
<li><code>&lt;tuple&gt;</code> (since b206[2011-05-03])
<ul>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue1191">LWG 1191</a>: <code>tuple</code> <code>get</code> API should respect rvalues</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1382">LWG 1382</a>: <code>pair</code> and <code>tuple</code> constructors should forward arguments</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1384">LWG 1384</a>: Function <code>pack_arguments</code> is poorly named (i.e. <code>forward_as_tuple</code>; since b206[2011-05-03])</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2244.html">N2244</a>: Wording for <code>decay</code>, <code>make_pair</code> and <code>make_tuple</code></li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2299.html">N2299</a>: Concatenating <code>tuple</code>s, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">with modification</a> (since b303[2012-04-23])</li>
</ul>
</li>
<li><code>&lt;unordered_map&gt;</code> (since b206[2011-05-03])</li>
<li><code>&lt;unordered_set&gt;</code> (since b206[2011-05-03])</li>
</ul>
<h2 id="new-headers"><a class="header" href="#new-headers">New headers</a></h2>
<p>New headers after C++03 may be used.</p>
<h3 id="c11-baseline"><a class="header" href="#c11-baseline">C++11 baseline</a></h3>
<p>New non-TR1 headers from C++11 are used:</p>
<ul>
<li><code>&lt;atomic&gt;</code> (for all platforms from b590[2015-04-03]; for platforms supporting multithreading since b328[2011-07-25]; for platform MinGW32 since b299[2013-04-08])</li>
<li><code>&lt;chrono&gt;</code> (since b291[2012-03-07])</li>
<li><code>&lt;forward_list&gt;</code> (since b218[2011-06-14]; see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2543.htm">N2543</a>)</li>
<li><code>&lt;initializer_list&gt;</code> (since b297[2012-03-27]; see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2672.htm">N2672</a>)</li>
<li><code>&lt;typeindex&gt;</code> (since b468[2014-01-20])</li>
<li><code>&lt;regex&gt;</code> (since b795[2017-06-11])</li>
<li><code>&lt;system_error&gt;</code> (since b476[2014-02-16]; see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2241.html">N2241</a>)</li>
</ul>
<h3 id="multithreading"><a class="header" href="#multithreading">Multithreading</a></h3>
<p>For all implementations supporting multithreading, these headers are also used:</p>
<ul>
<li><code>&lt;condition_variable&gt;</code> (since b328[2011-07-25]; for platform MinGW32 since b299[2013-04-08])</li>
<li><code>&lt;future&gt;</code> (since b520[2014-07-23])</li>
<li><code>&lt;mutex&gt;</code> (since b328[2011-07-25]; for platform MinGW32 since b299[2013-04-08])</li>
<li><code>&lt;thread&gt;</code> (since b328[2011-07-25]; for platform MinGW32 since b299[2013-04-08])</li>
</ul>
<p>Note: <a href="http://wg21.cmeerw.net/lwg/issue1360">LWG 1360</a> specified single-threaded program should be able to use <code>&lt;atomic&gt;</code>, and resolved by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3256.html">N3256</a>. However, the current YSLib doesn't require it for single-threaded programs.</p>
<h3 id="beyond-c11"><a class="header" href="#beyond-c11">Beyond C++11</a></h3>
<p>For rules of baseline, new headers are only used conditionally, mostly for avoiding need of replacements in non-C++11 modes where the specified headers are available.</p>
<ul>
<li>`&lt;memory_resource&gt; (since b842[2018-10-27]
<ul>
<li>replacement provided by <code>&lt;ystdex/memory_resource.h&gt;</code> if not available</li>
</ul>
</li>
<li>`&lt;string_view&gt; (since b833[2018-07-31]
<ul>
<li>replacement provided by <code>&lt;ystdex/string_view.hpp&gt;</code> if not available</li>
</ul>
</li>
<li><code>&lt;optional&gt;</code> (since b831[2018-07-13])
<ul>
<li>replacement provided by <code>&lt;ystdex/optional.h&gt;</code> if not available
<ul>
<li>with parts of <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0032r3.pdf">P0032R3</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="technical-specifications"><a class="header" href="#technical-specifications">Technical Specifications</a></h2>
<p>Technical Specifications are retargetted to standards finally. Not all features are used until they are adopted to the standard draft.</p>
<h3 id="tr1"><a class="header" href="#tr1">TR1</a></h3>
<p>TR1 features was once used, but now retired and corresponding ISO C++ features shall be used, since they are imported from TR1 (see editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2008.html">N2008</a>) (since b206[2011-05-03]):</p>
<ul>
<li>TR1 <code>&lt;type_traits&gt;</code> including metafunctions and <code>std::tr1::aligned_storage</code> (since b175[2010-12-23])
<ul>
<li>replaced by C++11 <code>std::aligned_storage</code>, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2341.pdf">N2341</a> (since b206[2011-05-03])</li>
</ul>
</li>
<li>TR1 <code>&lt;memory&gt;</code> <code>std::tr1::shared_ptr</code> (since b203[2011-04-22])
<ul>
<li>replaced by C++11 <code>std::shared_ptr</code> (since b206[2011-05-03])</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue545">LWG 545</a>: When is a deleter deleted?, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded slightly</a></li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue575">LWG 575</a>: the specification of <code>~shared_ptr</code> is MT-unfriendly, makes implementation assumptions, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded slightly</a></li>
<li>see also <a href="http://wg21.cmeerw.net/lwg/issue611">LWG 611</a></li>
</ul>
</li>
</ul>
<p>Some TR1 features are not used, as C++11 features are used instead:</p>
<ul>
<li>TR1 <code>&lt;memory&gt;</code> <code>std::tr1::function</code> is preferred by <code>std::function</code> (since b207[2011-05-09])
<ul>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2132">LWG 2132</a>: <code>std::function</code> ambiguity</li>
</ul>
</li>
</ul>
<h3 id="other-tses"><a class="header" href="#other-tses">Other TSes</a></h3>
<p>Although not used directly for evolution rules, some adopted modifications have already in the final draft of technical specifications:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4480.html">N4480</a>: Programming Languages — C++ Extensions for Library Fundamentals
<ul>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4288.html">N4288</a>: Strike <code>string_view::clear</code> from Library Fundamentals (adopted 2014-11)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4562.html">N4562</a>: Working Draft, C++ Extensions for Library Fundamentals, Version 2
<ul>
<li>parts on <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3793.html">N3793</a>: A proposal to add a utility class to represent optional objects (Revision 5)
<ul>
<li>revised previously-adopted <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3672.html">N3672</a>: A proposal to add a utility class to represent optional objects (Revision 4) (adopted 2013-04)
<ul>
<li>moved to Library TS by LWG motion 6 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3769.pdf">N3769</a></li>
</ul>
</li>
</ul>
</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3765.pdf">N3765</a>: On Optional</li>
<li>based on <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4282.pdf">N4282</a>: A Proposal for the World's Dumbest Smart Pointer, v4</li>
</ul>
</li>
</ul>
<p>They are listed here for exposition-only use. The actual adoption depends on items depending them on.</p>
<h2 id="adopted-changes"><a class="header" href="#adopted-changes">Adopted changes</a></h2>
<p>Features adopted shall be compatible with rules for general status.</p>
<h3 id="to-be-reviewd"><a class="header" href="#to-be-reviewd">To be reviewd</a></h3>
<p>These pre-C++11 resolutions are believed have been relied on. It is yet to determine the &quot;since&quot; cluase (reviewed b865[2019-08-30]).</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue624">CWG 624</a>: Overflow in calculating size of allocation (see also <a href="https://wg21.cmeerw.net/cwg/issue476">CWG 476</a>)
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue256">CWG 256</a>: overflow calculating size of new array</li>
</ul>
</li>
</ul>
<h3 id="restrictive-improvement"><a class="header" href="#restrictive-improvement">Restrictive improvement</a></h3>
<p>The conformance of following lists of clearer specification with probable stronger restrictions (to the implementation and program-provided code including this project) or fixed specifications aligned with all existed implementations are concerned and took into account (revised b865[2019-08-17]).</p>
<p>For specifications before C++11:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue96">CWG 96</a>: Syntactic disambiguation using the <code>template</code> keyword</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue201">LWG 201</a>: Numeric limits terminology wrong</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue220">CWG 220</a>: require de-allocation not throw</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue274">LWG 274</a>: a missing/impossible allocator requirement (partially overriden by <a href="https://wg21.cmeerw.net/lwg/issue2447">LWG 2447</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue294">LWG 294</a>: User defined macros and standard headers</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue300">LWG 300</a>: <code>list::merge()</code> specification incomplete</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue386">LWG 386</a>: Reverse iterator's <code>operator[]</code> has impossible return type</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue416">LWG 416</a>: definitions of <code>XXX_MIN</code> and <code>XXX_MAX</code> macros in <code>climits</code>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded slightly</a></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue422">LWG 422</a>: explicit specializations of member functions of class templates, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded slightly</a></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue456">LWG 456</a>: Traditional C header files are overspecified</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue420">LWG 420</a>: is <code>std::FILE</code> a complete type?</li>
</ul>
<p>For specifications between C++11 and C++14:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1376">CWG 1376</a>: <code>static_cast</code> of temporary to rvalue reference (see also <a href="http://wg21.cmeerw.net/cwg/1568">CWG 1568</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1430">CWG 1430</a>: Pack expansion into fixed alias template parameter list</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1493">CWG 1493</a>: Criteria for move-construction</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1570">CWG 1570</a>: Address of subobject as non-type template argument</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1596">CWG 1596</a>: Non-array objects as <code>array[1]</code></li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1629">CWG 1629</a>: Can a closure class be a literal type?</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1672">CWG 1672</a>: Layout compatibility with multiple empty bases</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1751">CWG 1751</a>: Non-trivial operations vs non-trivial initialization</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1885">CWG 1885</a>: Return value of a function is underspecified</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2013">LWG 2013</a>: Do library implementers have the freedom to add <code>constexpr</code>? (see also <a href="http://stackoverflow.com/questions/22182432/is-gcc-considering-builtins-of-non-constant-expression-functions-to-be-constant">here</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2014">LWG 2014</a>: More restrictions on macro names</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2447">LWG 2447</a>: Allocators and <code>volatile</code>-qualified value types</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3436.html">N3436</a>: <code>std::result_of</code> and SFINAE</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3644.pdf">N3644</a>: Null Forward Iterators (adopted 2013-04)</li>
</ul>
<p>For specifications between C++14 and C++17:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2129">LWG 2129</a>: User specializations of <code>std::initializer_list</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2139">LWG 2139</a>: What is a <em>user-defined</em> type?</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2150">LWG 2150</a>: Unclear specification of <code>find_end</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2419">LWG 2419</a>: Clang's libc++ extension to <code>std::tuple</code>
<ul>
<li>resolved by <a href="https://wg21.cmeerw.net/lwg/issue2312">LWG 2312</a> and <a href="https://wg21.cmeerw.net/lwg/issue2549">LWG 2549</a></li>
</ul>
</li>
</ul>
<p>For specification beyond C++17 (including drafting and WP state):</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue2256">CWG 2256</a>: Lifetime of trivially-destructible objects</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue3140">LWG 3140</a>: <code>COMMON_REF</code> is unimplementable as specified (adopted 2018-11, in editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4792.html">N4792</a>)</li>
</ul>
<h3 id="deprecation"><a class="header" href="#deprecation">Deprecation</a></h3>
<p>Features in the following adopted deprecation are <strong>not</strong> depended on (revised b863[2019-08-01]):</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0174r2.html">P0174R2</a>: Deprecating Vestigial Library Parts in C++17 (adopted 2016-06; since b835[2018-08-13])</li>
<li>deprecation of <code>shared_ptr</code> <code>unique</code> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0521r0.html">P0521R0</a>: Proposed Resolution for CA 14 (<code>shared_ptr</code> <code>use_count</code>/<code>unique</code>) (adopted 2016-11; since b835[2018-08-14])
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2776">LWG 2776</a>: <code>shared_ptr</code> <code>unique()</code> and <code>use_count()</code></li>
<li>see national body comment <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf#CA14">CA 14</a> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf">P0488R0</a>: WG21 Working Paper, NB Comments, ISO/IEC CD 14882</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0767r1.html">P0767R1</a>: Deprecate POD
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue2323">CWG 2323</a>: Expunge POD</li>
<li>see national body comment <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf#US101">US 101</a> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf">P0488R0</a>: WG21 Working Paper, NB Comments, ISO/IEC CD 14882 (adopted 2017-11; since b853[2018-02-15])</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0806r2.html">P0806R2</a>: Deprecate implicit capture of <code>this</code> via <code>[=]</code> (adopted 2018-06)</li>
</ul>
<h3 id="removal"><a class="header" href="#removal">Removal</a></h3>
<p>Several features removed in C++17 are <strong>not</strong> depended on (revised b853[2019-02-15]):</p>
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue2385">LWG 2385</a>: <code>function::assign</code> allocator argument doesn't make sense</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2487">LWG 2487</a>: <code>bind()</code> should be <code>const</code>-overloaded, not <em>cv</em>-overloaded
<ul>
<li>in libstdc++ this is an extension (although declared deprecated by <code>_GLIBCXX_DEPR_BIND</code>) but the implementation (<code>std::__volget</code>) is essentially not type-safe (with <code>const_cast</code> to remove <code>volatile</code> in the calls)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0302r1.html">P0302R1</a>: Removing Allocator Support in <code>std::function</code> (rev 1) (adopted 2016-06)
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2308.html">N2308</a>: Adding allocator support to <code>std::function</code> for C++0x, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">with modification</a></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2370">LWG 2370</a>: Operations involving type-erased allocators should not be <code>noexcept</code> in <code>std::function</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2501">LWG 2501</a>: <code>std::function</code> requires POCMA/POCCA</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2502">LWG 2502</a>: <code>std::function</code> does not use allocator::construct</li>
<li>see also the replacement <code>ystdex::function</code></li>
</ul>
</li>
</ul>
<h3 id="c11-features"><a class="header" href="#c11-features">C++11 features</a></h3>
<p>C++11 library features used indirectly (not mandated, but with design in mind that could make more interface usable, e.g. macro substitution or template instantiations):</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2761.pdf">N2761</a>: Towards support for attributes in C++ (Revision 6)</li>
</ul>
<p>Other C++11 core and library features used directly (without the features the program will either be ill-formed or has unexpected behavior for some input allowed by the API):</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue45">CWG 45</a>: Access to nested classes (since b273[2012-01-01])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue8">CWG 8</a>: Access to template arguments used in a function return type and in the nested name specifier</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue10">CWG 10</a>: Can a nested class access its own class name as a qualified name if it is a private member of the enclosing class?</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue87">CWG 87</a>: Exception specifications on function parameters (see also <a href="https://wg21.cmeerw.net/cwg/issue25">CWG 25</a>, <a href="https://wg21.cmeerw.net/cwg/issue92">CWG 92</a> and <a href="https://wg21.cmeerw.net/cwg/issue133">CWG 133</a>; since b249[2011-10-15])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue208">CWG 208</a>: Rethrowing exceptions in nested handlers (since b461[2013-12-23])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue222">CWG 222</a>: Sequence points and lvalue-returning operators (since b297[2012-03-27])
<ul>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue637">CWG 637</a>: Sequencing rules and example disagree</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue226">CWG 226</a>: Default template arguments for function templates (since b387[2013-03-11])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue254">CWG 254</a>: Exception types in clause 19 are constructed from <code>std::string</code> (since b643[2015-10-08]; i.e. <code>const char*</code> parameter in constructor of standard exception classes)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue302">CWG 302</a>: Value-initialization and generation of default constructor (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue339">CWG 339</a>: Overload resolution in operand of <code>sizeof</code> in constant expression (since b591[2015-04-10])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue382">CWG 382</a>: Allow <code>typename</code> outside of templates (since b421[2013-07-03])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue542">CWG 542</a>: Value initialization of arrays of POD-structs (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue49">LWG 49</a>: Underspecification of <code>ios_base::sync_with_stdio</code> (since b599[2015-05-21])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue280">LWG 280</a>: Comparison of <code>reverse_iterator</code> to <code>const reverse_iterator</code> (since b408[2013-05-30])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue438">LWG 438</a>: Ambiguity in the &quot;do the right thing&quot; clause (since b274[2012-01-04])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue611">LWG 611</a>: Standard library templates and incomplete types (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue765">CWG 765</a>: Local types in inline functions with external linkage (since b282[2012-02-04])
<ul>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue1157">LWG 1157</a>: Local types can now instantiate templates</li>
<li>with extra assumption of the identity of types in function templates or in functions of class templates across translation units <a href="http://stackoverflow.com/questions/34717823/can-using-a-lambda-in-header-files-violate-the-odr/34721371#34721371">which is potentially a core language defect</a>
<ul>
<li>see also <a href="Development.zh-CN.html">here(zh-CN)</a> for detailed explanation and requiremnts on implementation</li>
</ul>
</li>
<li>applied to <a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2657.htm">N2657</a></li>
<li>applied to <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2927.pdf">N2927</a></li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1104">CWG 1104</a>: Global-scope template arguments vs the <code>&lt;:</code> digraph (since b493[2014-04-16])</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1330">CWG 1330</a>: Delayed instantiation of <code>noexcept</code> specifiers (since b792[2017-06-05])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue49">LWG 49</a>: Underspecification of <code>ios_base::sync_with_stdio</code> (since b565[2015-01-16])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue91">LWG 91</a>: Description of <code>operator&gt;&gt;</code> and <code>getline()</code> for <code>string&lt;&gt;</code> might cause endless loop (since b663[2015-12-18])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue130">LWG 130</a>: Return type of <code>container::erase(iterator)</code> differs for associative containers (since b216[2011-06-08])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue254">LWG 254</a>: Exception types in clause 19 are constructed from <code>std::string</code> (since b643[2015-10-08])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue265">LWG 265</a>: <code>std::pair::pair()</code> effects overly restrictive (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue371">LWG 371</a>: Stability of <code>multiset</code> and <code>multimap</code> member functions (since b216[2011-06-08])
<ul>
<li>see also <a href="http://wg21.cmeerw.net/lwg/issue130">LWG 130</a></li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue376">LWG 376</a>: <code>basic_streambuf</code> semantics (since b616[2015-07-21])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue419">LWG 419</a>: istream extractors not setting failbit if eofbit is already set (since b437[2015-01-16])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue453">LWG 453</a>: <code>basic_stringbuf::seekoff</code> need not always fail for an empty stream (since b617[2015-07-25])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue534">LWG 534</a>: Missing <code>basic_string</code> members (i.e. <code>basic_string</code> <code>pop_back</code>, <code>back</code> and <code>front</code>; since b315[2012-06-08])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue559">LWG 559</a>: <code>numeric_limits&lt;const T&gt;</code>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded slightly</a> (since b440[2013-08-29])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue564">LWG 564</a>: <code>stringbuf</code> <code>seekpos</code> underspecified (since b743[2016-11-21])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue589">LWG 589</a>: Requirements on iterators of member template functions of containers (since b216[2011-06-08])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue596">LWG 596</a>: 27.8.1.3 Table 112 omits <code>&quot;a+&quot;</code> and <code>&quot;a+b&quot;</code> modes (since b326[2012-07-19])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue704">LWG 704</a>: MoveAssignable requirement for container value type overly strict (since b206[2011-05-03])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue711">LWG 711</a>: Contradiction in empty <code>shared_ptr</code> (since b784[2017-04-29])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue762">LWG 762</a>: <code>std::unique_ptr</code> requires complete type? (since b238[2011-09-07])</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue811">LWG 811</a>: <code>pair</code> of pointers no longer works with literal <code>0</code> (since b206[2011-05-03])
<ul>
<li>partially superseded when <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4387.html">N4387</a> is conditonally used</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue868">LWG 868</a>: Default construction and value-initialization (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue771">LWG 771</a>: Impossible throws clause in [string.conversions] (since b375[2013-01-22])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue772">LWG 772</a>: Impossible return clause in [string.conversions] (since b375[2013-01-22])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue806">LWG 806</a>: <code>unique_ptr::reset</code> effects incorrect, too permissive (since b206[2011-05-03])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue809">LWG 809</a>: <code>std::swap</code> should be overloaded for array types (since b620[2015-08-02])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue817">LWG 817</a>: <code>bind</code> needs to be moved (since b401[2013-05-02])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue900">LWG 900</a>: Stream move-assignment (tentatively since b620[2015-08-01]; since b727[2016-09-17])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue911">LWG 911</a>: I/O streams and move/swap semantic (tentatively since b620[2015-08-01]; since b727[2016-09-17])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue922">LWG 922</a>: [func.bind.place] Number of placeholders (since b437[2013-08-22])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue929">LWG 929</a>: Thread constructor (since b384[2013-03-01])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue993">LWG 993</a>: <code>_Exit</code> needs better specification (since b565[2015-01-16])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1019">LWG 1019</a>: Make <code>integral_constant</code> objects useable in <em>integral-constant-expression</em>​s (since b590[2015-04-10])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1040">LWG 1040</a>: Clarify possible sameness of associative container's <code>iterator</code> and <code>const_iterator</code> (since b496[2014-05-01])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1178">LWG 1178</a>: Header dependencies (since b338[2012-09-13])
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue343">LWG 343</a>: Unspecified library header dependencies (see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2259.html">N2259</a>)</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1192">LWG 1192</a>: <code>basic_string</code> missing definitions for <code>cbegin</code> / <code>cend</code> / <code>crbegin</code> / <code>crend</code> (since b546[2014-10-17])</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1382">LWG 1382</a>: <code>pair</code> and <code>tuple</code> constructors should forward arguments (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1626.pdf">N1626</a>: Proposed Resolution for Core Issue 39 (Rev. 1) (since b447[2013-09-25])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue39">CWG 39</a>: Conflicting ambiguity rules</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1653.htm">N1653</a>: Working draft changes for C99 preprocessor synchronization (since b257[2011-11-04]; used GCC extensions previously for variadic macros and empty macro arguments only)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2004/n1720.html">N1720</a>: Proposal to Add Static Assertions to the Core Language (Revision 3) (since b206[2011-05-03])
<ul>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue676">CWG 676</a>: <em>static_assert-declaration</em>​s and general requirements for declarations</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1757.html">N1757</a>: Right Angle Brackets (Revision 1) (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1780.html">N1780</a>: Comments on LWG issue 233: Insertion hints in associative containers (since b216[2011-06-08])
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue233">LWG 233</a>: Insertion hints in associative containers</li>
<li>see also <a href="http://wg21.cmeerw.net/lwg/issue371">LWG 371</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1811.pdf">N1811</a>: Adding the <code>long long</code> type to C++ (Revision 3) (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1822.pdf">N1822</a>: A Proposal to add a max significant decimal digits value to the C++ Standard Library Numeric limits (since b260[2011-11-12]; i.e. <code>numeric_limits::max_digits10</code>)
<ul>
<li>without <a href="http://wg21.cmeerw.net/lwg/issue613">LWG 613</a>: <code>max_digits10</code> missing from <code>numeric_limits</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1836.pdf">N1836</a>: Draft Technical Report on C++ Library Extensions (Built-in type traits) (since b206[2011-05-03])
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1182">LWG 1182</a>: Unfortunate <code>hash</code> dependencies</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1255">LWG 1255</a>: <code>declval</code> should be added to the library (since b260[2011-11-14])</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1270">LWG 1270</a>: <code>result_of</code> should be moved to <code>&lt;type_traits&gt;</code> (since b245[2011-09-23])</li>
</ul>
</li>
<li><code>cbegin</code>/<code>cend</code>/<code>crbegin</code>/<code>crend</code> from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1913.pdf">N1913</a>: A Proposal to Improve <code>const_iterator</code> Use (version 2) (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2005/n1858.html">N1858</a>: Rvalue Reference Recommendations for Chapter 23, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded</a> (since b216[2011-06-08])
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue759">LWG 759</a> superseded by <a href="http://wg21.cmeerw.net/lwg/issue1204">LWG 1204</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1984.pdf">N1984</a>: Deducing the type of variable from its initializer expression (revision 4) (since b206[2011-05-03]; i.e. <code>auto</code>-typed variables)
<ul>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue615">CWG 615</a>: Incorrect description of variables that can be initialized</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1986.pdf">N1986</a>: Delegating Constructors (revision 3) (since b311[2011-05-25])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1987.htm">N1987</a>: Adding &quot;<code>extern template</code>&quot; (version 2) (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2179.html">N2179</a>: Language Support for Transporting Exceptions between Threads (since b538[2014-09-28]; i.e. <code>exception_ptr</code> and <code>current_exception</code>, etc)
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue829">LWG 829</a>: <code>current_exception</code> wording unclear about exception type</li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1130">LWG 1130</a>: <code>copy_exception</code> name misleading (i.e. <code>make_exception_ptr</code>; since b550[2014-11-04])</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3195.htm">N3195</a>: From <em>Throws: Nothing</em> to <code>noexcept</code> (version 2)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2235.pdf">N2235</a>: Generalized Constant Expressions—Revision 5 (since b246[2011-09-23]; i.e. <code>constexpr</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2238.html">N2238</a>: Minimal Unicode support for the standard library (revision 3) (since b253[2011-10-18])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2239.html">N2239</a>: A finer-grained alternative to sequence points (revised) (since b297[2012-03-27]; notably order of aggregate initialization, see also <a href="http://wg21.cmeerw.net/cwg/issue1030">CWG 1030</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2240.html">N2240</a>: Two missing traits: <code>enable_if</code> and <code>conditional</code>, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">added specification when <code>B</code> is <code>false</code></a> (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2241.html">N2241</a>: Diagnostics Enhancements for C++0x (Rev. 1), <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded</a> (since b476[2014-02-16]; i.e. <code>&lt;system_error&gt;</code>)
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue805">LWG 805</a>: <code>posix_error::posix_errno</code> concerns (since b550[2014-11-04]; i.e. <code>errc</code>) </li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2242.pdf">N2242</a>: Proposed Wording for Variadic Templates (Revision 2) (since b251[2011-10-08])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2244.html">N2244</a>: Wording for <code>decay</code>, <code>make_pair</code> and <code>make_tuple</code> (since b206[2011-05-03])</li>
<li>features from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2246.html">N2246</a>: 2 of the least crazy ideas for the standard library in C++0x (i.e. <code>next</code>/<code>prev</code>/<code>is_sorted_until</code>/<code>is_heap_until</code>)
<ul>
<li><code>next</code>/<code>prev</code> (since b375[2013-01-22])</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2249.html">N2249</a>: New Character Types in C++, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">library part reworded</a> (since b253[2011-10-18])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2255.html">N2255</a>: Minor Modifications to the type traits Wording Revision 2, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2283.html">reworded</a> (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2258.pdf">N2258</a>: Templates Aliases (since b433[2013-08-01])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2259.html">N2259</a>: Specify header dependency for <code>&lt;iostream&gt;</code> (since b338[2012-09-13]; see also <a href="http://wg21.cmeerw.net/lwg/issue343">LWG 343</a>)</li>
<li>features(e.g. <code>alignof</code>) from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2341.pdf">N2341</a>: Adding Alignment Support to the C++ Programming Language / Wording
<ul>
<li><code>std::aligned_storage</code> used instead of <code>std::tr1::aligned_storage</code> since b206[2011-05-03]</li>
<li>other features except <code>std::aligned_union</code> used since b315[2012-06-08]</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2342.htm">N2342</a>: POD's Revisited; Resolving Core Issue 568 (Revision 5) (since b206[2011-05-03])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue543">CWG 543</a>: Value initialization and default constructors</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue568">CWG 568</a>: Definition of POD is too strict</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2343.pdf">N2343</a>: Decltype (revision 7) (since b206[2011-05-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2346.htm">N2346</a>: Defaulted and Deleted Functions (since b207[2011-05-05])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2347.pdf">N2347</a>: Strongly Typed Enums (revision 3), <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">with modification</a> (since b261[2011-11-19])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2348.pdf">N2348</a>: Wording for <code>std::numeric_limits&lt;T&gt;::lowest()</code> (since b242[2011-09-16])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2349.pdf">N2349</a>: Constant Expressions in the Standard Library — Revision 2, <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2370.html">with modification</a> (since b260[2011-11-12])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2350.pdf">N2350</a>: Container <code>insert</code>/<code>erase</code> and iterator constness (Revision 1) (since b531[2014-08-31])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2351.htm">N2351</a>: Improving <code>shared_ptr</code> for C++0x, Revision 2 (i.e. <code>make_shared</code> etc; since b529[2014-08-24])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2431.pdf">N2431</a>: A name for the null pointer: <code>nullptr</code> (revision 4) (since b206[2011-05-03]; compatible layer introduced since b204[2011-04-26])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2437.pdf">N2437</a>: Explicit Conversion Operator Draft Working Paper (revision 3) (since b260[2011-11-15])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2439.htm">N2439</a>: Extending move semantics to <code>*this</code> (revised wording) (since b591[2015-04-11])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2442.htm">N2442</a>: Raw and Unicode String Literals; Unified Proposal (Rev. 2)
<ul>
<li>unicode string literals used since b253[2011-10-18]</li>
<li>raw string literals used since b431[2013-07-23]</li>
<li>other features used since b434[2013-08-04]</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2530.html">N2530</a>: Making It Easier to Use <code>std::type_info</code> as an Index in an Associative Container (since b468[2014-01-20]; i.e. <code>type_info::hash_code</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2535.htm">N2535</a>: Namespace Association (&quot;<code>inline namespace</code>&quot;) (since b427[2013-07-11])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2540.htm">N2540</a>: Inheriting Constructors (revision 5) (since b538[2014-09-24])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2541.htm">N2541</a>: New Function Declarator Syntax Wording (since b207[2011-05-05])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2543.htm">N2543</a>: STL singly linked lists (revision 3) (since b218[2011-06-04]; i.e. <code>&lt;forward_list&gt;</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2544.pdf">N2544</a>: Unrestricted Unions (Revision 2) (since b569[2015-01-29])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2546.pdf">N2546</a>: Removal of <code>auto</code> as a storage-class specifier (since b206[2011-05-03])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue629">CWG 629</a>: <code>auto</code> parsing ambiguity </li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2559.htm">N2559</a>: Nesting Exception Objects (Revision 1) (since b477[2014-02-19])
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue819">LWG 819</a>: <code>rethrow_if_nested</code></li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1136">LWG 1136</a>: Incomplete specification of <code>nested_exception::rethrow_nested()</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2634.html">N2634</a>: Solving the SFINAE problem for expressions (since b591[2015-04-10])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue339">CWG 339</a>: Overload resolution in operand of <code>sizeof</code> in constant expression</li>
</ul>
</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2008/n2657.htm">N2657</a>: Local and Unnamed Types as Template Arguments (since b206[2011-05-03])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue488">CWG 488</a>: Local types, overload resolution, and template argument deduction</li>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue765">CWG 765</a> above</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2659.htm">N2659</a>: Thread-Local Storage (since b425[2013-07-08])
<ul>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue810">CWG 810</a>: Block-scope <code>thread_local</code> variables should be implicitly <code>static</code> (since b425[2013-07-08])</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2672.htm">N2672</a>: Initializer List proposed wording (since b297[2012-03-27])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1030">CWG 1030</a>: Evaluation order in initializer-lists used in aggregate initialization (since b297[2012-03-27]; see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2239.html">N2239</a>)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2680.pdf">N2680</a>: Proposed Wording for Placement Insert (Revision 1) (since b286[2012-02-19])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2709.html">N2709</a>: Packaging Tasks for Asynchronous Execution (since b520[2014-07-23]; i.e. <code>packaged_task</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2756.htm">N2756</a>: Non-static data member initializers (since b360[2013-04-29])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2764.pdf">N2764</a>: Forward declaration of enumerations (rev. 3) (since b658[2015-12-08])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2844.html">N2844</a>: Fixing a Safety Problem with Rvalue References: Proposed Wording (Revision 1) (since b206[2011-05-03])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1138">CWG 1138</a>: Rvalue-ness check for rvalue reference binding is wrong (since b206[2011-05-03])</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2927.pdf">N2927</a>: New wording for C++0x Lambdas (rev. 2) (since b212[2011-05-27])
<ul>
<li>with <a href="http://wg21.cmeerw.net/cwg/issue765">CWG 765</a> above</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2930.html">N2930</a>: Range-Based For Loop Wording (Without Concepts) (since b316[2011-06-11])</li>
<li>features from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2982.pdf">N2982</a>: Allocators post Removal of C++ Concepts (Rev 1)
<ul>
<li><code>std::addressof</code> used since b288[2012-02-26]
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue970">LWG 970</a>: <code>addressof</code> overload unneeded</li>
</ul>
</li>
<li><code>std::allocator_traits</code> except propagation traits used since b592[2015-04-19]</li>
<li>propagation traits in <code>std::allocator_traits</code> used since b830[2018-07-08]
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue431">LWG 431</a>: Swapping containers with unequal allocators</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3050.html">N3050</a>: Allowing Move Constructors to Throw (Rev. 1) (since b319[2012-06-24]; i.e. <code>noexcept</code> and <code>std::move_if_noexcept</code>)
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1349">LWG 1349</a>: <code>swap</code> should not throw</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3180.htm">N3180</a>: More on <code>noexcept</code> for the Strings Library (since b329[2012-08-05])</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3279.pdf">N3279</a>: Conservative use of <code>noexcept</code> in the Library (since b461[2013-12-23])</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3052.html">N3052</a>: Converting Lambdas to Function Pointers (since b360[2012-12-07])</li>
<li>features except in <code>&lt;type_traits&gt;</code> from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3053.html">N3053</a>: Defining Move Special Member Functions (since b230[2011-08-07])
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue1309">LWG 1309</a>: Missing expressions for Move/CopyConstructible
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue1283">LWG 1283</a>: MoveConstructible and MoveAssignable need clarification of moved-from state </li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3143.html">N3143</a>: Proposed wording for US 90 (since b206[2011-05-03]; i.e. <code>std::forward</code>)</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2010/n3168.htm">N3168</a>: Problems with Iostreams Member Functions (Amended from US 137) (since b805[2017-09-26])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3189.htm">N3189</a>: Observers for the three <em>handler functions</em> (since b550[2014-11-04])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3272.htm">N3272</a>: Follow-up on <code>override</code> control (since b311[2011-05-25])</li>
</ul>
<h2 id="tentatively-applied"><a class="header" href="#tentatively-applied">Tentatively applied</a></h2>
<p>All adopted changes are confirmed being included in the newest working paper and would not be removed in future unless they are not in the working paper or published standard any longer.</p>
<h3 id="platform-dependent-features"><a class="header" href="#platform-dependent-features">Platform-dependent features</a></h3>
<p>Some features only are relied in platform-dependent implementation details where all of supported platforms of the project has been confirmed to support. Currently (revised b848[2018-12-24]) there are none.</p>
<h3 id="conditionally-used-features"><a class="header" href="#conditionally-used-features">Conditionally used features</a></h3>
<p>Some C++11 features are not requried to reduce compatibility impact on implementations, but can be utilized when available, i.e. used <strong>conditionally</strong> (by conditional inclusion or being transparent):</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2340.htm">N2340</a>: C99 Compatibility : <code>__func__</code> and predeclared identifiers (revision 2) (since b638[2015-09-24])</li>
</ul>
<p>Some post-C++11 features are used <strong>conditionally</strong>:</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue616">CWG 616</a>: Definition of “indeterminate value” (since b663[2016-01-11]) (see also <a href="http://wg21.cmeerw.net/cwg/issue1213">CWG 1213</a>)
<ul>
<li>without <a href="http://wg21.cmeerw.net/cwg/issue129">CWG 129</a>: Stability of uninitialized auto variables</li>
<li>without <a href="http://wg21.cmeerw.net/cwg/issue240">CWG 240</a>: Uninitialized values and undefined behavior (see also <a href="http://wg21.cmeerw.net/cwg/issue129">CWG 129</a>)
<ul>
<li>without <a href="http://www.open-std.org/jtc1/sc22/wg14/www/docs/dr_338.htm">WG14/DR338</a></li>
</ul>
</li>
<li>without <a href="http://wg21.cmeerw.net/cwg/issue312">CWG 312</a>: “use” of invalid pointer value not defined (see also <a href="http://wg21.cmeerw.net/cwg/issue623">CWG 623</a>)</li>
<li>without <a href="http://wg21.cmeerw.net/cwg/issue623">CWG 623</a>: Use of pointers to deallocated storage (see also <a href="http://wg21.cmeerw.net/cwg/issue623">CWG 312</a>)</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1581">CWG 1581</a>: When are <code>constexpr</code> member functions defined? (since b834[2016-08-03])</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1558">CWG 1558</a>: Unused arguments in alias template specializations (since b653[2015-11-25]; see also <a href="http://wg21.cmeerw.net/cwg/issue1430">CWG 1430</a>, <a href="http://wg21.cmeerw.net/cwg/issue1520">CWG 1520</a> and <a href="http://wg21.cmeerw.net/cwg/issue1554">CWG 1554</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2285">LWG 2285</a>: <code>make_reverse_iterator</code> (since b595[2015-05-01])
<ul>
<li>replaced by <code>ystdex::make_reverse_iterator</code> conditionally since b833[2018-07-29]</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3421.htm">N3421</a>: Making Operator Functors <code>greater&lt;&gt;</code> (since b679[2016-03-19]; see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3657.htm">N3657</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3478.html">N3478</a>: Core Issue 1512: Pointer comparison vs qualification conversions (since b562[2014-12-22])
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue73">CWG 73</a>: Pointer equality </li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1512">CWG 1512</a>: Pointer comparison vs qualification conversions</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3493.html">N3493</a>: Compile-time integer sequences (since b589[2015-04-03])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3652.html">N3652</a>: Relaxing constraints on <code>constexpr</code> functions/<code>constexpr</code> member functions and implicit <code>const</code> (adopted 2013-04; since b591[2015-04-15])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3655.pdf">N3655</a>: TransformationTraits Redux, v2 (since b595[2015-05-01])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3656.htm">N3656</a>: <code>make_unique</code> (Revision 1) (since b617[2015-07-23])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3657.htm">N3657</a>: Adding heterogeneous comparison lookup to associative containers (rev 4) (adopted 2013-04; rev 3 not in the list)
<ul>
<li>without <code>is_transparent</code> since b678[2016-03-17]</li>
<li>with <code>is_transparent</code> since b679[2016-03-19]</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3671.html">N3671</a>: Making non-modifying sequence operations more robust: Revision 2 (since b627[2015-08-30])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3778.html">N3778</a>: C++ Sized Deallocation (since b842[2018-10-29])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4169.html">N4169</a>: A proposal to add <code>invoke</code> function template (Revision 1) (since b617[2015-07-23])</li>
<li><code>pair</code> constructors improvement in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4387.html">N4387</a>: Improving <code>pair</code> and <code>tuple</code>, revision 3 (adopted 2015-05; since b850[2019-01-14])
<ul>
<li>missed in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4528.html">N4528</a>, see <a href="https://github.com/cplusplus/draft/commit/c8347e3f3caa2ecef1b1dd869ce15b9095134a1a">this commit</a>.</li>
<li><strong>without</strong> <a href="https://wg21.cmeerw.net/lwg/issue2051">LWG 2051</a>: Explicit <code>tuple</code> constructors for more than one parameter</li>
<li><strong>without</strong> partially addressed <a href="https://wg21.cmeerw.net/lwg/issue2312">LWG 2312</a>: <code>tuple</code>'s constructor constraints need to be phrased more precisely</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2397">LWG 2397</a>: <code>map::emplace</code> and explicit <code>V</code> constructors
<ul>
<li>see also <a href="https://wg21.cmeerw.net/ewg/issue114">EWG 114</a>: N4074 Let <code>return {expr}</code> Be Explicit, Revision 2, N4131 explicit should never be implicit, N4094 Response To: Let <code>return {expr}</code> Be Explicit, N4029 Let return Be Direct and <code>explicit</code>, N3452 (unpublished) Let <code>{x,y,z}</code> =&gt; <code>explicit</code> (resolved as NAD)</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4389.html">N4389</a>: Wording for <code>bool_constant</code>, revision 1 (since b617[2015-07-23])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0188r1.pdf">P0188R1</a>: Wording for <code>[[fallthrough]]</code> attribute. (adopted 2016-02; since b793[2017-06-06])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0189r1.pdf">P0189R1</a>: Wording for <code>[[nodiscard]]</code> attribute. (adopted 2016-02; since b823[2018-07-26])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0212r1.pdf">P0212R1</a>: Wording for <code>[[maybe_unused]]</code> attribute. (adopted 2016-02; since b823[2018-07-26])</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0386r2.pdf">P0386R2</a>: Inline Variables (adopted 2016-06; since b831[2018-07-13])</li>
<li>part (with only the signature available in C++11) of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0674r1.html">P0674R1</a>: Extending <code>make_shared</code> to Support Arrays (adopted 2017-07; since b849[2018-12-30])
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2070">LWG 2070</a>: <code>allocate_shared</code> should use <code>allocator_traits::construct</code></li>
</ul>
</li>
</ul>
<h3 id="feature-testing"><a class="header" href="#feature-testing">Feature testing</a></h3>
<p>Following Feature Testing study group (SD-6 recommendations approved by SG 10) documents after <a href="http://wg21.cmeerw.net/ewg/issue22">EWG 22</a> have been reviewed, with some of them applied or updated:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4200.htm">N4200</a>: Feature-testing recommendations for C++ (since b591[2015-04-15]; i.e. <code>__has_cpp_attribute</code>, etc; see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4440.html">N4440</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4440.html">N4440</a>: Feature-testing recommendations for C++ (superseded)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4535.html">N4535</a>: Feature-testing preprocessor predicates for C++17 (i.e. <code>__has_include</code> and <code>__has_cpp_attribute</code>, see below)
<ul>
<li>for <code>__has_include</code>, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0061r1.html">P0061R1</a> below</li>
<li><code>__has_cpp_attribute</code> adopted, as <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4200.htm">N4200</a> above
<ul>
<li>this is now in the <a href="http://eel.is/c++draft/cpp.cond#nt:has-attribute-expression">working draft</a>, though not in the list of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/">official page</a> as of b831[2018-07-13]</li>
<li>adopted by CWG motion 15 in editor's report <a href="https://github.com/cplusplus/draft/blob/master/papers/n4764.md">N4764</a></li>
<li>see <a href="http://www.open-std.org/pipermail/features/2014-March/000163.html">discussion here</a> for motivation</li>
</ul>
</li>
<li>see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r1.html">P0941R1</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0096r1.html">P0096R1</a>: Feature-testing recommendations for C++ (since b679[2016-03-20]; see subsequent <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r0.html">P0941R0</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0941r2.html">P0941R2</a>: Integrating feature-test macros into the C++ WD (rev. 2) (since b831[2018-07-12])</li>
</ul>
<p>Following documents override feature testing paper which is incorporated into the standard draft as normative features:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0061r1.html">P0061R1</a>: <code>__has_include</code> for C++17 (adopted 2015-10; since b831[2018-07-12])</li>
</ul>
<p>Some additional feature testing support are also <strong>conditionally</strong> reviewd. Some are already extensions of Clang++ and other implementations for several revisions. The identifiers with <code>__has_</code> in following list are being used and considered for conditional inclusion:</p>
<ul>
<li><code>__has_attribute</code> since b628[2015-09-01], after in macro detection candidate list since b492[2014-04-10]</li>
<li><code>__has_builtin</code> since b535[2014-09-14]</li>
<li><code>__has_extension</code> and <code>__has_feature</code> since b484[2013-03-09]</li>
</ul>
<h2 id="tentatively-not-applied"><a class="header" href="#tentatively-not-applied">Tentatively not applied</a></h2>
<h3 id="used-deprecations"><a class="header" href="#used-deprecations">Used deprecations</a></h3>
<p>There are no features eventually removed in future versions of ISO C++ are yet to be resolved currently.</p>
<h3 id="workarounds"><a class="header" href="#workarounds">Workarounds</a></h3>
<p>Several acknowledged but not adopted (by the draft) issues (revised b834[2018-07-31]) are assumed not effect user code with workarounds provided by implementations, including:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2472">LWG 2472</a>: Heterogeneous comparisons in the standard library can result in ambiguities
<ul>
<li>no effect on YStandardEx replacement as there is no <code>std::rel_ops</code>-like operators in namespace <code>ystdex</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2858">LWG 2858</a>: LWG 2472: actually an incompatibility with C++03 (see <a href="https://wg21.cmeerw.net/lwg/issue280">LWG 280</a>)
<ul>
<li>no effect on <code>ystdex::reversed_iterator</code></li>
</ul>
</li>
</ul>
<h3 id="primarily-replaceable"><a class="header" href="#primarily-replaceable">Primarily replaceable</a></h3>
<p>The following features are not relied on, but confirmed still being compatible, with further rules to incooperate:</p>
<ul>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0551r3.pdf">P0551R3</a>: Thou Shalt Not Specialize <code>std</code> Function Templates! (adopted 2018-03)
<ul>
<li>though not relied on, any of the entities overloadable with standard components as the subset of the <em>direct replacements</em> specified in following clauses conform to the definition of the term <em>customization point</em> specified here</li>
<li><em>designated customization point</em> is extended to any direct replacments implicitly (i.e. a direct replacement is also implied to be customized by user code if it comforms to a designated customization point specified here), or explicitly following the designation otherwise specified by the interface documentation and with further rules to be intercooperated</li>
</ul>
</li>
</ul>
<p>The following changes about standard library are not depended on, but were considered some replacements have been used as forcing the requirements for implementations other than using of YStandardEx replacements:</p>
<ul>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4258.pdf">N4258</a>: Cleaning up noexcept in the Library (Rev 3) (adopted 2014-11)
<ul>
<li>only for part of <code>noexcept</code> which is <strong>not</strong> exclusively covered by the applying specified below, as <code>noexcept</code> can be added in user-code by introducing new classes meets the changes here like direct replacements (e.g. inheriting the base containers) when direct replacements is <strong>not</strong> yet provided by YStandardEx</li>
</ul>
</li>
</ul>
<h3 id="replaced-directly"><a class="header" href="#replaced-directly">Replaced directly</a></h3>
<p>These post-C++11 library features are <strong>not</strong> depended on <strong>currently</strong> (revised b865[2018-08-23]) but direct replacements (to be used <strong>conditionally</strong> once the draft standard is approved) are provided in YBase:</p>
<ul>
<li>parts of <a href="https://wg21.cmeerw.net/lwg/issue1234">LWG 1234</a>: &quot;Do the right thing&quot; and <code>NULL</code>
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
<li>see also dedicated <code>ystdex::list</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2108">LWG 2108</a>: No way to identify allocator types that always compare equal
<ul>
<li>with part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4258.pdf">N4258</a>: Cleaning-up <code>noexcept</code> in the Library (Rev 3)</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2467">LWG 2467</a>: <code>is_always_equal</code> has slightly inconsistent default</li>
<li><code>std::allocator_tratits::is_always_equal</code> is provided as member of <code>ystdex::allocator_traits</code>; see also dedicated <code>ystdex::map</code> for one of the drop-in replacements</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2188">LWG 2188</a>: Reverse iterator does not fully support targets that overload <code>operator&amp;</code>
<ul>
<li>replaced by <code>ystdex::reverse_iterator</code></li>
<li>adopted by LWG motion 3 in editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3938.html">N3938</a> with editorial fix</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2268">LWG 2268</a>: Setting a default argument in the declaration of a member function assign of <code>std::basic_string</code>
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
</ul>
</li>
<li>parts of <a href="https://wg21.cmeerw.net/lwg/issue2193">LWG 2193</a>: Default constructors for standard library containers are explicit
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
<li>see also dedicated <code>ystdex::map</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2247">LWG 2247</a>: Type traits and <code>std::nullptr_t</code>
<ul>
<li>replaced by <code>ystdex::is_null_pointer</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2296">LWG 2296</a>: <code>std::addressof</code> should be <code>constexpr</code>
<ul>
<li>replaced by <code>ystdex::addressof</code> <strong>with compatibility excptions</strong>
<ul>
<li>implemented in a best effort way: <code>constepxr</code> works with most usual but not all cases like C++17 due to compatibility limitations where no <code>__builtin_addressof</code> is supported by the implementation</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2598">LWG 2598</a>: <code>addressof</code> works on temporaries</li>
</ul>
</li>
<li>adopted by part of LWG motion 16 in editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4583.html">N4583</a></li>
</ul>
</li>
<li>part of <a href="https://wg21.cmeerw.net/lwg/issue2455">LWG 2455</a>: Allocator default construction should be allowed to throw
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2579">LWG 2579</a>: Inconsistency wrt Allocators in <code>basic_string</code> assignment vs. <code>basic_string::assign</code>
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2583">LWG 2583</a>: There is no way to supply an allocator for <code>basic_string(str, pos)</code>
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2778">LWG 2778</a>: <code>basic_string_view</code> is missing constexpr
<ul>
<li>replaced by <code>ystdex::basic_string_view</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2788">LWG 2788</a>: <code>basic_string</code> range mutators unintentionally require a default constructible allocator
<ul>
<li>replaced by <code>ystdex::basic_string</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2812">LWG 2812</a>: Range access is available with <code>&lt;string_view&gt;</code>
<ul>
<li>replaced by <code>&quot;string_view.hpp&quot;</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3911.pdf">N3911</a>: TransformationTrait Alias <code>void_t</code>
<ul>
<li>replaced by <code>void_t</code> in namespace <code>ystdex::cpp2017</code>, with workaround for <a href="http://wg21.cmeerw.net/cwg/issue1558">CWG 1558</a></li>
<li>see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3843.pdf">N3843</a> for motivation</li>
</ul>
</li>
<li>parts of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4258.pdf">N4258</a> (adopted 2014-11)
<ul>
<li>replaced by <code>ystdex::allocator_traits::is_always_equal</code>; see <a href="https://wg21.cmeerw.net/lwg/issue2108">LWG 2108</a></li>
<li>replaced by <code>ystdex::basic_string</code></li>
<li>see also dedicated <code>ystdex::map</code></li>
<li>see also <a href="https://wg21.cmeerw.net/lwg/issue2455">LWG 2455</a> of change on <code>std::vector</code> (<strong>not replaced</strong>)</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4277.html">N4277</a>: TriviallyCopyable <code>reference_wrapper</code> (Revision 1)
<ul>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0357r2.html">P0357R2</a>: <code>reference_wrapper</code> for incomplete types</li>
<li>replaced by <code>ystdex::lref</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4280.pdf">N4280</a>: Non-member <code>size()</code> and more (Revision 2) (adopted 2014-11)
<ul>
<li>replaced by <code>size</code>, <code>empty</code> and <code>data</code> in namespace <code>ystdex::cpp2017</code> conforming to designated customization point specified by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0551r3.pdf">P0551R3</a>, also <code>ystdex::range_size</code> with addtional interface for <code>std::initializer_list</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4436.pdf">N4436</a>: Proposing Standard Library Support for the C++ Detection Idiom
<ul>
<li>partially replaced by <code>is_detected</code>, <code>detected_t</code>, <code>detected_or</code>, <code>detected_or_t</code>, <code>is_detected_exact</code> and <code>is_detected_convertile</code> in namespace <code>ystdex</code></li>
</ul>
</li>
<li><code>std::experimental::fundamentals_v2::observer_ptr</code> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4562.html#memory.observer.ptr">N4562</a>
<ul>
<li>replaced feature based on <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4282.pdf">N4282</a>: A Proposal for the World's Dumbest Smart Pointer, v4</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0007r1.html">P0007R1</a>: Constant View: A proposal for a <code>std::as_const</code> helper function template (adopted 2015-11)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0013r1.html">P0013R1</a>: Logical Operator Type Traits (revision 1) (adopted 2015-10)
<ul>
<li>replaced by <code>conjunction</code>, <code>disjunction</code> and <code>negation</code> in namespace <code>ystdex</code>, based on <code>and_</code>, <code>or_</code> and <code>not_</code> (see dedicated replacements below)</li>
</ul>
</li>
<li>parts of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0031r0.html">P0031R0</a>: A Proposal to Add Constexpr Modifiers to <code>reverse_iterator</code>, <code>move_iterator</code>, <code>array</code> and Range Access
<ul>
<li>partially replaced by <code>reverse_iterator</code>, <code>begin</code>, <code>cbegin</code>, <code>end</code>, <code>cend</code>, <code>rbegin</code>, <code>crbegin</code>, <code>rend</code> and <code>crend</code> in namespace <code>ystdex</code></li>
<li>adopted by part of LWG motion 16 in edtitor report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4583.html">N4583</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0091r3.html">P0091R3</a>: Template argument deduction for class templates (Rev. 6) (adopted 2016-06)</li>
<li>interface in headers <code>&lt;optional&gt;</code>, <code>&lt;string_view&gt;</code> and <code>&lt;memory_resource&gt;</code> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0220r1.html">P0220R1</a>: Adopt Library Fundamentals V1 TS Components for C++17 (R1)
<ul>
<li><code>&lt;optional&gt;</code> replaced by <code>&lt;ystdex/optional.hpp&gt;</code>
<ul>
<li><code>std::bad_optional_access</code> replaced by <code>ystdex::bad_optional_access</code></li>
<li><code>std::optional</code> replaced by <code>ystdex::cpp2017::optional</code></li>
</ul>
</li>
<li><code>&lt;string_view&gt;</code> replaced by <code>&lt;ystdex/string_view.hpp&gt;</code>
<ul>
<li><code>std::basic_string_view</code> replaced by <code>ystdex::cpp2017::basic_string_view</code></li>
<li><code>std::string_view</code> replaced by <code>ystdex::cpp2017::string_view</code></li>
<li><code>std::wstring_view</code> replaced by <code>ystdex::cpp2017::wstring_view</code></li>
<li><code>std::u16string_view</code> replaced by <code>ystdex::cpp2017::u16string_view</code></li>
<li><code>std::u32string_view</code> replaced by <code>ystdex::cpp2017::u32string_view</code></li>
</ul>
</li>
<li><code>&lt;memory_resource&gt;</code> replaced by <code>&lt;ystdex/memory_resource.h&gt;</code>
<ul>
<li><code>std::pmr::memory_resource</code> replaced by <code>ystdex::pmr::cpp2017::memory_resource</code></li>
<li><code>std::pmr::polymorphic_allocator</code> replaced by <code>ystdex::pmr::cpp2017::polymorphic_allocator</code></li>
<li><code>std::pmr::new_delete_resource</code> replaced by <code>ystdex::pmr::cpp2017::new_delete_resource</code></li>
<li><code>std::pmr::null_memory_resource</code> replaced by <code>ystdex::pmr::cpp2017::null_memory_resource</code></li>
<li><code>std::pmr::set_default_resource</code> replaced by <code>ystdex::pmr::cpp2017::set_default_resource</code></li>
<li><code>std::pmr::get_defualt_resource</code> replaced by <code>ystdex::pmr::cpp2017::get_defualt_resource</code></li>
<li><code>std::pmr::pool_options</code> replaced by <code>ystdex::pmr::pool_options</code></li>
<li><code>std::pmr::cpp2017::synchronized_pool_resource</code> replaced by <code>ystdex::pmr::cpp2017::synchronized_pool_resource</code></li>
<li><code>std::pmr::unsynchronized_pool_resource</code> replaced by <code>ystdex::pmr::cpp2017::unsynchronized_pool_resource</code></li>
<li><code>std::pmr::monotonic_buffer_resource</code> replaced by <code>ystdex::pmr::cpp2017::monotonic_buffer_resource</code></li>
</ul>
</li>
<li><code>std::apply</code> in <code>&lt;tuple&gt;</code> replaced by <code>ystdex::apply</code>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3915.pdf">N3915</a>: <code>apply()</code> call a function with arguments from a tuple (V3) (adopted 2014-02)</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2418">LWG 2418</a>: [fund.ts] <code>apply</code> does not work with member pointers</li>
</ul>
</li>
<li>partially adopted by LWG motion 6 in editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4583.html">N4583</a>
<ul>
<li><code>&lt;optional&gt;</code>, <code>&lt;string_view&gt;</code>, <code>&lt;memory_resource&gt;</code> and <tuple> in parts of LWG motion 6: <a href="http://wg21.link/p0220r1">P0220R1</a> &quot;Adopt library fundamentals v1 TS components for C++17&quot;) (incompletely applied from <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4562.html">N4562</a>)</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2283">LWG 2283</a>: [fund.ts] <code>optional</code> declares and then does not define an <code>operator&lt;() </code> (this is actually targetting <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3691.pdf">the standard draft</a>, not <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4023.html#optional.comp_with_t">the library fundmental draft</a>)</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4078.html">N4078</a>: Fixes for <code>optional</code> objects (adopted 2014-06)</li>
</ul>
</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0254r2.pdf">P0254R2</a>: Integrating <code>std::string_view</code> and <code>std::string</code> (adopted 2016-06, by LWG motion 14 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4603.html">N4603</a>)
<ul>
<li>replaced by <code>ystdex::basic_string</code> and <code>ystdex::basic_string_view</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2742">LWG 2742</a>: Inconsistent string interface taking <code>string_view</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2758">LWG 2758</a>: <code>std::string{}.assign(&quot;ABCDE&quot;, 0, 1)</code> is ambiguous
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2757">LWG 2757</a>: <code>std::string{}.insert(3, &quot;ABCDE&quot;, 0, 1)</code> is ambiguous</li>
</ul>
</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2771">LWG 2771</a>: Broken Effects of some <code>basic_string::compare</code> functions in terms of <code>basic_string_view</code> (see <a href="https://wg21.cmeerw.net/lwg/issue2758">LWG 2758</a>)</li>
</ul>
</li>
<li>with <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0337r0.html">P0337R0</a>: Delete <code>operator=</code> for <code>polymorphic_allocator</code> (adopted by LWG motion 26 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4603.html">N4603</a>)</li>
<li>with changes on <code>pmr::memory_resource</code> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0619r4.html">P0619R4</a></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2724">LWG 2724</a>: The <code>protected virtual</code> member functions of <code>memory_resource</code> should be <code>private</code></li>
<li>conditionally with <a href="https://wg21.cmeerw.net/lwg/issue2740">LWG 2740</a>: <code>constexpr optional&lt;T&gt;::operator-&gt;</code>
<ul>
<li>only with <code>constexpr addressof</code> (i.e. since C++17 or with some extensions)</li>
</ul>
</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2756">LWG 2756</a>: C++ WP <code>optional&lt;T&gt;</code> should '<code>forward</code>' <code>T</code>'s implicit conversions </li>
<li><strong>without</strong> <a href="https://wg21.cmeerw.net/lwg/issue2825">LWG 2825</a>: <a href="https://wg21.cmeerw.net/lwg/issue2756">LWG 2756</a> breaks class template argument deduction for optional, as the resolution need <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0091r4.html">deduction guides</a> unsupported here yet</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2842">LWG 2806</a>: Base class of <code>bad_optional_access</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2842">LWG 2842</a>: <code>in_place_t</code> check for <code>optional::optional(U&amp;&amp;)</code> should decay <code>U</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2843">LWG 2843</a>: Unclear behavior of <code>std::pmr::memory_resource::do_allocate()</code></li>
<li>with part (for <code>optional</code>) of <a href="https://wg21.cmeerw.net/lwg/issue2857">LWG 2857</a>: <code>{variant,optional,any}::emplace</code> should return the constructed value 
<ul>
<li>partially replaced by <code>ystdex::any</code></li>
</ul>
</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2900">LWG 2900</a>: The copy and move constructors of <code>optional</code> are not <code>constexpr</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2961">LWG 2961</a>: Bad postcondition for <code>set_default_resource</code> (similart to <a href="https://wg21.cmeerw.net/lwg/issue2522">LWG 2522</a> targetting Library Fundamentals V2)</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2969">LWG 2969</a>: <code>polymorphic_allocator::construct()</code> shouldn't pass <code>resource()</code></li>
<li>with parts (concerned with <code>polymorphic_allocator</code>) of <a href="https://wg21.cmeerw.net/lwg/issue2975">LWG 2975</a>: Missing case for pair construction in scoped and polymorphic allocators</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue3000">LWG 3000</a>: <code>monotonic_memory_resource::do_is_equal</code> uses <code>dynamic_cast</code> unnecessarily</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue3036">LWG 3036</a>: <code>polymorphic_allocator::destroy</code> is extraneous</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue3037">LWG 3037</a>: <code>polymorphic_allocator</code> and incomplete types</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue3038">LWG 3038</a>: <code>polymorphic_allocator::allocate</code> should not allow integer overflow to create vulnerabilities</li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue3113">LWG 3113</a>: <code>polymorphic_allocator::construct()</code> should more closely match <code>scoped_allocator_adaptor::construct()</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0185r1.html">P0185R1</a> Adding [<code>nothrow</code>-]<code>swappable</code> traits, revision 3 (adopted 2016-02)
<ul>
<li>replaced by <code>is_swappable_with</code>, <code>is_swappable</code>, <code>is_nothrow_swappable_with</code> and <code>is_nothrow_swappable</code> in namespace <code>ystdex</code>, and <code>swap</code> in namespace <code>ystdex_swap</code> (see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0879r0.html">P0879R0</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2456">LWG 2456</a>: Incorrect exception specifications for '<code>swap</code>' throughout library</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2554">LWG 2554</a>: Swapping multidimensional arrays is never <code>noexcept</code></li>
<li>see also <a href="https://wg21.cmeerw.net/lwg/issue2766">LWG 2766</a></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0209r2.pdf">P0209R2</a> <code>make_from_tuple</code>: <code>apply</code> for construction (adopted 2016-06, by LWG motion 23 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/n4603.html">N4603</a>)
<ul>
<li>replaced by <code>ystdex::make_from_tuple</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0298r3.pdf">P0298R3</a>: A byte type definition 
<ul>
<li>replaced by <code>ystdex::byte</code>, except when the core language support unavailable before C++17, where the name is provided as an alias of <code>unsigned char</code></li>
<li>see also <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0583r0.pdf">P0583R0</a>.</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0318r1.pdf">P0318R1</a>: <code>unwrap_ref_decay</code> and <code>unwrap_reference</code> (adopted 2018-11)
<ul>
<li>replaced by <code>ystdex::unwrap_ref_decay</code> and <code>ystdex::unwrap_reference</code>, with extensions for <code>ystdex::lref</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0550r2.pdf">P0550R2</a>: Transformation Trait <code>remove_cvref</code>
<ul>
<li>replaced by <code>ystdex::remove_cvref</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0604r0.html">P0604R0</a>: Resolving GB 55, US 84, US 85, US 86 (adopted 2017-03)
<ul>
<li>partially replaced by <code>invoke_result</code>, <code>invoke_result_t</code>, <code>is_invocable</code>, <code>is_invocable_r</code>, <code>is_nothrow_invocable</code> and <code>is_nothrow_invocable_r</code> in namespace <code>ystdex::cpp2017</code></li>
<li>revised previously-adopted <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0077r2.html">P0077R2</a>: <code>is_callable</code>, the missing <em><code>INVOKE</code></em> related trait (adopted 2016-02)</li>
<li>GB 55, US 84, US 85, US 86 accepted with modifications in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4664.pdf">N4664</a></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2017">LWG 2017</a>: <code>std::reference_wrapper</code> makes incorrect usage of <code>std::result_of</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2021">LWG 2021</a>: Further incorrect usages of <code>result_of</code></li>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2219">LWG 2219</a>: <em><code>INVOKE</code></em>-ing a pointer to member with a reference_wrapper as the object expression</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2767">LWG 2767</a>: <code>not_fn</code> call_wrapper can form invalid types</li>
</ul>
</li>
<li>all new function templates in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0591r4.pdf">P0591R4</a>: Utility functions to implement uses-allocator construction (adopted 2018-11)
<ul>
<li><code>std::uses_allocator_construction_args</code> replaced by <code>ystdex::uses_allocator_construction_args</code></li>
<li><code>std::make_obj_using_allocator</code> replaced by <code>ystdex::make_obj_using_allocator</code></li>
<li><code>std::uninitialized_construct_using_allocator</code> replaced by <code>ystdex::uninitialized_construct_using_allocator</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0607r0.html">P0607R0</a>: Inline Variables for the Standard Library
<ul>
<li>depends on <a href="http://wg21.cmeerw.net/cwg/issue1713">CWG 1713</a>), the &quot;minimalistic suggestion&quot; and &quot;additional suggestion&quot; in paper are fully (both) taken in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4659.pdf">N4659</a>, which is not explicitly indicated by the editor's report <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/n4661.html">N4661</a></li>
<li>partially replaced by <code>ystdex::nullopt</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0619r4.html">P0619R4</a>: Reviewing Deprecated Facilities of C++17 for C++20
<ul>
<li><code>std::reference_wrapper</code> partially replaced by <code>ystdex::lref</code></li>
<li><code>std::iterator</code> is not used (see also <a href="https://wg21.cmeerw.net/lwg/issue2438">LWG 2438</a>)</li>
<li>changes on <code>std::pmr::memory_resource</code> is implemented for <code>ystdex::pmr::memory_resource</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0653r2.html">P0653R2</a>: Utility to convert a pointer to a raw pointer (adopted 2017-11)
<ul>
<li><code>std::to_address</code> is replaced by <code>ystdex::to_address</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0879r0.html">P0879R0</a>: Constexpr for <code>swap</code> and <code>swap</code> related functions
<ul>
<li>partially replaced by <code>swap</code> in namespace <code>ystdex_swap</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2800">LWG 2800</a>: <code>constexpr</code> <code>swap</code></li>
<li>this is now in the <a href="https://raw.githubusercontent.com/cplusplus/draft/master/papers/n4762.pdf">working draft</a>, though not in the list of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/">official page</a> as of b834[2018-08-03]</li>
<li>adopted by LWG motion 21 in editor's report <a href="https://github.com/cplusplus/draft/blob/master/papers/n4764.md">N4764</a></li>
</ul>
</li>
</ul>
<p>Some applied resolution also works on replacements, listed here for exposition-only use:</p>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue280">LWG 280</a>: Comparison of <code>reverse_iterator</code> to <code>const reverse_iterator</code>
<ul>
<li>partially replaced by <code>ystdex::reverse_iterator</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue386">LWG 386</a>: Reverse iterator's <code>operator[]</code> has impossible return type
<ul>
<li>replaced by <code>ystdex::reverse_iterator::operator[]</code></li>
</ul>
</li>
</ul>
<h3 id="replaced-alternatively"><a class="header" href="#replaced-alternatively">Replaced alternatively</a></h3>
<p>These features were once adopted by the working paper but later removed away, and further actions different to the committee are considered by this project for practical reasons (e.g. compatibility and availability in lack of other features):</p>
<ul>
<li>parts of <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0032r3.pdf">P0032R3</a>: Homogeneous interface for <code>variant</code>, <code>any</code> and <code>optional</code> (Revision 3) (adopted 2016-06)
<ul>
<li>see national body comment CH 3 relavent to parts of <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0032r3.pdf">P0032R3</a> in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0488r0.pdf">P0488R0</a>: WG21 Working Paper, NB Comments, ISO/IEC CD 14882</li>
<li>see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0504r0.html">P0504R0</a>: Revisiting in-place tag types for <code>any</code>/<code>optional</code>/<code>variant</code></li>
<li>removed by <a href="https://github.com/cplusplus/draft/commit/d2d23690a253b91fb7ccb1631581bd9c8f2937d2">this commit</a></li>
<li>this is not always taken in the direct replacements in <code>namespace ystdex::cpp2017</code> to avoid impaction from lack of varaible template support</li>
</ul>
</li>
</ul>
<h3 id="replaced-dedicately"><a class="header" href="#replaced-dedicately">Replaced dedicately</a></h3>
<p>There are several core language issues are resolved by YDefinition core language compatiblitiy features <strong>conditioanlly</strong>, even though they may be still not adopted or even without a concrete proposed resolution currently (revised b835[2018-08-14]):</p>
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue2097">CWG 2097</a>: Lambdas and <code>noreturn</code> attribute</li>
</ul>
<p>There are several YBase features which can <strong>currently</strong> (revised b831[2018-07-11]) be used as replacement for similar post-C++11 library features. See also <a href="Features.zh-CN.html">Features(zh-CN)</a>.</p>
<ul>
<li><code>ystdex::and_</code>, <code>ystdex::or_</code> and <code>ystdex::not_</code> are provided to replace logical operation traits introduced in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0013r1.html">P0013R1</a>
<ul>
<li>currently aliases of them are also direct replacements in namespace <code>cpp2017</code></li>
</ul>
</li>
<li><code>ystdex::lref</code> is provided as a replacement for <code>std::reference_wrapper</code> with less verbosity
<ul>
<li>supports <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4277.html">N4277</a>: TriviallyCopyable <code>reference_wrapper</code> (Revision 1)</li>
<li>otherwise mostly same to <code>boost::reference_wrapper</code> besides its name and <code>constexpr</code> requirements (needing core language support)
<ul>
<li>no deprecated members of <code>std::reference_wrapper</code>, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0619r4.html">P0619R4</a>: Reviewing Deprecated Facilities of C++17 for C++20</li>
<li>supports incomplete value type, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0357r2.html">P0357R2</a></li>
<li>not same type to any instance of <code>std::reference_wrapper</code> so not treated specially by <code>std::bind</code> and other <code>std</code> API</li>
</ul>
</li>
<li>with part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0604r0.html">P0604R0</a></li>
<li>with part of <a href="https://wg21.cmeerw.net/lwg/issue2993">LWG 2993</a></li>
</ul>
</li>
<li><code>ystdex::any</code> is provided as a replacement for <code>std::any</code> with richer features and greater availability
<ul>
<li>already with following C++17 <code>std::any</code> features
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2769">LWG 2769</a>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2768">LWG 2768</a></li>
</ul>
</li>
<li>parts of <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0032r3.pdf">P0032R3</a>
<ul>
<li>with part of <a href="https://wg21.cmeerw.net/lwg/issue2857">LWG 2857</a></li>
</ul>
</li>
<li>NOTE: <a href="https://wg21.cmeerw.net/lwg/issue2509">LWG 2509</a> is superseded by the resolution and mostly not applicable because of the support of non <code>CopyConstructible</code> types (see below)</li>
<li>NOTE: <a href="https://wg21.cmeerw.net/lwg/issue2754">LWG 2754</a> is not applicable because the exact same reason above</li>
</ul>
</li>
<li>supports non <code>CopyConstructible</code> types (if a <code>ystdex::any</code> object holding an object of such type is eventually copied, exception would be thrown</li>
<li>with underlying interface for custom holders and handlers (for <code>ystdex::any_iterator</code>, etc)</li>
<li>supports constructor overload with minimal construction overhead for the empty object with <code>ystdex::default_init_t</code> parameter (at the cost of not supporting <code>constepxr</code> as the default constructor)</li>
<li>supports unsafe cast operations and more extensions to bypass checks with narrow contracts</li>
<li>early available before several standard proposals, including the <code>any</code> class itself and members like <code>emplace</code> (see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0032r0.pdf">P0032R0</a>)
<ul>
<li>actually being first to replace <code>boost::any</code> before <code>std::any</code> was proposed as a post-C++11 feature by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3390.html">N3390</a>: <em>Any</em> Library Proposal (Revision 1)</li>
<li>see also the original proposal <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1939.html">N1939</a>: <em>Any</em> Library Proposal for TR2</li>
</ul>
</li>
</ul>
</li>
<li><code>ystdex::function</code> is provided as a replacement for <code>std::function</code> with richer features
<ul>
<li>with <a href="https://wg21.cmeerw.net/lwg/issue2062">LWG 2062</a> not depending on C++17</li>
<li>with allocator support in construction like the feature removed by <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0302r1.html">P0302R1</a></li>
</ul>
</li>
<li><code>ystdex::list</code> is proveded as a replacement for <code>std::list</code> with draft ISO C++20 features support
<ul>
<li>part of <a href="https://wg21.cmeerw.net/lwg/issue1234">LWG 1234</a>: &quot;Do the right thing&quot; and <code>NULL</code></li>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4510.html">N4510</a>: Minimal incomplete type support for standard containers, revision 4</li>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0084r2.pdf">P0084R2</a>: Emplace Return Type (Revision 2) (adopted 2016-06)</li>
</ul>
</li>
<li><code>ystdex::map</code> is provided as a replacement for <code>std::map</code> provided (other containers TBD) including follwing enhancement (full ISO C++17 features support):
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3657.htm">N3657</a></li>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4258.pdf">N4258</a> (adopted 2014-11)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4279.html">N4279</a></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0083r3.pdf">P0083R3</a></li>
<li>parts of <a href="http://wg21.cmeerw.net/lwg/issue2005">LWG 2005</a>
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue2571">LWG 2571</a></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2059">LWG 2059</a></li>
<li>part of <a href="https://wg21.cmeerw.net/lwg/issue2354">LWG 2354</a></li>
<li>incomplete key and mapped types support which is not supported by C++17 (like <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4510.html">N4510</a>) yet (so it is not in <code>namespace ystdex::cpp2017</code>; although lisbstdc++ can support it)</li>
<li>part of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0458r2.html">P0458R2</a></li>
</ul>
</li>
</ul>
<h3 id="neutral-of-existence"><a class="header" href="#neutral-of-existence">Neutral of existence</a></h3>
<p>These post-C++03 (adopted, any proposed or any not proposed but theorotically allowed having well-defined behavior) resolutions or features (with diagnostic suggestions) are <strong>not</strong> depended on <strong>currently</strong> (revised b865[2019-08-23]) but confirmed still being compatible (however, user code can still be affected; some resolutions may have been applied to similar other interface of YBase, see sections above):</p>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue446">CWG 446</a>: Does an lvalue-to-rvalue conversion on the &quot;<code>?</code>&quot; operator produce a temporary?
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue86">CWG 86</a>: Lifetime of temporaries in query expressions</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue462">CWG 462</a>: Lifetime of temporaries bound to comma expressions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue468">CWG 468</a>: Allow <code>::template</code> outside of templates</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue475">CWG 475</a>: When is <code>std::uncaught_exception()</code> <code>true</code>? (take 2)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue515">CWG 515</a>: Non-dependent references to base class members (see also <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=21008">GCC PR 21008</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue569">CWG 569</a>: Spurious semicolons at namespace scope should be allowed</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue573">CWG 573</a>: Conversions between function pointers and <code>void*</code> (see also <a href="http://wg21.cmeerw.net/cwg/issue195">CWG 195</a>/<a href="http://wg21.cmeerw.net/cwg/issue1120">CWG 1120</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue760">CWG 760</a>: <code>this</code> inside a nested class of a non-static member function</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue903">CWG 903</a>: Value-dependent integral null pointer constants
<ul>
<li>NOTE: This is actually adopted after C++11 despite the compatibility clause is agianst to C++03.</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1120">CWG 1120</a>: <code>reinterpret_cast</code> and <code>void*</code> (depends on <a href="http://wg21.cmeerw.net/cwg/issue573">CWG 573</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1164">CWG 1164</a>: Partial ordering of <code>f(T&amp;)</code> and <code>f(T&amp;&amp;)</code></li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1213">CWG 1213</a>: Array subscripting and xvalues (see also <a href="http://wg21.cmeerw.net/cwg/issue616">CWG 616</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1227">CWG 1227</a>: Mixing immediate and non-immediate contexts in deduction failure</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1255">CWG 1255</a>: Definition problems with <code>constexpr</code> functions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1301">CWG 1301</a>: Value initialization of union
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1324">CWG 1324</a>: Value initialization and defaulted constructors</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1368">CWG 1368</a>: Value initialization and defaulted constructors (part 2)</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1310">CWG 1310</a>: What is an “acceptable lookup result?”</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1399">CWG 1399</a>: Missing non-deduced context following a function parameter pack
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1388">CWG 1388</a>: Deduction with multiple function parameter packs</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1402">CWG 1402</a>: Move functions too often deleted
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1491">CWG 1491</a>: Move construction and rvalue reference members</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1412">CWG 1412</a>: Problems in specifying pointer conversions</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1579">CWG 1579</a>: Return by converting move constructor</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1591">CWG 1591</a>: Deducing array bound and element type from initializer list</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1626">CWG 1626</a>: <code>constexpr</code> member functions in <code>brace-or-equal-initializer</code>s</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1665">CWG 1665</a>: Declaration matching in explicit instantiations</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1693">CWG 1693</a>: Superfluous semicolons in class definitions (depends on <a href="http://wg21.cmeerw.net/cwg/issue569">CWG 569</a>)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1713">CWG 1713</a>: Linkage of variable template specializations</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1875">CWG 1875</a>: Reordering declarations in class scope</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1895">CWG 1895</a>: Deleted conversions in conditional operator operands
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1932">CWG 1932</a>: Bit-field results of conditional operators</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1952">CWG 1952</a>: Constant expressions and library undefined behavior</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1980">CWG 1980</a>: Equivalent but not functionally-equivalent redeclarations</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2137">CWG 2137</a>: List-initialization from object of same type</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2248">CWG 2248</a>: Problems with sized <code>delete</code></li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2267">CWG 2267</a>: Copy-initialization of temporary in reference direct-initialization</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2022">CWG 2278</a>: Copy elision in constant expressions reconsidered</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue2313">CWG 2313</a>: Redeclaration of structured binding reference variables</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue281">LWG 281</a>: <code>std::min()</code> and <code>max()</code> requirements overly restrictive</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue283">LWG 283</a>: <code>std::replace()</code> requirement incorrect/insufficient</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue387">LWG 387</a>: <code>std::complex</code> over-encapsulated</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue402">LWG 402</a>: wrong new expression in <code>[some_]allocator::construct</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue497">LWG 497</a>: meaning of <code>numeric_limits::traps</code> for floating point types</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue531">LWG 531</a>: array forms of unformatted input functions (i.e. for <code>istream::get</code>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue543">LWG 543</a>: <code>valarray</code> slice default constructor</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue551">LWG 551</a>: <code>&lt;ccomplex&gt;</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue565">LWG 565</a>: <code>xsputn</code> inefficient</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue566">LWG 566</a>: array forms of unformatted input function undefined for zero-element arrays (i.e. for <code>istream::get</code>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue576">LWG 576</a>: <code>find_first_of</code> is overconstrained</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue578">LWG 578</a>: purpose of hint to <code>allocator::allocate()</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue586">LWG 586</a>: string inserter not a formatted function</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue593">LWG 593</a>: <code>__STDC_CONSTANT_MACROS</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue619">LWG 619</a>: Longjmp wording problem</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue643">LWG 643</a>: Impossible &quot;as if&quot; clauses</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue646">LWG 646</a>: <code>const</code> incorrect <code>match_result</code> members</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue659">LWG 659</a>: <code>istreambuf_iterator</code> should have an <code>operator-&gt;()</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue776">LWG 776</a>: Undescribed assign function of <code>std::array</code> (i.e. <code>array::fill</code>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue779">LWG 779</a>: Resolution of <a href="http://wg21.cmeerw.net/lwg/issue283">#283</a> incomplete</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue787">LWG 787</a>: complexity of <code>binary_search</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue807">LWG 807</a>: <code>tuple</code> construction should not fail unless its element's construction fails</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue844">LWG 844</a>: <code>complex</code> <code>pow</code> return type is ambiguous</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue848">LWG 848</a>: Missing std::hash specializations for <code>std::bitset</code>/<code>std::vector&lt;bool&gt;</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue850">LWG 850</a>: Should <code>shrink_to_fit</code> apply to <code>std::deque</code>? (i.e. <code>deque::shrink_to_fit</code>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue852">LWG 852</a>: unordered containers <code>begin(n)</code> mistakenly <code>const</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue900">LWG 900</a>: Stream move-assignment</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue1004">LWG 1004</a>: Clarify &quot;throws an exception&quot;
<ul>
<li>see national body comment UK 179 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n2837.pdf">N2837</a>: C++0X, CD 1, National Body Comments</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue1012">LWG 1012</a>: <code>reverse_iterator</code> default ctor should value initialize (adopted by LWG motion 1 in <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2009/n3001.html">N3001</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1071">LWG 1071</a>: <code>is_bind_expression</code> should derive from <code>integral_constant&lt;bool&gt;</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue1334">LWG 1334</a>: Insert iterators are broken for some proxy containers compared to C++03</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue1399">LWG 1399</a>: <code>function</code> does not need an explicit default constructor</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue1402">LWG 1402</a>: <code>nullptr</code> constructors for smart pointers should be <code>constexpr</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2005">LWG 2005</a>: <code>unordered_map::insert(T&amp;&amp;)</code> protection should apply to <code>map</code> too
<ul>
<li>partially replaced by <code>ystdex::map</code></li>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue2571">LWG 2571</a>: §[map.modifiers]/2 imposes nonsensical requirement on <code>insert(InputIterator, InputIterator)</code>
<ul>
<li>replaced by <code>ystdex::map</code></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2059">LWG 2059</a>: C++0x ambiguity problem with <code>map::erase</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2103">LWG 2103</a>: <code>std::allocator_traits&lt;std::allocator&lt;T&gt;&gt;::propagate_on_container_move_assignment</code> (see also <a href="https://wg21.cmeerw.net/lwg/issue2108">LWG 2108</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2104">LWG 2104</a>: <code>unique_lock</code> move-assignment should not be <code>noexcept</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2112">LWG 2112</a>: User-defined classes that cannot be derived from (i.e. <code>is_final</code>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2135">LWG 2135</a>: Unclear requirement for exceptions thrown in <code>condition_variable::wait()</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2247">LWG 2247</a>: Type traits and <code>std::nullptr_t</code> (i.e. <code>is_null_pointer</code>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2321">LWG 2321</a>: Moving containers should (usually) be required to preserve iterators
<ul>
<li>replaced by <code>ystdex::map</code> and some other containers in YBase.YStandardEx which support the resolution</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2354">LWG 2354</a>: Unnecessary copying when inserting into maps with braced-init syntax</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2360">LWG 2360</a>: <code>reverse_iterator::operator*()</code> is unimplementable (see also <a href="https://wg21.cmeerw.net/lwg/issue2204">LWG 2204</a>)</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2362">LWG 2362</a>: unique, associative <code>emplace()</code> should not move/copy the mapped_type constructor arguments when no insertion happens (see also <a href="http://wg21.cmeerw.net/lwg/issue2006">LWG 2006</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2393">LWG 2393</a>: <code>std::function</code>'s <code>Callable</code> definition is broken</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2408">LWG 2408</a>: SFINAE-friendly <code>common_type</code>/<code>iterator_traits</code> is missing in C++14</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2437">LWG 2437</a>: <code>iterator_traits::reference</code> can and can't be <code>void</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2438">LWG 2438</a>: <code>std::iterator</code> inheritance shouldn't be mandated</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2442">LWG 2442</a>: <code>call_once()</code> shouldn't <code>DECAY_COPY()</code></li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2466">LWG 2466</a>: <code>allocator_traits::max_size()</code> default behavior is incorrect</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2470">LWG 2470</a>: Allocator's <code>destroy</code> function should be allowed to fail to instantiate (split from <a href="https://wg21.cmeerw.net/lwg/issue2447">LWG 2447</a>)</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2483">LWG 2483</a>: <code>throw_with_nested()</code> should use <code>is_final</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2485">LWG 2485</a>: <code>get()</code> should be overloaded for <code>const tuple&amp;&amp;</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2509">LWG 2509</a>: [fund.ts.v2] <code>any_cast</code> doesn't work with rvalue reference targets and cannot move with a value target
<ul>
<li>NOTE: The proposed resolution is targeting the working paper of the TS. It is not applied to <code>std::any</code> in ISO C++17 and it is still not in post-C++17 working draft <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/n4778.pdf">N4778</a>, and it is overriden by the resolution of <a href="https://wg21.cmeerw.net/lwg/issue2769">LWG 2769</a> partially.</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2547">LWG 2547</a>: Container requirements (and other library text) should say &quot;strict total order&quot;, not just &quot;total order&quot;</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2549">LWG 2549</a>: Tuple EXPLICIT constructor templates that take tuple parameters end up taking references to temporaries and will create dangling references
<ul>
<li>see also <a href="https://wg21.cmeerw.net/lwg/issue2312">LWG 2312</a></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2567">LWG 2567</a>: Specification of logical operator traits uses <code>BaseCharacteristic</code>, which is defined only for <code>UnaryTypeTrait</code>s and <code>BinaryTypeTraits</code>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2568">LWG 2568</a>: [fund.ts.v2] Specification of logical operator traits uses <code>BaseCharacteristic</code>, which is defined only for <code>UnaryTypeTraits</code> and <code>BinaryTypeTraits</code></li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2577">LWG 2577</a>: <code>{shared,unique}_lock</code> should use <code>std::addressof</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2591">LWG 2591</a>: <code>std::function</code>'s member template <code>target()</code> should not lead to undefined behaviour</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2729">LWG 2729</a>: Missing SFINAE on <code>std::pair::operator=</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2754">LWG 2754</a>: The <code>in_place</code> constructors and emplace functions added by <a href="http://open-std.org/JTC1/SC22/WG21/docs/papers/2016/p0032r3.pdf">P0032R3</a> don't require <code>CopyConstructible</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2766">LWG 2766</a>: Swapping non-swappable types</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2769">LWG 2769</a>: Redundant <code>const</code> in the return type of <code>any_cast(const any&amp;)</code>
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2768">LWG 2768</a>: <code>any_cast</code> and move semantics</li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2781">LWG 2781</a>: Contradictory requirements for <code>std::function</code> and <code>std::reference_wrapper</code>
<ul>
<li>replaced by <code>ystdex::function</code> with the resolution</li>
<li>see also <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=66284">GCC PR66284</a></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2794">LWG 2794</a>: Missing requirements for allocator pointers</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2857">LWG 2857</a>: {<code>variant</code>,<code>optional</code>,<code>any</code>}<code>::emplace</code> should return the constructed value
<ul>
<li>partially replaced by <code>ystdex::any</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue2993">LWG 2993</a>: <code>reference_wrapper&lt;T&gt;</code> conversion from <code>T&amp;&amp;</code>
<ul>
<li>partially replaced by <code>ystdex::lref</code></li>
</ul>
</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue3017">LWG 3017</a>: <code>list</code> <code>splice</code> functions should use <code>addressof</code></li>
<li><a href="https://wg21.cmeerw.net/lwg/issue3087">LWG 3087</a>: One final <code>&amp;x</code> in §[list.ops]</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1981.html">N1981</a>: Uniform Use of <code>std::string</code> Revision 1</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1990.htm">N1990</a>: Proposed Text for <code>minmax</code> (N1840) (i.e. <code>minmax</code> and <code>minmax_element</code> in <code>&lt;algorithm&gt;</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n1991.htm">N1991</a>: Proposed Text for <code>defaultfloat</code> (N1842) (i.e. <code>defaultfloat</code> in <code>&lt;ios&gt;</code>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2007.html">N2007</a>: Proposed Library Additions for Code Conversion</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2006/n2111.pdf">N2111</a>: Random Number Generation in C++0X: A Comprehensive Proposal, version 4
<ul>
<li>with <a href="http://wg21.cmeerw.net/lwg/issue609">LWG 609</a>: missing <code>static const</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2253.html">N2253</a>: Extending <code>sizeof</code> to apply to non-static data members without an object (revision 1)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2292.html">N2292</a>: Standard Library Applications for Deleted Functions</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2321.html">N2321</a>: Enhancing the <code>time_get</code> facet for POSIX® compatibility, Revision 2</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2007/n2353.html">N2353</a>: A Specification for <code>vector&lt;bool&gt;</code></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2547.htm">N2547</a>: Allow atomics use in signal handlers</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2554.pdf">N2554</a>: The Scoped Allocator Model (Rev 2)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2760.htm">N2760</a>: Input/Output Library Thread Safety</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2765.pdf">N2765</a>: User-defined Literals (aka. Extensible Literals (revision 5))</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2008/n2782.htm">N2782</a>: C++ Data-Dependency Ordering: Function Annotation (i.e. <code>[[carries_dependency]]</code>)</li>
<li>N3026
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue408">CWG 408</a>: <code>sizeof</code> applied to unknown-bound array <code>static</code> data member of template</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue490">CWG 490</a>: Name lookup in <code>friend</code> declarations</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue722">CWG 722</a>: Can <code>nullptr</code> be passed to an ellipsis?</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue734">CWG 734</a>: Are unique addresses required for namespace-scope variables?</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue935">CWG 935</a>: Missing overloads for character types for user-defined literals</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1000">CWG 1000</a>: Mistaking member <code>typedef</code>s for constructors</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3059.pdf">N3059</a>: Proposal to simplify <code>pair</code> (rev 5.2) (i.e. <code>piecewise_construct_t</code>, etc.)
<ul>
<li><a href="http://wg21.cmeerw.net/lwg/issue1321">LWG 1321</a>: <code>scoped_allocator_adaptor</code> <code>construct</code> and <code>destroy</code> don't use <code>allocator_traits</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2011/n3282.pdf">N3282</a>: Resolution for core issues <a href="http://wg21.cmeerw.net/cwg/issue1207">1207</a> and [1017](](http://wg21.cmeerw.net/cwg/issue1017)
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue945">CWG 945</a>: Use of <code>this</code> in a late-specified return type</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1017">CWG 1017</a>: Member access transformation in unevaluated operands (see also <a href="http://wg21.cmeerw.net/cwg/issue1005">CWG 1005</a>; note <a href="http://wg21.cmeerw.net/cwg/issue1005">CWG 515</a> is still effective)</li>
<li><a href="http://wg21.cmeerw.net/cwg/issue1207">CWG 1207</a>: Type of class member in <code>trailing-return-type</code> (see also <a href="http://wg21.cmeerw.net/cwg/issue945">CWG 945</a>)
<ul>
<li>BLOCKED by <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=52869">GCC PR 52869 (NEW)</a>, even though Clang++ works</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2013/n3664.html">N3664</a>: Clarifying Memory Allocation (adopted 2013-04)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n3843.pdf">N3843</a>: A SFINAE-Friendly <code>std::common_type</code></li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4081.html">N4081</a>: Working Draft, C++ Extensions for Library Fundamentals (see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4480.html">N4480</a>)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4279.html">N4279</a>: Improved insertion interface for unique-key maps (Revision 2.3) (adopted 2014-11)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4510.html">N4510</a>: Minimal incomplete type support for standard containers, revision 4 (adopted 2015-05; however, <strong>similar requirements for associative containers (not proposed yet) were required when replacments were not used</strong>, see <a href="Development.zh-CN.html">here (zh-CN)</a>)
<ul>
<li>partially replaced by <code>ystdex::map</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0083r3.pdf">P0083R3</a>: Splicing Maps and Sets (Revision 5)
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue839">LWG 839</a>: Maps and sets missing splice operation</li>
<li><a href="https://wg21.cmeerw.net/lwg/issue1041">LWG 1041</a>: Add associative/unordered container functions that allow to extract elements</li>
<li>partially replaced by <code>ystdex::map</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/p0136r1.html">P0136R1</a>: Rewording inheriting constructors (<a href="https://wg21.cmeerw.net/cwg/issue1941">core issue 1941</a> et al) (adopted 2015-10)
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1573">CWG 1573</a>: Inherited constructor characteristics</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1645">CWG 1645</a>: Identical inheriting constructors via default arguments</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1715">CWG 1715</a>: Access and inherited constructor templates</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1736">CWG 1736</a>: Inheriting constructor templates in a local class</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1903">CWG 1903</a>: What declarations are introduced by a non-member <code>using-declaration</code>?</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1941">CWG 1941</a>: SFINAE and inherited constructor default arguments </li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1959">CWG 1959</a>: Inadvertently inherited copy constructor</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1991">CWG 1991</a>: Inheriting constructors vs default arguments</li>
</ul>
</li>
<li>following resolution of <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0165r3.html">P0165R3</a>: C++ Standard Library Issues to be moved in Issaquah (adopted 2016-10)
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2062">LWG 2062</a>: Effect contradictions w/o no-throw guarantee of <code>std::function</code> swaps
<ul>
<li>replaced by <code>ystdex::function</code> since (revised b848[2018-12-24])</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0409r2.html">P0409R2</a>: Allow lambda capture <code>[=, this]</code> (adopted 2017-07)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0458r2.html">P0458R2</a>: Checking for Existence of an Element in Associative Containers (adopted 2018-06)
<ul>
<li>partially replaced by <code>ystdex::map</code></li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0588r1.html">P0588R1</a>: Simplifying implicit lambda capture (adopted 2017-11)
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1913">CWG 1913</a>: <code>decltype((x))</code> in <code>lambda-expression</code>s</li>
<li><a href="https://wg21.cmeerw.net/cwg/issue1632">CWG 1632</a>: Lambda capture in member initializers</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0600r1.pdf">P0600R1</a>: <code>[[nodiscard]]</code> in the Library, Rev1 (adopted 2017-11)</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0616r0.pdf">P0616R0</a>: de-pessimize legacy <code>&lt;numeric&gt;</code> algorithms with <code>std::move</code> (adopted 2017-11)
<ul>
<li><a href="https://wg21.cmeerw.net/lwg/issue2055">LWG 2055</a>: <code>std::move</code> in <code>std::accumulate</code> and other algorithms</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2017/p0641r2.html">P0641R2</a>: Resolving Core Issue #1331 (<code>const</code> mismatch with defaulted copy constructor) (adopted 2017-11)
<ul>
<li><a href="https://wg21.cmeerw.net/cwg/issue1331">CWG 1331</a>: <code>const</code> mismatch with defaulted copy constructor
<ul>
<li>see also <a href="https://wg21.cmeerw.net/cwg/issue1426">CWG 1426</a>: Allowing additional parameter types in defaulted functions</li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2019/p1227r2.html">P1227R2</a>: Signed <code>ssize()</code> functions, unsigned <code>size()</code> functions (Revision 2) (adopted 2019-03)</li>
</ul>
<h3 id="avoided"><a class="header" href="#avoided">Avoided</a></h3>
<p>These already adopted (by the standard or the working paper) post-C++11 resolutions (which may need no modification on a previous conforming C++ implementation) are <strong>not</strong> depended on <strong>currently</strong> (revised b803[2017-09-08]) but confirmed still being compatible, and also <strong>would not be relied on in future</strong> based on the fact of reducing expresiveness in the language and lacking of portable extensions to prevent underming of code quality based on current status:</p>
<ul>
<li><a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2016/p0145r3.pdf">P0145R3</a>: Refining Expression Evaluation Order for Idiomatic C++ (adopted 2016-06)</li>
</ul>
<h1 id="list-of-reported-issues"><a class="header" href="#list-of-reported-issues">List of reported issues</a></h1>
<p>There are some issues related reported, or originally found and forwarded by author of this project. Some issues are related to the to language or enviornment specifications. See <a href="ReportedIssues.en-US.html">reported issues</a> for details.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="introduction-1"><a class="header" href="#introduction-1">Introduction</a></h1>
<p>There are some issues related reported, or originally found and forwarded by author of this project. Some issues might block the project in some sense. To review them conveniently, reported issues are collect in this document.</p>
<p>Unless otherwise specified, notations are same to those in <a href="StandardUsing.en-US.html">StandardUsing</a>.</p>
<h1 id="list-of-reported-issues-1"><a class="header" href="#list-of-reported-issues-1">List of reported issues</a></h1>
<p>Issues not rejected or withdrawn are collected and listed here (revised b840[2018-10-07]).</p>
<h2 id="specifications"><a class="header" href="#specifications">Specifications</a></h2>
<p>Some issues are related to the to language or enviornment specifications.</p>
<p>The entries may duplicate with above.</p>
<h3 id="isoiec-14882-isoiec-jtc1-sc22wg21-issue-list"><a class="header" href="#isoiec-14882-isoiec-jtc1-sc22wg21-issue-list">ISO/IEC 14882 (ISO/IEC JTC1 SC22/WG21 issue list)</a></h3>
<ul>
<li><a href="http://wg21.cmeerw.net/cwg/issue1949">CWG 1949</a>: “sequenced after” instead of “sequenced before” (resolved at <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4567.pdf">N4567</a>, see <a href="http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2015/n4566.html">N4566</a>)
<ul>
<li>Issue delegated in <a href="https://github.com/cplusplus/draft/issues/61">GitHub issue 61</a>.</li>
</ul>
</li>
<li><a href="http://wg21.cmeerw.net/lwg/issue2240">LWG 2240</a>: Probable misuse of term &quot;function scope&quot; in [thread.condition] (resolved)
<ul>
<li>Original thread posted in <a href="https://groups.google.com/a/isocpp.org/forum/#!topic/std-discussion/JpQVT-pwP9E">std-discussion</a>.</li>
<li>Issue delegated in <a href="https://github.com/cplusplus/draft/issues/57">GitHub issue 57</a>.</li>
</ul>
</li>
</ul>
<h2 id="implementations-of-standards-or-specifications"><a class="header" href="#implementations-of-standards-or-specifications">Implementations of standards or specifications</a></h2>
<p>Some issues are related to the to implementations of language or enviornment specifications.</p>
<h3 id="gnu-c-a-hrefhttpsgccgnuorgbugzillabugzillaa"><a class="header" href="#gnu-c-a-hrefhttpsgccgnuorgbugzillabugzillaa">GNU C++ (<a href="https://gcc.gnu.org/bugzilla/">Bugzilla</a>)</a></h3>
<ul>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53872">PR 53872</a>: [C++11] ADL bug in <code>std::thread</code> (RESOLVED FIXED 4.7.2)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53873">PR 53873</a>: [C++11] strange error message for template overloading (RESOLVED DUPLICATE of <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53862">bug 53862</a>)
<ul>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=53862">PR 53862</a>[4.6/4.7 regression] [C++11] sorry, unimplemented: use of 'type_pack_expansion' in template (RESOLVED FIXED 4.7.1)</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=54216">PR 54216</a>: Missing diagnostic for ill-formed anonymous enum declarations (RESOLVED FIXED 4.9.0)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=55053">PR 55053</a>: <code>std::is_explicitly_convertible</code> should be removed (RESOLVED WORKSFORME 4.8.0)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=56699">PR 56699</a>: [4.8/4.9 regression] Failed for sizeof (non-static member) in lambda expression (RESOLVED FIXED mainline/4.8.1)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57183">PR 57183</a>: [C++11] <code>auto</code> and -Wunused-variable (RESOLVED FIXED 4.8.1)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57444">PR 57444</a>: [4.8/4.9 Regression] ICE in instantiate_type for invalid use of member with <em>using-declaration</em> (RESOLVED DUPLICATE of <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58457">bug 58457</a>)
<ul>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58457">PR 58457</a>: [4.8/4.9 Regression] ICE when placement <code>new</code> operator is used with using keyword and custom constructor (RESOLVED FIXED 4.8.2/4.9.0)</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=58395">PR 58395</a>: Undefined behavior vs. exception (RESOLVED WONTFIX)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59682">PR 59682</a>: Invalid syntax accepted: new-placement without <em>expression-list</em> (RESOLVED FIXED 6.0)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=59931">PR 59931</a>: Wrong wording of diagnostic about imaginary &quot;member function type&quot;</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=60709">PR 60709</a>: [C++11]ICE when using a <em>braced-init-list</em> as function argument to initialize a reference to array (RESOLVED FIXED 4.8.3)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=61019">PR 61019</a>: ICE: incomplete type of class template as <em>pseudo-destructor-name</em> (RESOLVED FIXED 6.0)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63400">PR 63400</a>: [C++11]precision of <code>std::chrono::high_resolution_clock</code> (UNCONFIRMED)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=65343">PR 65343</a>: unexpected exception thrown during destruction of static object in debug mode
<ul>
<li>Since some version of Windows 10, the crash dialog would not show, made it less annoying.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=65748">PR 65748</a>: [C++11][C++14]Invalid copy elision on operand of <em>throw-exception</em> (RESOLVED DUPLICATE of <a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57533">bug 57533</a>)
<ul>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=57533">PR 57533</a>: When throwing local variable, it's being move-constructed even if not going out of scope. (NEW)</li>
<li>This misfeature is carefully avoided in YSLib source.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=65890">PR 65890</a>: [C++03]<code>sizeof(qualified-id)</code> accepted when the operand denotes a non-static member (RESOLVED INVALID)
<ul>
<li>This does not effect YSLib since C++11 is the baseline.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67238">PR 67238</a>: [C++11][C++14]cc1plus crash for nested <code>decltype</code> expression in parameter pack in trailing return type when '-g' enabled (RESOLVED FIXED 6.0)
<ul>
<li>This was worked arounded in YSLib source, before 6.0 is actually depended on.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=67795">PR 67795</a>: Wrong code generated for conditional expression with cast (NEW)
<ul>
<li>This still blocks some code.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=70480">PR 70480</a>: Reduce RTTI code bloat for specified types (NEW)
<ul>
<li>For DS platform, YSLib uses <code>ystdex::type_id</code> instead <code>typeid</code> to worked around.</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/30/b699-mingw32-some-error-constants">YSLib issue 30</a> 
<ul>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=71444">PR 71444</a>: Error constants for MinGW-w64 (RESOLVED FIXED 5.5, 6.4 and 7.1)</li>
<li>This was worked around in YSLib source and fixed since G++ 7.1.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=86734">PR 86734</a>: [DR 2188] <code>reverse_iterator::operator-&gt;</code> does not support overloaded <code>operator&amp;</code> (RESOLVED FIXED 7.4 8.3)
<ul>
<li>See upstream <a href="https://wg21.cmeerw.net/lwg/issue2188">LWG 2188</a>.</li>
<li>This is conditionally avoided by replacement <code>ystdex::reverse_iterator</code>.</li>
</ul>
</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=90966">PR 90966</a>: [9/10 Regression] ICE in tsubst_copy, at cp/pt.c:16155 (RESOLVED FIXED 9.3 and 10)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91127">PR 91127</a>: Incorrect checking of nonnull attribute with argument to a constructor of class with a virtual base (NEW)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91480">PR 91480</a>: Nonconforming definitions of standard library feature-test macros (NEW)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91531">PR 91531</a>: <code>_Rb_tree</code>'s copy assignment should respect to POCCA regardless of <code>is_always_equal</code> (NEW)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91541">PR 91541</a>: [C++17] Exception specification of <code>operator=</code> of node-based containers may be broken (RESOLVED WONTFIX)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=91620">PR 91620</a>: <code>std::[forward_]list::remove_if/unique</code> should respect to <a href="https://wg21.cmeerw.net/lwg/issue526">DR 526</a> (ASSIGNED)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=93470">PR 93470</a>: [C++2a] [9 Regression] [C++2a] <code>std::reference_wrapper</code> to function type is broken with Clang (RESOLVED FIXED 9.3)</li>
<li><a href="https://gcc.gnu.org/bugzilla/show_bug.cgi?id=94602">PR 94602</a>: wrong semantic check to prvalue as decltype operand (UNCONFIRMED)</li>
</ul>
<h3 id="llvmclang-a-hrefhttpsllvmorgbugsbugzillaa"><a class="header" href="#llvmclang-a-hrefhttpsllvmorgbugsbugzillaa">LLVM/Clang (<a href="https://llvm.org/bugs/">Bugzilla</a>)</a></h3>
<ul>
<li><a href="https://llvm.org/bugs/show_bug.cgi?id=25306">PR 25306</a>: <code>__attribute__((returns_nonnull))</code> does not work for <code>std::add_pointer_t&lt;T&gt;</code> (NEW)</li>
<li><a href="https://llvm.org/bugs/show_bug.cgi?id=27504">PR 27504</a>: Inherited constructor with dependent base class introduced by a <em>typedef-name</em> may not work (NEW)</li>
<li><a href="https://llvm.org/bugs/show_bug.cgi?id=27443">PR 27443</a>: [CWG 734] Nonconforming aliasing of block scope objects (RESOLVED DUPLICATE of <a href="https://llvm.org/bugs/show_bug.cgi?id=18538">bug 18538</a>)
<ul>
<li><a href="https://llvm.org/bugs/show_bug.cgi?id=18538">PR 18538</a>: non-conforming optimization <code>-fmerge-all-constants</code> is enabled by default</li>
<li>Note they are not identical. PR 27443 is for ISO C++ and PR 18538 is for ISO C.</li>
</ul>
</li>
<li><a href="https://bugs.llvm.org/show_bug.cgi?id=43275">PR 43275</a>: Pure attribute and C++ exceptions (NEW)</li>
<li><a href="https://bugs.llvm.org/show_bug.cgi?id=45542">PR 45542</a>: wrong semantic check to prvalue as decltype operand (NEW)</li>
</ul>
<h3 id="microsoft-visual-c"><a class="header" href="#microsoft-visual-c">Microsoft Visual C++</a></h3>
<p>New issues are now reported to <a href="https://developercommunity.visualstudio.com/">Microsoft Visual Studio Developer Community</a>.</p>
<p>As [Microsoft Connect](<a href="https://connect.microsoft.com/">Microsoft Connect</a>) is down now, any status would not be updated. Note some posts have been inaccessible even before the service stopped.</p>
<ul>
<li><a href="https://connect.microsoft.com/VisualStudio/feedback/details/1641428">Microsoft Connect issue 1641428</a>: Wrong Win32 error to <code>errno</code> mapping (ACTIVE)
<ul>
<li>YSLib code does not rely on Universal source, instead implements the functionality spearatedly, so it has no effect.</li>
<li>This seems to be fixed before Microsoft Connect closed.</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/33">YSLib issue 33</a>
<ul>
<li><a href="https://connect.microsoft.com/VisualStudio/feedback/details/2913382">Microsoft Connect issue 2913382</a>: Parameter parsing bug (ACTIVE)</li>
<li><a href="https://developercommunity.visualstudio.com/content/problem/431539/vc-cannot-parse-function-pointer-parameter-with-de.html">problem 431539</a>: VC++ cannot parse function pointer parameter with default argument '{}' (Under Consideration)</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/34">YSLib issue 34</a>: [Win32] std::unique_ptr::operator-&gt; not conforming in Microsoft VC++ 2015
<ul>
<li><a href="https://connect.microsoft.com/VisualStudio/feedback/details/2918170">Microsoft Connect issue 2918170</a>: <code>std::unique_ptr::operator-&gt;</code> not conforming (FIXED accroding to <a href="https://blogs.msdn.microsoft.com/vcblog/2016/10/11/c1417-features-and-stl-fixes-in-vs-15-preview-5/">here</a>)</li>
</ul>
</li>
<li><a href="https://developercommunity.visualstudio.com/content/problem/417142/lwg-2070p0674r1-stdallocate-shared-is-not-conformi.html">problem 417142</a>: [LWG 2070][P0674R1] <code>std::allocate_shared</code> is not conforming (Under Investigation)</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/35">YSLib issue 35</a>: [Win32] Microsoft VC++ 2017 failed to evaluate the dependent noexcept expression inside noexcept-specifier
<ul>
<li><a href="https://developercommunity.visualstudio.com/content/problem/431598/vc-fails-to-compile-the-noexcept-expression-inside.html">problem 431598</a>: VC++ fails to compile the noexcept expression inside noexcept-specifier with a template-parameter instantiated from an explicit destruct call (Closed - Fixed)(Fixed In: Visual Studio 2019 version 16.1)(Fixed In: Visual Studio 2019 version 16.1 Preview 1)</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/36">YSLib issue 36</a>: [Win32] Microsoft VC++ 2017 failed to initialize with string arrays with a constexpr u8 string literal
<ul>
<li><a href="https://developercommunity.visualstudio.com/content/problem/431628/vc-fails-to-initialize-with-string-arrays-with-a-c.html">problem 431628</a>: VC++ fails to initialize with string arrays with a constexpr u8 string literal (Closed - Fixed)(Fixed In: Visual Studio 2019 version 16.0)(Fixed In: Visual Studio 2019 version 16.0 Preview 5)</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/37">YSLib issue 37</a>: [Win32] Microsoft VC++ 2017 internal compiler error when building SHBuild
<ul>
<li><a href="https://developercommunity.visualstudio.com/content/problem/431665/vc-2017-internal-error-for-overloaded-qualified-fu.html">problem 431665</a>: VC++ 2017 internal error for overloaded qualified function template function call in the function default argument (Closed - Fixed)(Fixed In: Visual Studio 2019 version 16.1)(Fixed In: Visual Studio 2019 version 16.0)</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/38">YSLib issue 38</a>: [Win32] Microsoft VC++ 2017 failed to select expected std::swap specialization
<ul>
<li><a href="https://developercommunity.visualstudio.com/content/problem/431904/vc-2017-stdswap-is-not-conforming.html">problem 431904</a> (Closed - Fixed)(Fixed In: Visual Studio 2019 version 16.1)(Fixed In: Visual Studio 2019 version 16.1 Preview 2)(Fixed In: Visual Studio 2019 version 16.1 Preview 1)</li>
</ul>
</li>
<li><a href="https://bitbucket.org/FrankHB/yslib/issues/39">YSLib issue 39</a>: [Win32] Microsoft VC++ 2017 rejects dependent noexcept-specifier in template partial specializations 
<ul>
<li><a href="https://developercommunity.visualstudio.com/content/problem/441268/vc-2017-rejects-dependent-noexcept-specifier-in-te.html">problem 441268</a> (Under Consideration)</li>
</ul>
</li>
</ul>
<h2 id="other-projects"><a class="header" href="#other-projects">Other projects</a></h2>
<p>As complement, some issues are related to other tools used by the project or referenced in documentation of this project, which may loosely concern with issues listed above.</p>
<h3 id="drmemory"><a class="header" href="#drmemory">DrMemory</a></h3>
<ul>
<li><a href="https://github.com/DynamoRIO/drmemory/issues/1826">issue 1826</a>: Crash in Win10 TH2 (Closed <a href="https://github.com/DynamoRIO/drmemory/commit/446007ec2c76fbab9220850b38aac48c538eee18">FIXED</a>)</li>
</ul>
<h3 id="devkitpro"><a class="header" href="#devkitpro">devkitPro</a></h3>
<h4 id="libfat"><a class="header" href="#libfat">libfat</a></h4>
<ul>
<li><a href="https://github.com/devkitPro/libfat/pull/1">pull request 1</a>: Removed redundant check (Merged)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/2">issue 2</a>: Wrong root sectors count determined for FAT12 and FAT16? (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/3">issue 3</a>: Redundant function calls (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/4">issue 4</a>: <code>_FAT_directory_entryFromPosition</code> issues (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/5">issue 5</a>: Redundant call of <code>_FAT_directory_getRootEntry</code> for &quot;<code>/</code>&quot; (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/6">issue 6</a>: <code>ENOTDIR</code> vs <code>ENOENT</code> for invalid path prefix (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/7">issue 7</a>: Pathname with or without trailing slashes for directories (Open)</li>
<li><a href="https://github.com/devkitPro/libfat/issues/10">issue 10</a>: Setting <code>errno</code> when removing a non-empty directory (Open)</li>
</ul>
<h4 id="libnds"><a class="header" href="#libnds">libnds</a></h4>
<ul>
<li><a href="https://github.com/devkitPro/libnds/issues/3">issue 3</a>: Compiler warnings (Closed)</li>
<li><a href="https://github.com/devkitPro/libnds/issues/4">issue 4</a>: About <code>std::chrono</code> clocks (Closed)</li>
<li><a href="https://github.com/devkitPro/libnds/pull/30">pull request 30</a>: Removed redundant code. (Merged)</li>
<li><a href="https://github.com/devkitPro/libnds/pull/33">pull request 33</a>: Fixed redundant qualifier (Merged)</li>
</ul>
<h4 id="newlib"><a class="header" href="#newlib">newlib</a></h4>
<ul>
<li><a href="https://github.com/devkitPro/newlib/issues/5">issue 5</a>: Nonconforming return type of <code>ftell</code> (Closed FIXED)</li>
</ul>
<h3 id="klisp"><a class="header" href="#klisp">Klisp</a></h3>
<ul>
<li><a href="https://bitbucket.org/AndresNavarro/klisp/issues/12/a-problem-of-proper-tail-call">issue 12</a>: A problem of proper tail call (NEW)</li>
</ul>
<h1 id="resolved-implementation-issues"><a class="header" href="#resolved-implementation-issues">Resolved implementation issues</a></h1>
<p>Some issues were tagged BLOCKED status previously. Issues known resolved and confirmed to work would be put in this chapter.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="general"><a class="header" href="#general">General</a></h1>
<h2 id="scope"><a class="header" href="#scope">Scope</a></h2>
<p>This document describes a set of rules for creating and maintaining documentations or some other kinds of materials, which is not project-specific. This document is also self-conforming to these rules.</p>
<h2 id="notation-1"><a class="header" href="#notation-1">Notation</a></h2>
<p>Specific formats may be used. The visual output may depend on the method of rendering.</p>
<p>Texts intended to be handled differently (for example, portions of program source code) may be in <code>some specific format</code>. Other texts are considered normal.</p>
<p><a href="https://en.wikipedia.org/wiki/Hyperlink">Hyperlinks</a> may be used in normal texts pointing to external references, local pages, or anchors in specific documents.</p>
<p>Normal text empasized in general are in <strong>the specific format</strong>, usually (visually) bold.</p>
<p>Local terms in the normal text are emphasized at first appearence in <em>the specific format</em>, usually (visually) italic.</p>
<p>For terms used globally in this document and any other derivations, see below.</p>
<h2 id="terms-and-definitions"><a class="header" href="#terms-and-definitions">Terms and definitions</a></h2>
<h3 id="resources"><a class="header" href="#resources">Resources</a></h3>
<p>Contents of materials are split as <em>resources</em> (e.g. <a href="http://en.wikipedia.org/wiki/Computer_file"><em>files</em></a>) in possibly nested <em>namespaces</em> (e.g. <a href="http://en.wikipedia.org/wiki/Directory_%28computing%29"><em>directories</em></a>). A namespace is also considered as a resource for convenience.</p>
<h3 id="paths-and-identifiers"><a class="header" href="#paths-and-identifiers">Paths and identifiers</a></h3>
<p>A <em>path</em> is used to identifying or locating a resource, which can be in various forms (e.g. filesystem <a href="http://en.wikipedia.org/wiki/Path_%28computing%29"><em>path</em></a> or <a href="http://en.wikipedia.org/wiki/Uniform_resource_locator"><em>URL</em></a>).</p>
<p>A path may have several <em>components</em> denoting different <em>levels</em> of namespace or the last level non-namespace resource.</p>
<p>An <em>empty path</em> is a path without any components.</p>
<p>A path with more than one components shall have syntactic <em>separators</em> (e.g. a slash(<code>/</code>) or whitespace) to split different components.</p>
<p>An <em>identifier</em> is a path with exactly one components without any separators, which can be used to differentiate resources in the same namespace or to collectively name some sets of resources in various namespaces.</p>
<p>A resource may be denoted with not necessarily the unique identifier or path. However, all resources this document discussed below are named.</p>
<h2 id="languages"><a class="header" href="#languages">Languages</a></h2>
<p>Rules of natural languages are specified in this subclause. They have effects on normal texts.</p>
<p>Normal text of noun phrases may have embedded translations for different natural languages or more detailed descriptions following its first occurence, in parentheses (<code>(</code> and <code>)</code>).</p>
<p>Different <a href="https://en.wikipedia.org/wiki/Letter_case">letter cases</a> (if appropriate) may be used for sentences, acronyms and words in the titles of clauses.</p>
<h3 id="editions-in-languages"><a class="header" href="#editions-in-languages">Editions in languages</a></h3>
<p>A set of documentation may be in one (natural) language. The <a href="http://en.wikipedia.org/wiki/IETF_language_tag">IETF language tag</a> with at least one subtag and an additional prefix dot(<code>.</code>) shall be placed in the end of identifier of the resource before the dot and the extension name (if any). Otherwise the documentation shall be in multiple languages or without text contents (e.g. containing only ideographic images), and no language code shall be in the identifier of the resource.</p>
<p>When the additional dot and tag is removed, all different resource with same names shall refer to the same set of contents only in different languages, or at least one of them shall be <em>incomplete</em> which means to be <em>completed</em> as in former case. The resource is one <em>edition</em> in the specific language of the documentation.</p>
<p>Unless explicitly specified, when the meaning is in conflict for multiple editions in different languages, the complete one shall be valid over others. If there is not only one complete edition, the validity is specified in following order:</p>
<ul>
<li><code>en-US</code></li>
<li><code>en</code></li>
<li><code>zh-CN</code></li>
<li><code>zh</code></li>
</ul>
<p>If no one edition in above languages is complete, the documentation is defective.</p>
<p>A language tag may be used to annotate one or more words in text. An annotation of such use is a <em>language tag annotation</em>, which consists of a tag combined with one pair of enclosing parentheses (namely, <code>(</code> and <code>)</code>).</p>
<p>Hyperlinks in pages should preferrably link to localized contents corresponding to the language or one of the major languages used in the page (if any) when suitable. If contents of the linked target is in other languages (esp. when there are more than one semantically identical editions in multiple languages), at least one language tag for majority of the contents should be noted subsequent to the hyperlink; otherwise, the tag should be omitted.</p>
<p>For compatibility of client programs, each link of <a href="https://en.wikipedia.org/wiki/URI">URI</a> should be encoded in form of normalized <a href="https://tools.ietf.org/html/rfc3986#section-2.1">Percent-Encoding in RFC 3986</a>.</p>
<p>Additionally, several hyperlinks are normalized with the same form for a specific language. Currently the rule consists of following cases:</p>
<ul>
<li>For <a href="https://zh.wikipedia.org/zh-cn">Chinese Wikipedia(zh-CN)</a>, the link shall following the rule in <a href="https://zh.wikipedia.org/zh-cn/Help:%E4%B8%AD%E6%96%87%E7%BB%B4%E5%9F%BA%E7%99%BE%E7%A7%91%E7%9A%84%E7%B9%81%E7%AE%80%E3%80%81%E5%9C%B0%E5%8C%BA%E8%AF%8D%E5%A4%84%E7%90%86">the section in the language conversion help page(zh-CN)</a>, with small letter &quot;cn&quot; in the link.</li>
</ul>
<h3 id="in-english"><a class="header" href="#in-english">In English</a></h3>
<p>Stylistic usage of letter cases shall be respected in the following precedence:</p>
<ol>
<li>All uppercase should not be used normally.</li>
<li>Acronyms and other proper noun (pharses) shall be in the appropriate styles.</li>
<li>The title case style shall be used for page or document titles.</li>
<li>Either the title case or the sentence case shall be used in the titles in a page. This shall be consistent within a document.</li>
<li>Either the title case or the sentence case shall be used in the detailed descriptions for acronyms in parentheses. This may vary in the same page.</li>
<li>Detailed descriptions for acronyms in parentheses may use title case or sentence case.</li>
<li>All lowercase style shall be used for words in the embedded translations or detailed descriptions in parentheses in other cases.</li>
<li>Sentence case should be used otherwise.</li>
</ol>
<p>English wording documentation is intended to be conforming to <a href="http://std.dkuug.dk/jtc1/sc22/wg9/isodir3.pdf">the ISO/IEC directive, part 3</a>. Note the use of modal verbs is distinct with <a href="http://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>. For RFC documents, RFC 2119 is preferred, but not necessary with the case clarification (i.e. <a href="https://tools.ietf.org/html/rfc8174">RFC 8174</a>) for documents published earlier than RFC 8174 due to compatibility issues.</p>
<p>The following grammartical forms of English (with <code>en</code> or <code>en-US</code> tags) are considered idiomatic and application of such forms may be preferred:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Answer_ellipsis">answer ellipsis</a> to elide the subject in the summary of commit messages where a question for the topic of the log message is assumed</li>
<li><a href="http://en.wikipedia.org/wiki/English_passive_voice#Additional_passive_constructions">bare passive clause</a> omitting the auxiliary verb for short descriptive notes (e.g. commit messages in repositories and assertions messages in programs)</li>
<li><a href="https://en.wikipedia.org/wiki/Null-subject_language#The_imperative_form">null subject</a> and <a href="https://en.wikipedia.org/wiki/Pro-drop_language#English">pronoun dropping</a> in imperative forms</li>
<li><a href="https://en.wikipedia.org/wiki/Zero-marking_in_English#Zero_article">zero article</a> for singular form of a countable noun denoting a specialized term being referenced, usually used in a terse-style title or in a list term (like this line)</li>
</ul>
<p><strong>Informative notes:</strong> The tense and mood used in the logs in version control systems are <a href="https://stackoverflow.com/questions/3580013/should-i-use-past-or-present-tense-in-git-commit-messages">opinion-based</a>. However, the implied rules are choosed here to avoid imperative forms by default, because:</p>
<ul>
<li>First, it should be respected same in all information processing system: to make sure who are the messages in the logs serve to.
<ul>
<li>Version control systems are capable for reading and writing operations on the version history, with asymmetric operational frequency in general.
<ul>
<li>For most stakeholders to a repository in most cases, read-only accesses of the version history are more frequent compared to changing opertions.</li>
<li>This is also consistent with the idiom pattern used in programming: do not abuse imperative updates with side effects.</li>
</ul>
</li>
<li>For most users, commit logs are <a href="https://stackoverflow.com/a/8059167/2307646">entries of journal</a> of the version history.
<ul>
<li>They do not and should not care about imperative changes in the logical perspective.</li>
</ul>
</li>
</ul>
</li>
<li>Unconstrained changes in the version history as effectful operations can make messes easily.
<ul>
<li>They are usually only well-behaved enough within some local context (e.g. in a single branch of a reliable instance of the version history).</li>
<li>They often make troubles in other cases (e.g. when stripped as patches possibly reordered).</li>
</ul>
</li>
<li>Messages in the logs may be cooperated with other instances of version history.
<ul>
<li>No imperative mood can essentially assume the changes described will always be applied in the exactly same way.</li>
<li>As mentioned above, out-of-order changes make messes. If the messages are precise, they also make messes like other changed contents.</li>
</ul>
</li>
<li>In general, messages in the logs work for distributed repositories.
<ul>
<li>There is simply no standpoint for the global view of the universe of the version history by default.</li>
<li>Messages should be ready to be audited by random accesses, besides being applied subsequently in some replays.</li>
<li>These facts further undermines the necessity of imperative changes.</li>
</ul>
</li>
</ul>
<h1 id="format-specific-rules"><a class="header" href="#format-specific-rules">Format-specific rules</a></h1>
<h2 id="text-files"><a class="header" href="#text-files">Text files</a></h2>
<p>Unless otherwise specified, all text files should be encoded as UTF-8 with <a href="http://en.wikipedia.org/wiki/Byte_order_mark">BOM</a> enabled.</p>
<p>Any use of encoding which may not be converted verbatim and losslessly in binary form to UTF-8 shall be explicit specified in documantation.</p>
<p>BOM should be omitted for text files dedicated to tools without capability of properly handling it. Otherwise, BOM shall be used as possible when it can clarify the encoding being used.</p>
<p>Unless definitely intended and explictly specified in documentation, newlines shall be consistent. Default use of newline is <a href="http://en.wikipedia.org/wiki/CRLF">CR+LF</a>.</p>
<p>Two subsequent newlines indicate an <a href="http://en.wikipedia.org/wiki/End-of-file">EOF</a> logically. Subsequent newlines out of verbatim quoted text (including source code) should only be used at EOF.</p>
<p>Except at the first of line, each word which consists of <a href="http://en.wikipedia.org/wiki/Alphanumeric">alphanumeric</a> characters should be seperated by a single space character(U+0020) with other words.</p>
<p>No <a href="http://en.wikipedia.org/wiki/Space_characters#Spaces_in_Unicode">space characters</a> should be at <a href="http://en.wikipedia.org/wiki/End-of-line">EOL</a>.</p>
<p>To keep the semantics rules clear, use <a href="http://en.wikipedia.org/wiki/Tab_key#Tab_characters">horizontal tab character(U+0009)</a> instead of <a href="http://en.wikipedia.org/wiki/Space_%28punctuation%29">other spaces(i.e. U+0020)</a> to indent, unless the text is verbatim quoted.</p>
<h2 id="a-hrefhttpenwikipediaorgwikimarkdownmarkdowna"><a class="header" href="#a-hrefhttpenwikipediaorgwikimarkdownmarkdowna"><a href="http://en.wikipedia.org/wiki/Markdown">Markdown</a></a></h2>
<p>Names of markdown files should be with <code>.md</code> extension.</p>
<h3 id="dialects"><a class="header" href="#dialects">Dialects</a></h3>
<p>Unless explicitly specified elsewhere, only common dialects are to be used. Currently this should be <a href="https://help.github.com/articles/github-flavored-markdown">GFM</a>.</p>
<p>And if the content may be presented on <a href="https://bitbucket.org">Bitbucket</a> wiki, stricter rules applies, notably:</p>
<ul>
<li>There is currently <a href="https://jira.atlassian.com/browse/BCLOUD-6930">no inline HTML support</a>.</li>
<li>There is currently <a href="https://jira.atlassian.com/browse/BCLOUD-8276">no anchor support</a>.</li>
</ul>
<p><strong>NOTE</strong> This repository is not intended deployed in Bitbucket wiki now. The stricter rules on Bitbucket wiki above are not applicable here.</p>
<h3 id="syntactic-restrictions"><a class="header" href="#syntactic-restrictions">Syntactic restrictions</a></h3>
<p>As text files, markdown files shall obey the same rules above. The indentation rule is necessary to avoid some compatibility issues, e.g. <a href="https://bitbucket.org/site/master/issue/7748/markdown-nested-lists-not-working-bb-8925">this</a>.</p>
<p>As specified, reserved characters defined by RFC 3986 should be percentage-encoded. Notably, the parentheses(<code>()</code>) in hyperlinks shall be encoded to make it more fault-tolerent for some editors.</p>
<p>Headers should be prefixed by <code>#</code>s.</p>
<p>For sake of compact annotation representation, there should be no redundant characters allowed between the annotated words and annotation (esp. <a href="https://en.wikipedia.org/wiki/Whitespace_character">whitespace characters</a>), even there are whitespaces in the words. The annotation in this rule includes any language tag annotation defined in previous subclause.</p>
<p>The whitespace rules in the language annotation is also</p>
<h1 id="cross-references"><a class="header" href="#cross-references">Cross references</a></h1>
<p>This document is used by the YSLib project. It may be also referenced by other repositories. </p>
<p><strong>Except for the following list, do not edit unless ultimately necessary.</strong></p>
<p>Known refereced by:</p>
<ul>
<li><a href="https://github.com/FrankHB/pl-docs">Programming Language Documentations</a> by FrankHB</li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
                        <script type="text/javascript">
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>
                
    </body>
</html>
